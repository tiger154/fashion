var __TX_GLOBAL={};if(document&&__TX_GLOBAL.domain&&!window.Jaxer){document.domain=__TX_GLOBAL.domain}if(!("console" in window)||!("firebug" in console)){var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var i=0;i<names.length;++i){window.console[names[i]]=function(){}}}if(!window.StopWatch){StopWatch={output:[],index:0,start:function(){this._init=new Date().getTime()},lap:function(a,e){var d=new Date().getTime()-this._init;this.output.push("#"+(this.index++)+" : "+d+" , "+a)},printAll:function(){var d=console;for(var c=0,a=this.output.length;c<a;c++){d.log(this.output[c])}}}}var $tx={};(function(){Object.extend=function(c,e){for(var d in e){c[d]=e[d]}return c};window.Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};window.$break={};Function.prototype.bind=function(){var c=this,e=$A(arguments),d=e.shift();return function(){return c.apply(d,e.concat($A(arguments)))
}};Function.prototype.bindAsEventListener=function(e){var c=this,d=$A(arguments),e=d.shift();return function(h){return c.apply(e,[h||window.event].concat(d))}};var a=function(d){if(arguments.length>1){for(var c=0,h=[],e=arguments.length;c<e;c++){h.push($tx(arguments[c]))}return h}if(typeof d=="string"){d=document.getElementById(d)}return d};$tx=a;Object.extend($tx,{chrome:(navigator.userAgent.indexOf("Chrome")!=-1),gecko:(navigator.userAgent.indexOf("Firefox")!=-1),gecko_ver:(navigator.userAgent.indexOf("Firefox")!=-1)?parseFloat(navigator.userAgent.replace(/.*Firefox\/([\d\.]+).*/g,"$1")):0,msie:(navigator.userAgent.indexOf("MSIE")!=-1),msie_ver:(navigator.userAgent.indexOf("MSIE")!=-1)?parseFloat(navigator.appVersion.split("MSIE")[1]):0,msie8_compat:($tx.msie_ver==7&&(navigator.userAgent.indexOf("Trident/4.0")!=-1)),msie8_std:$tx.msie_ver==8&&(navigator.userAgent.indexOf("Trident/4.0")!=-1),webkit:(navigator.userAgent.indexOf("AppleWebKit")!=-1),webkit_ver:(navigator.userAgent.indexOf("AppleWebKit")!=-1)?parseFloat(navigator.userAgent.replace(/.*Safari\//g,"")):0,opera:(navigator.userAgent.indexOf("Opera")!=-1),presto:(navigator.userAgent.indexOf("Presto")!=-1),iphone:(navigator.userAgent.indexOf("iPhone")!=-1),ipod:(navigator.userAgent.indexOf("iPod")!=-1)});
Object.extend($tx,{extend:Object.extend,browser:function(){if($tx.msie){return"msie"}else{if($tx.gecko){return"firefox"}else{if($tx.chrome){return"chrome"}else{if($tx.webkit){return"safari"}else{if($tx.opera){return"opera"}else{return""}}}}}}()});window.$must=function(h,d){var e=$tx(h);if(!e){var c=new Error("[Exception] "+d+" : not exist element("+h+")");throw c}return e};window.txlib=a})();(function(){$tx.extend($tx,{classNames:function(a){return a.className.split(" ")},hasClassName:function(h,j){var e=false;if(!h.className){return false}var d=h.className.split(" ");for(var a in d){if(d[a]==j){e=true;break}}return e},addClassName:function(a,d){if(!this.hasClassName(a,d)){a.className+=" "+d}},removeClassName:function(e,h){var d=e.className.split(" ");for(var a in d){if(d[a]==h){d.splice(a,1);break}}e.className=d.join(" ")},visible:function(a){return $tx.getStyle(a,"display")!="none"},toggle:function(a){a=$tx(a);$tx[$tx.visible(a)?"hide":"show"](a);return a},show:function(a){$tx(a).style.display="block";
return a},hide:function(a){$tx(a).style.display="none";return a}})})();(function(){$tx.extend($tx,{getOpacity:function(c){return $tx(c).getStyle("opacity")},setStyle:function(c,e,d){c=$tx(c);var j=c.style;for(var h in e){if(h=="opacity"){$tx.setOpacity(c,e[h])}else{j[(h=="float"||h=="cssFloat")?(j.styleFloat===undefined?"cssFloat":"styleFloat"):(d?h:h.camelize())]=e[h]}}return c}});var a=function(d,e){d=$tx(d);e=e=="float"?"cssFloat":e.camelize();var h=d.style[e];if(!h){var c=document.defaultView.getComputedStyle(d,null);h=c?c[e]:null}if(e=="opacity"){return h?parseFloat(h):1}return h=="auto"?null:h};$tx.extend($tx,{getStyle:a});if($tx.opera){$tx.extend($tx,{getStyle:function(c,d){switch(d){case"left":case"top":case"right":case"bottom":if(a(c,"position")=="static"){return null}default:return a(c,d)}}})}else{if($tx.msie){$tx.extend($tx,{getStyle:function(c,d){c=$tx(c);d=(d=="float"||d=="cssFloat")?"styleFloat":d.camelize();var e=c.style[d];if(!e&&c.currentStyle){e=c.currentStyle[d]}if(d=="opacity"){if(e=($tx.getStyle(c,"filter")||"").match(/alpha\(opacity=(.*)\)/)){if(e[1]){return parseFloat(e[1])/100
}}return 1}if(e=="auto"){if((d=="width"||d=="height")&&($tx.getStyle(c,"display")!="none")){return c["offset"+d.capitalize()]+"px"}return null}return e}})}}$tx.extend($tx,{setOpacity:function(c,d){c=$tx(c);c.style.opacity=(d==1||d==="")?"":(d<0.00001)?0:d;return c}});if($tx.msie){$tx.extend($tx,{setOpacity:function(c,h){c=$tx(c);var e=$tx.getStyle(c,"filter"),d=c.style;if(h==1||h===""){d.filter=e.replace(/alpha\([^\)]*\)/gi,"");return c}else{if(h<0.00001){h=0}}d.filter=e.replace(/alpha\([^\)]*\)/gi,"")+"alpha(opacity="+(h*100)+")";return c}})}else{if($tx.gecko){$tx.extend($tx,{setOpacity:function(c,d){c=$tx(c);c.style.opacity=(d==1)?0.999999:(d==="")?"":(d<0.00001)?0:d;return c}})}}})();(function(){$tx.extend($tx,{cumulativeOffset:function(c){var a=0,d=0;do{a+=c.offsetTop||0;d+=c.offsetLeft||0;c=c.offsetParent}while(c);return[d,a]},positionedOffset:function(c){var a=0,e=0;do{a+=c.offsetTop||0;e+=c.offsetLeft||0;c=c.offsetParent;if(c){if(c.tagName=="BODY"){break}var d=$tx.getStyle(c,"position");
if(d=="relative"||d=="absolute"){break}}}while(c);return[e,a]},getDimensions:function(d){var k=$tx.getStyle(d,"display");if(k!="none"&&k!=null){return{width:d.offsetWidth,height:d.offsetHeight}}var c=d.style;var j=c.visibility;var e=c.position;var a=c.display;c.visibility="hidden";c.position="absolute";c.display="block";var l=d.clientWidth;var h=d.clientHeight;c.display=a;c.position=e;c.visibility=j;return{width:l,height:h}}});if($tx.webkit){$tx.cumulativeOffset=function(c){var a=0,d=0;do{a+=c.offsetTop||0;d+=c.offsetLeft||0;if(c.offsetParent==document.body){if($tx.getStyle(c,"position")=="absolute"){break}}c=c.offsetParent}while(c);return[d,a]}}})();(function(){$tx.extend($tx,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,element:function(a){return $tx(a.target||a.srcElement)},isLeftClick:function(a){return(((a.which)&&(a.which==1))||((a.button)&&(a.button==1)))},pointerX:function(a){return a.pageX||(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft))
},pointerY:function(a){return a.pageY||(a.clientY+(document.documentElement.scrollTop||document.body.scrollTop))},stop:function(a){if(a.preventDefault){a.preventDefault();a.stopPropagation()}else{a.returnValue=false;a.cancelBubble=true}},findElement:function(d,c){var a=$tx.element(d);while(a.parentNode&&(!a.tagName||(a.tagName.toUpperCase()!=c.toUpperCase()))){a=a.parentNode}return a},observers:false,_observeAndCache:function(e,d,c,a){if(!this.observers){this.observers=[]}if(e.addEventListener){this.observers.push([e,d,c,a]);e.addEventListener(d,c,a)}else{if(e.attachEvent){this.observers.push([e,d,c,a]);e.attachEvent("on"+d,c)}}},unloadCache:function(){if(!$tx.observers){return}for(var a=0,c=$tx.observers.length;a<c;a++){$tx.stopObserving.apply(this,$tx.observers[a]);$tx.observers[a][0]=null}$tx.observers=false},observe:function(e,d,c,a){e=$tx(e);a=a||false;if(d=="keypress"&&($tx.webkit||e.attachEvent)){d="keydown"}$tx._observeAndCache(e,d,c,a)},stopObserving:function(h,d,c,a){h=$tx(h);
a=a||false;if(d=="keypress"&&($tx.webkit||h.attachEvent)){d="keydown"}if(h.removeEventListener){h.removeEventListener(d,c,a)}else{if(h.detachEvent){try{h.detachEvent("on"+d,c)}catch(j){}}}}});if($tx.msie){$tx.observe(window,"unload",$tx.unloadCache,false)}})();(function(){$tx.extend(Object,{inspect:function(a){try{if(a===undefined){return"undefined"}if(a===null){return"null"}return a.inspect?a.inspect():a.toString()}catch(c){if(c instanceof RangeError){return"..."}throw c}},toJSON:function(a){var d=typeof a;switch(d){case"undefined":case"function":case"unknown":return;case"boolean":return a.toString()}if(a===null){return null}if(a.toJSON){return a.toJSON()}if(a.ownerDocument===document){return}var c=[];for(var h in a){var e=Object.toJSON(a[h]);if(e!==undefined){c.push(h.toJSON()+": "+e)}}return"{"+c.join(", ")+"}"},clone:function(a){return Object.extend({},a)}});$tx.extend(Object,{toEncode:function(a){var d=typeof a;switch(d){case"undefined":case"function":case"unknown":return;case"number":case"boolean":case"date":return a
}if(a===null){return null}if(a.toEncode){return a.toEncode()}if(a.ownerDocument===document){return}var c={};for(var h in a){if(a[h]){var e=Object.toEncode(a[h]);if(e!==undefined){c[h]=e}}}return c},toDecode:function(a){var d=typeof a;switch(d){case"undefined":case"function":case"unknown":return;case"number":case"boolean":case"date":return a}if(a===null){return null}if(a.toDecode){return a.toDecode()}if(a.ownerDocument===document){return}var c={};for(var h in a){if(a[h]){var e=Object.toDecode(a[h]);if(e!==undefined){c[h]=e}}}return c}})})();(function(){$tx.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});$tx.extend(String.prototype,{gsub:function(h,d){var a="",e=this,c;d=arguments.callee.prepareReplacement(d);while(e.length>0){if(c=e.match(h)){a+=e.slice(0,c.index);a+=String.interpret(d(c));e=e.slice(c.index+c[0].length)}else{a+=e,e=""}}return a},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")
},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},toQueryParams:function(e){var a=this.strip().match(/([^?#]*)(#.*)?$/);if(!a){return{}}var d={};var c=null;a[1].split(e||"&").each(function(l){var k=null,h=null;var j=l.match(/([\w_]+)=(.*)/);if(j){c=k=decodeURIComponent(j[1]);if(j[2]){h=decodeURIComponent(j[2])}}else{if(c){k=c;h=d[k];h+="&"+decodeURIComponent(l)}else{return}}if(k in d){if(d[k].constructor!=Array){d[k]=[d[k]]}d[k].push(h)}else{d[k]=h}});return d},toArray:function(){return this.split("")},times:function(d){var a="";for(var c=0;c<d;c++){a+=this}return a},camelize:function(){var e=this.split("-"),a=e.length;if(a==1){return e[0]}var d=this.charAt(0)=="-"?e[0].charAt(0).toUpperCase()+e[0].substring(1):e[0];for(var c=1;c<a;c++){d+=e[c].charAt(0).toUpperCase()+e[c].substring(1)}return d},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},inspect:function(c){var a=this.gsub(/[\x00-\x1f\\]/,function(d){var e=String.specialChar[d[0]];
return e?e:"\\u00"+d[0].charCodeAt().toPaddedString(2,16)});if(c){return'"'+a.replace(/"/g,'\\"')+'"'}return"'"+a.replace(/'/g,"\\'")+"'"},toJSON:function(){return this.inspect(true)},include:function(a){return this.indexOf(a)>-1},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)}});String.prototype.gsub.prepareReplacement=function(c){if(typeof c=="function"){return c}var a=new Template(c);return function(d){return a.evaluate(d)}};$tx.extend(String.prototype,{trim:function(){return this.replace(/(^\s*)|(\s*$)/g,"")},getRegExp:function(){return this.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\//g,"\\/").replace(/\?/g,"\\?").replace(/\^/g,"\\^").replace(/\)/g,"\\)").replace(/\(/g,"\\(").replace(/\]/g,"\\]").replace(/\[/g,"\\[").replace(/\$/g,"\\$").replace(/\+/g,"\\+").replace(/\|/g,"\\|").replace(/&/g,"(&|&amp;)")},toEncoded:function(){return this.replace(/\s/g,"+")},toNumber:function(){return(isNaN(this)?0:parseInt(this,10))},toFloat:function(){return(isNaN(this)?0:parseFloat(this))
},getRealLength:function(){var d=this;var a=0;for(var c=0;c<d.length;c++){a+=(escape(d.charAt(c)).charAt(1)=="u")?2:1}return a},cutRealLength:function(d){var e=this;var a=0;for(var c=0;c<e.length;c++){a+=(escape(e.charAt(c)).charAt(1)=="u")?2:1;if(a>d){return e.substring(0,c-3).concat("...")}}return e},getCut:function(d){var e=this;var a=0;for(var c=0;c<e.length;c++){a+=(escape(e.charAt(c)).charAt(1)=="u")?2:1;if(a>d){return e.substring(0,c+1)}}return e.substring(0)},parsePx:function(){if(this==null||this.length==0){return 0}else{if(this.indexOf("px")>-1){return this.substring(0,this.indexOf("px")).toNumber()}else{return this.toNumber()}}},toPx:function(){if(this.indexOf("px")>-1){return this+""}else{return this+"px"}},toByteUnit:function(){return this.toNumber().toByteUnit()},toEncode:function(){return encodeURIComponent(this)},toDecode:function(){return decodeURIComponent(this)},toCurrency:function(){var c=this;for(var a=0;a<Math.floor((c.length-(1+a))/3);a++){c=c.substring(0,c.length-(4*a+3))+","+c.substring(c.length-(4*a+3))
}return c},replaceAll:function(a,c){a=a.replace(new RegExp("(\\W)","g"),"\\$1");c=c.replace(new RegExp("\\$","g"),"$$$$");return this.replace(new RegExp(a,"gm"),c)}})})();(function(){Date.prototype.toJSON=function(){return'"'+this.getFullYear()+"-"+(this.getMonth()+1).toPaddedString(2)+"-"+this.getDate().toPaddedString(2)+"T"+this.getHours().toPaddedString(2)+":"+this.getMinutes().toPaddedString(2)+":"+this.getSeconds().toPaddedString(2)+'"'}})();(function(){$tx.extend(Number.prototype,{toPaddedString:function(d,c){var a=this.toString(c||10);return"0".times(d-a.length)+a},toJSON:function(){return isFinite(this)?this+0:"null"},toTime:function(){return Math.floor(this/60).toString().toPaddedString(2)+":"+(this%60).toString().toPaddedString(2)},toByteUnit:function(){var d;var a=["GB","MB","KB"];if(this==0){return"0"+a[2]}for(var c=0;c<a.length;c++){d=this/Math.pow(1024,3-c);if(d<1){continue}return(Math.round(d*10)/10)+a[c]}return"1"+a[2]},toPx:function(){return this.toString()+"px"},parsePx:function(){return this
},toCurrency:function(){return this.toString().toCurrency()},getRegExp:function(){return this.toString().getRegExp()}})})();(function(){$tx.extend(Array.prototype,{each:function(c){var a=0;try{this._each(function(e){c(e,a++)})}catch(d){if(d!=$break){throw d}}return this},_each:function(c){for(var a=0,d=this.length;a<d;a++){c(this[a])}},include:function(a){var c=false;this.each(function(d){if(d==a){c=true;throw $break}});return c},pluck:function(c){var a=[];this.each(function(e,d){a.push(e[c])});return a},select:function(c){var a=[];this.each(function(e,d){if(c(e,d)){a.push(e)}});return a},inject:function(a,c){this.each(function(e,d){a=c(a,e,d)});return a},without:function(){var a=$A(arguments);return this.select(function(c){return !a.include(c)})},last:function(){return this[this.length-1]},flatten:function(){return this.inject([],function(c,a){return c.concat(a&&a.constructor==Array?a.flatten():[a])})},detect:function(c){var a;this.each(function(e,d){if(c(e,d)){a=e;throw $break}});return a
},toJSON:function(){var a=[];this.each(function(c){var d=Object.toJSON(c);if(d!==undefined){a.push(d)}});return"["+a.join(", ")+"]"},compact:function(){return this.select(function(a){return(a!=null)&&(a!="")})},uniq:function(a){return this.inject([],function(e,d,c){if(0==c||(a?e.last()!=d:!e.include(d))){e.push(d)}return e})},toMap:function(c){var a={};this.each(function(e,d){a[e[c]]=e});return a}});Array.prototype.findAll=Array.prototype.select;if($tx.opera){Array.prototype.concat=function(){var h=[];for(var c=0,d=this.length;c<d;c++){h.push(this[c])}for(var c=0,d=arguments.length;c<d;c++){if(arguments[c].constructor==Array){for(var a=0,e=arguments[c].length;a<e;a++){h.push(arguments[c][a])}}else{h.push(arguments[c])}}return h}}$tx.extend(Array.prototype,{toEncode:function(){var a=[];this.each(function(c){var d=Object.toEncode(c);if(d!==undefined){a.push(d)}});return a},toDecode:function(){var a=[];this.each(function(c){var d=Object.toDecode(c);if(d!==undefined){a.push(d)}});return a}});
window.$A=Array.from=function(e){if(!e){return[]}if(e.toArray){return e.toArray()}else{var c=[];for(var a=0,d=e.length;a<d;a++){c.push(e[a])}return c}};if($tx.webkit){$A=Array.from=function(e){if(!e){return[]}if(!(typeof e=="function"&&e=="[object NodeList]")&&e.toArray){return e.toArray()}else{var c=[];for(var a=0,d=e.length;a<d;a++){c.push(e[a])}return c}}}})();(function(){var a=function(c){if(c instanceof a){this.merge(c)}else{Object.extend(this,c||{})}};$tx.extend(a,{toQueryString:function(d){var c=[];c.add=arguments.callee.addPair;this.prototype._each.call(d,function(h){if(!h.key){return}var e=h.value;if(e&&typeof e=="object"){if(e.constructor==Array){e.each(function(j){c.add(h.key,j)})}return}c.add(h.key,e)});return c.join("&")},toJSON:function(c){var d=[];this.prototype._each.call(c,function(h){var e=Object.toJSON(h.value);if(e!==undefined){d.push(h.key.toJSON()+": "+e)}});return"{"+d.join(", ")+"}"}});a.toQueryString.addPair=function(c,e,d){c=encodeURIComponent(c);if(e===undefined){this.push(c)
}else{this.push(c+"="+(e==null?"":encodeURIComponent(e)))}};$tx.extend(a.prototype,{_each:function(d){for(var c in this){var e=this[c];if(e&&e==a.prototype[c]){continue}var h=[c,e];h.key=c;h.value=e;d(h)}},keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},merge:function(c){return $H(c).inject(this,function(d,e){d[e.key]=e.value;return d})},remove:function(){var c;for(var d=0,e=arguments.length;d<e;d++){var h=this[arguments[d]];if(h!==undefined){if(c===undefined){c=h}else{if(c.constructor!=Array){c=[c]}c.push(h)}}delete this[arguments[d]]}return c},toQueryString:function(){return a.toQueryString(this)},inspect:function(){return"#<Hash:{"+this.map(function(c){return c.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:function(){return a.toJSON(this)}});window.$H=function(c){if(c instanceof a){return c}return new a(c)}})();(function(){if(typeof(HTMLElement)!="undefined"){HTMLElement.prototype.innerText;var d=HTMLElement.prototype;var c=d.__proto__={__proto__:d.__proto__};
if(HTMLElement.prototype.__defineSetter__){c.__defineSetter__("innerText",function(h){this.textContent=h})}if(HTMLElement.prototype.__defineGetter__){c.__defineGetter__("innerText",function(){return this.textContent})}}if(typeof(XMLDocument)!="undefined"){if(XMLDocument.prototype.__defineGetter__){XMLDocument.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this)})}}if(typeof(Node)!="undefined"){if(Node.prototype&&Node.prototype.__defineGetter__){Node.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this)})}}if(typeof(document.implementation)!="undefined"){if(document.implementation.hasFeature("XPath","3.0")){if(typeof(XMLDocument)!="undefined"){XMLDocument.prototype.selectNodes=function(k,m){if(!m){m=this}var l=this.defaultNS;var h=this.evaluate(k,m,{normalResolver:this.createNSResolver(this.documentElement),lookupNamespaceURI:function(o){switch(o){case"dflt":return l;default:return this.normalResolver.lookupNamespaceURI(o)
}}},XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var n=[];for(var j=0;j<h.snapshotLength;j++){n[j]=h.snapshotItem(j)}return n};XMLDocument.prototype.setProperty=function(j,h){if(j=="SelectionNamespaces"&&h.indexOf("xmlns:dflt")==0){this.defaultNS=h.replace(/^.*=\'(.+)\'/,"$1")}};XMLDocument.prototype.defaultNS;XMLDocument.prototype.selectSingleNode=function(j,k){if(!k){k=this}var h=this.selectNodes(j,k);if(h.length>0){return h[0]}else{return null}};XMLDocument.prototype.createNode=function(h,k,j){if(h==1){return this.createElementNS(j,k)}else{return null}}}if(typeof(Element)!="undefined"){Element.prototype.selectNodes=function(h){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(h,this)}else{throw"For XML Elements Only"}};Element.prototype.selectSingleNode=function(h){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(h,this)}else{throw"For XML Elements Only"}};Element.prototype.text;var e=Element.prototype;var a=e.__proto__={__proto__:e.__proto__};
if(Element.prototype.__defineSetter__){a.__defineSetter__("text",function(h){this.textContent=h})}if(Element.prototype.__defineGetter__){a.__defineGetter__("text",function(){return this.textContent})}}}}})();window.tx={};function each(d,h){for(var e=0,c=d.length;e<c;e++){h(d[e])}}function installHyperscript(c,a){each("a big blockquote br b center code dd dl dt div em font form h1 h2 h3 h4 h5 h6 hr img iframe input i li ol option pre p script select small span strike strong style sub sup table tbody td textarea tr ul u".split(" "),function(d){c[d]=function(){var e=a.createElement(d);each(arguments,function(j){if(j.nodeType){e.appendChild(j)}else{if(typeof j=="string"||typeof j=="number"){if(d=="textarea"){if($tx.msie){e.value+=j}else{e.text+=j}}else{e.innerHTML+=j}}else{if(typeof j=="array"){for(var l=0;l<j.length;l++){e.appendChild(j[l])}}else{for(var h in j){if(h=="style"){for(var k in j[h]){if((k=="float"||k=="cssFloat")){e[h][e[h].styleFloat===undefined?"cssFloat":"styleFloat"]=j[h][k]
}else{e[h][k]=j[h][k]}}}else{if(["more","less","longDesc"].include(h)){if(e.setAttribute){e.setAttribute(h,j[h])}}else{if(["colSpan","rowSpan","cellPadding","cellSpacing"].include(h)){if(e.setAttribute){e.setAttribute(h,j[h])}}else{if(j[h]){e[h]=j[h]}}}}}}}}});return e}})}installHyperscript(window.tx,document);(function(){function evaluate(data,tpl){if(!data){return""}if(tpl.indexOf("{if:")>-1){tpl=tpl.replace(/#\{if:([_\w]+)([=><!]+)([_'"\-\w]+)\}([\s\S]*?)#\{\/if:\1\}/gm,function(full,start,sign,value,condtpl){if(data[start]==null){return full}var _condition=false;try{sign=((sign=="=")?"==":sign);var _left='"'+(data[start]+"").replace(/['"]/g,"")+'"';var _right='"'+value.replace(/['"]/g,"")+'"';eval("_condition = ("+_left+sign+_right+")")}catch(e){_condition=false}if(_condition){return evaluate(data,condtpl)}else{return""}})}if(tpl.indexOf("{for:")>-1){tpl=tpl.replace(/#\{for:([_\w]+):?(\d*):?(\d*)\}([\s\S]*?)#\{\/for:\1\}/gm,function(full,start,maxCnt,cutCnt,looptpl){if(!data[start]||!data[start].length){return full
}var _list=data[start];var _listTpl=[];maxCnt=!!maxCnt?(isNaN(maxCnt)?_list.length:parseInt(maxCnt)):_list.length;cutCnt=!!cutCnt?(isNaN(cutCnt)?0:parseInt(cutCnt)):0;for(var i=0,len=Math.min(_list.length,maxCnt);i<len;i++){_listTpl.push(evaluate(_list[i],looptpl))}return _listTpl.join("").substring(cutCnt)})}return tpl.replace(/#\{([_\w]+)\}/g,function(full,name){if(data[name]!=null){return data[name]}else{return full}})}window.Template=function(template){this.template=template};Template.prototype.evaluate=function(data){return evaluate(data,this.template)};Template.prototype.evaluateToDom=function(data,element){if(typeof(element)==="string"){element=document.getElementById(element)}element.innerHTML=evaluate(data,this.template)};Template.prototype.evaluateAsDom=function(data,context){var _tmpNode=(context||document).createElement("div");_tmpNode.innerHTML=evaluate(data,this.template);return _tmpNode.firstChild}})();(function(){var a,h,d;var j={"#":function(m,n){if((a=/(\S*)#(\S+)/.exec(n))!==null){var l=a[1];
var o=a[2];if(!m.getElementById){m=m.ownerDocument}if(h=m.getElementById(o)){if(l.length<1||h.nodeName.toLowerCase()==l){return[h]}}}return[]},".":function(n,r){if((a=/(\S*)\.(\S+)/.exec(r))!==null){var m=((a[1]==="")?"*":a[1]);var l=a[2];if((d=n.getElementsByTagName(m)).length>0){var p=[];for(var o=0;o<d.length;o++){var q=d[o];if((new RegExp("(^| )"+l+"($| )")).test(q.className)){p.push(q)}}return p}}return[]},"*":function(l,o){if((d=l.getElementsByTagName(o)).length>0){var n=[];for(var m=0;m<d.length;m++){n.push(d[m])}return n}return[]}};var c=function(l,p){if(l.length<1){return[]}var o;if((f=/(\.|#)/.exec(p))!==null){if(j[f[1]]){o=f[1]}}o=o||"*";var n=[];for(var m=0;m<l.length;m++){n=n.concat(j[o](l[m],p))}return n};var k=function(l,o){var n=[l];var p=o.split(" ");for(var m=0;m<p.length;m++){n=c(n,p[m])}return n};var e=function(o,l,p){p=!!p;if(o.nodeType!==1&&o.nodeType!==9){return(p?[]:null)}if(!l||typeof l!=="string"){return(p?[]:null)}var n;var q=[];var r=l.split(",");for(var m=0;
m<r.length;m++){n=k(o,r[m]);if(n&&n.length>0){q=q.concat(n);if(!p){break}}}if(p){return q}else{return q[0]}};window.dGetty=function(){if(arguments.length==1){if(typeof(arguments[0])==="string"){return e(document,arguments[0])}}else{if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){return e(arguments[0],arguments[1])}}}return null};window.dGetties=function(){if(arguments.length==1){if(typeof(arguments[0])==="string"){return e(document,arguments[0],true)}}else{if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){return e(arguments[0],arguments[1],true)}}}return[]}})();(function(){var a,h,d;var j={"#":function(l,m){if((a=/(\S*)#(\S+)/.exec(m))!==null){var k=a[1];var n=a[2];if(k.length<1||l.nodeName.toLowerCase()==k){if(l.id==n){return true}}}return false},".":function(m,n){if((a=/(\S*)\.(\S+)/.exec(n))!==null){var l=a[1];var k=a[2];if(l.length<1||m.nodeName.toLowerCase()==l){if(m.className.indexOf(k)>-1){return true}}}return false
},"*":function(l,m){var k=m;if(l.nodeName.toLowerCase()==k){return true}return false}};var c=function(k,m){var l;if((f=/(\.|#)/.exec(m))!==null){if(j[f[1]]){l=f[1]}}l=l||"*";return j[l](k,m)};var e=function(m,k){if(m.nodeType!==1){return false}var n=false;var o=k.split(",");for(var l=0;l<o.length;l++){n=c(m,o[l]);if(n){break}}return n};window.dChecky=function(){if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){return e(arguments[0],arguments[1])}}return false}})();(function(){var a,e,d;var h={"#":function(l,n){if((a=/(\S*)#(\S+)/.exec(n))!==null){var k=((a[1]==="")?"*":a[1]);var o=a[2];var m=l;while(m){if(m.nodeName.toLowerCase()=="body"){break}if(k=="*"||m.nodeName.toLowerCase()==k){if(m.id==o){return m}}m=m.parentNode}}return null},".":function(m,o){if((a=/(\S*)\.(\S+)/.exec(o))!==null){var l=((a[1]==="")?"*":a[1]);var k=a[2];var n=m;while(n){if(n.nodeName.toLowerCase()=="body"){break}if(l=="*"||n.nodeName.toLowerCase()==l){if(n.className.indexOf(k)>-1){return n
}}n=n.parentNode}}return null},"*":function(l,p){var n=l;var o={};var q=p.split(",");for(var m=0,k=q.length;m<k;m++){o[q[m]]=true}while(n){if(n.nodeName.toLowerCase()=="body"){break}if(o[n.nodeName.toLowerCase()]){return n}n=n.parentNode}return null}};var j=function(l,n){var m;if((f=/(\.|#|:\w+)/.exec(n))!==null){if(h[f[1]]){m=f[1]}}m=m||"*";var k=null;if((k=h[m](l,n))!=null){return k}return null};var c=function(o,l){if(!l||typeof l!=="string"){return null}var n=o;var p=l.split(" ");for(var m=0,k=p.length;m<k;m++){if((n=j(n,p[m]))==null){return null}}return n};window.dFindy=function(){if(arguments.length==1){throw new Error("need more arguments")}else{if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){return c(arguments[0],arguments[1])}}}return null}})();(function(){var a=function(d){this.selectSingleNode=function(e){if(!d){return null}return d.selectSingleNode(e)};this.selectNodes=function(e){if(!d){return[]}return d.selectNodes(e)};this.getAttributeNode=function(e){if(!d){return null
}return d.getAttributeNode(e)};this.hasChildNodes=function(){if(!d){return false}return d.hasChildNodes()};this.text=d?(d.textContent||d.text):null;this.type=d?d.nodeType:0;this.name=(d&&d.nodeType==1)?(d.nodeName||""):"";return this};a.prototype={xText:function(d){d=d||"";var e=this.text;e=(e||"").trim();if(e===""){return d}else{if(typeof(d)==="number"){return(isNaN(e)?0:parseInt(e))}else{if(typeof(d)==="boolean"){return !!e}else{return e}}}},xAttr:function(e,d){d=d||"";var h=this.getAttributeNode(e);var j=(!h)?"":h.nodeValue.trim();if(j===""){return d}else{if(typeof(d)==="number"){return(isNaN(j)?0:parseInt(j))}else{if(typeof(d)==="boolean"){return !!j}else{return j}}}},xGet:function(d){return xGetty(this,d)},xGets:function(d){return xGetties(this,d)}};var c=["MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.5.0","MSXML2.DOMDocument.4.0","MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"];window.xCreate=function(h){if(!!(window.attachEvent&&!window.opera)){var e=(function(){var k=null;
for(var j=0;j<c.length;j++){try{k=new ActiveXObject(c[j])}catch(l){}if(k!==null){return k}}return null})();if(e===null){return null}e.async=false;e.loadXML(h);if(e.parseError.errorCode!==0){return null}return new a(e)}else{var d=new DOMParser();var e=d.parseFromString(new String(h),"text/xml");return new a(e)}};window.xGetty=function(d,e){if(d===null){return null}return new a(d.selectSingleNode(e))};window.xGetties=function(j,l){if(j===null){return[]}var k=[];var e=j.selectNodes(l);for(var h=0,d=e.length;h<d;h++){k.push(new a(e[h]))}return k}})();(function(){var d={yyyy:/(\d{4})/,MM:/(\d{2})/,dd:/(\d{2})/,HH:/(\d{2})/,mm:/(\d{2})/,ss:/(\d{2})/,yy:/(\d{2})/,M:/([0-1]*\d)/,d:/([0-3]*\d)/,EEE:/(\uc77c|\uc6d4|\ud654|\uc218|\ubaa9|\uae08|\ud1a0)/};var a=["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"];function c(e){this.pattern=e}c.prototype={parse:function(e){var h={};this.pattern.replace(/(\w)\1*/g,function(j){if(d[j]){e=e.replace(d[j],function(k,l){h[j]=l;return""})}return j
});return new Date(Date.parse([Math.max(1,parseInt(h.MM||h.M||"01",10)),"/",Math.max(1,parseInt(h.dd||h.d||"01",10)),"/",(h.yyyy||h.yy||new Date().getFullYear())," ",h.HH||"00",":",h.mm||"00",":",h.ss||"00"].join("")))},format:function(e){return this.pattern.replace("yyyy",e.getFullYear()).replace("MM",(e.getMonth()+1).toPaddedString(2)).replace("dd",e.getDate().toPaddedString(2)).replace("HH",e.getHours().toPaddedString(2)).replace("mm",e.getMinutes().toPaddedString(2)).replace("ss",e.getSeconds().toPaddedString(2)).replace("yy",e.getYear()).replace("M",e.getMonth()+1).replace("d",e.getDate()).replace("EEE",a[e.getDay()])}};window.DateFormat=c})();
/*	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
var swfobject=function(){var J="undefined",x="object",Z="Shockwave Flash",ad="ShockwaveFlash.ShockwaveFlash",w="application/x-shockwave-flash",Y="SWFObjectExprInst",D="onreadystatechange",V=window,n=document,z=navigator,aa=false,ab=[l],t=[],U=[],O=[],p,X,K,H,P=false,a=false,r,M,q=true,T=function(){var ah=typeof n.getElementById!=J&&typeof n.getElementsByTagName!=J&&typeof n.createElement!=J,ao=z.userAgent.toLowerCase(),af=z.platform.toLowerCase(),al=af?/win/.test(af):/win/.test(ao),aj=af?/mac/.test(af):/mac/.test(ao),am=/webkit/.test(ao)?parseFloat(ao.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ae=!+"\v1",an=[0,0,0],ai=null;
if(typeof z.plugins!=J&&typeof z.plugins[Z]==x){ai=z.plugins[Z].description;if(ai&&!(typeof z.mimeTypes!=J&&z.mimeTypes[w]&&!z.mimeTypes[w].enabledPlugin)){aa=true;ae=false;ai=ai.replace(/^.*\s+(\S+\s+\S+$)/,"$1");an[0]=parseInt(ai.replace(/^(.*)\..*$/,"$1"),10);an[1]=parseInt(ai.replace(/^.*\.(.*)\s.*$/,"$1"),10);an[2]=/[a-zA-Z]/.test(ai)?parseInt(ai.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof V.ActiveXObject!=J){try{var ak=new ActiveXObject(ad);if(ak){ai=ak.GetVariable("$version");if(ai){ae=true;ai=ai.split(" ")[1].split(",");an=[parseInt(ai[0],10),parseInt(ai[1],10),parseInt(ai[2],10)]}}}catch(ag){}}}return{w3:ah,pv:an,wk:am,ie:ae,win:al,mac:aj}}(),o=function(){if(!T.w3){return}if((typeof n.readyState!=J&&n.readyState=="complete")||(typeof n.readyState==J&&(n.getElementsByTagName("body")[0]||n.body))){j()}if(!P){if(typeof n.addEventListener!=J){n.addEventListener("DOMContentLoaded",j,false)}if(T.ie&&T.win){n.attachEvent(D,function(){if(n.readyState=="complete"){n.detachEvent(D,arguments.callee);
j()}});if(V==top){(function(){if(P){return}try{n.documentElement.doScroll("left")}catch(ae){setTimeout(arguments.callee,0);return}j()})()}}if(T.wk){(function(){if(P){return}if(!/loaded|complete/.test(n.readyState)){setTimeout(arguments.callee,0);return}j()})()}y(j)}}();function j(){if(P){return}try{var ag=n.getElementsByTagName("body")[0].appendChild(I("span"));ag.parentNode.removeChild(ag)}catch(ah){return}P=true;var ae=ab.length;for(var af=0;af<ae;af++){ab[af]()}}function Q(ae){if(P){ae()}else{ab[ab.length]=ae}}function y(af){if(typeof V.addEventListener!=J){V.addEventListener("load",af,false)}else{if(typeof n.addEventListener!=J){n.addEventListener("load",af,false)}else{if(typeof V.attachEvent!=J){m(V,"onload",af)}else{if(typeof V.onload=="function"){var ae=V.onload;V.onload=function(){ae();af()}}else{V.onload=af}}}}}function l(){if(aa){ac()}else{N()}}function ac(){var ae=n.getElementsByTagName("body")[0];var ah=I(x);ah.setAttribute("type",w);var ag=ae.appendChild(ah);if(ag){var af=0;
(function(){if(typeof ag.GetVariable!=J){var ai=ag.GetVariable("$version");if(ai){ai=ai.split(" ")[1].split(",");T.pv=[parseInt(ai[0],10),parseInt(ai[1],10),parseInt(ai[2],10)]}}else{if(af<10){af++;setTimeout(arguments.callee,10);return}}ae.removeChild(ah);ag=null;N()})()}else{N()}}function N(){var an=t.length;if(an>0){for(var am=0;am<an;am++){var af=t[am].id;var ai=t[am].callbackFn;var ah={success:false,id:af};if(T.pv[0]>0){var al=d(af);if(al){if(L(t[am].swfVersion)&&!(T.wk&&T.wk<312)){C(af,true);if(ai){ah.success=true;ah.ref=F(af);ai(ah)}}else{if(t[am].expressInstall&&G()){var ap={};ap.data=t[am].expressInstall;ap.width=al.getAttribute("width")||"0";ap.height=al.getAttribute("height")||"0";if(al.getAttribute("class")){ap.styleclass=al.getAttribute("class")}if(al.getAttribute("align")){ap.align=al.getAttribute("align")}var ao={};var ae=al.getElementsByTagName("param");var aj=ae.length;for(var ak=0;ak<aj;ak++){if(ae[ak].getAttribute("name").toLowerCase()!="movie"){ao[ae[ak].getAttribute("name")]=ae[ak].getAttribute("value")
}}W(ap,ao,af,ai)}else{u(al);if(ai){ai(ah)}}}}}else{C(af,true);if(ai){var ag=F(af);if(ag&&typeof ag.SetVariable!=J){ah.success=true;ah.ref=ag}ai(ah)}}}}}function F(ah){var ae=null;var af=d(ah);if(af&&af.nodeName=="OBJECT"){if(typeof af.SetVariable!=J){ae=af}else{var ag=af.getElementsByTagName(x)[0];if(ag){ae=ag}}}return ae}function G(){return !a&&L("6.0.65")&&(T.win||T.mac)&&!(T.wk&&T.wk<312)}function W(ah,ai,ae,ag){a=true;K=ag||null;H={success:false,id:ae};var al=d(ae);if(al){if(al.nodeName=="OBJECT"){p=k(al);X=null}else{p=al;X=ae}ah.id=Y;if(typeof ah.width==J||(!/%$/.test(ah.width)&&parseInt(ah.width,10)<310)){ah.width="310"}if(typeof ah.height==J||(!/%$/.test(ah.height)&&parseInt(ah.height,10)<137)){ah.height="137"}n.title=n.title.slice(0,47)+" - Flash Player Installation";var ak=T.ie&&T.win?"ActiveX":"PlugIn",aj="MMredirectURL="+V.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ak+"&MMdoctitle="+n.title;if(typeof ai.flashvars!=J){ai.flashvars+="&"+aj}else{ai.flashvars=aj}if(T.ie&&T.win&&al.readyState!=4){var af=I("div");
ae+="SWFObjectNew";af.setAttribute("id",ae);al.parentNode.insertBefore(af,al);al.style.display="none";(function(){if(al.readyState==4){al.parentNode.removeChild(al)}else{setTimeout(arguments.callee,10)}})()}A(ah,ai,ae)}}function u(af){if(T.ie&&T.win&&af.readyState!=4){var ae=I("div");af.parentNode.insertBefore(ae,af);ae.parentNode.replaceChild(k(af),ae);af.style.display="none";(function(){if(af.readyState==4){af.parentNode.removeChild(af)}else{setTimeout(arguments.callee,10)}})()}else{af.parentNode.replaceChild(k(af),af)}}function k(ai){var ah=I("div");if(T.win&&T.ie){ah.innerHTML=ai.innerHTML}else{var af=ai.getElementsByTagName(x)[0];if(af){var aj=af.childNodes;if(aj){var ae=aj.length;for(var ag=0;ag<ae;ag++){if(!(aj[ag].nodeType==1&&aj[ag].nodeName=="PARAM")&&!(aj[ag].nodeType==8)){ah.appendChild(aj[ag].cloneNode(true))}}}}}return ah}function A(ap,an,af){var ae,ah=d(af);if(T.wk&&T.wk<312){return ae}if(ah){if(typeof ap.id==J){ap.id=af}if(T.ie&&T.win){var ao="";for(var al in ap){if(ap[al]!=Object.prototype[al]){if(al.toLowerCase()=="data"){an.movie=ap[al]
}else{if(al.toLowerCase()=="styleclass"){ao+=' class="'+ap[al]+'"'}else{if(al.toLowerCase()!="classid"){ao+=" "+al+'="'+ap[al]+'"'}}}}}var am="";for(var ak in an){if(an[ak]!=Object.prototype[ak]){am+='<param name="'+ak+'" value="'+an[ak]+'" />'}}ah.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ao+">"+am+"</object>";U[U.length]=ap.id;ae=d(ap.id)}else{var ag=I(x);ag.setAttribute("type",w);for(var aj in ap){if(ap[aj]!=Object.prototype[aj]){if(aj.toLowerCase()=="styleclass"){ag.setAttribute("class",ap[aj])}else{if(aj.toLowerCase()!="classid"){ag.setAttribute(aj,ap[aj])}}}}for(var ai in an){if(an[ai]!=Object.prototype[ai]&&ai.toLowerCase()!="movie"){h(ag,ai,an[ai])}}ah.parentNode.replaceChild(ag,ah);ae=ag}}return ae}function h(ag,ae,af){var ah=I("param");ah.setAttribute("name",ae);ah.setAttribute("value",af);ag.appendChild(ah)}function E(af){var ae=d(af);if(ae&&ae.nodeName=="OBJECT"){if(T.ie&&T.win){ae.style.display="none";(function(){if(ae.readyState==4){c(af)}else{setTimeout(arguments.callee,10)
}})()}else{ae.parentNode.removeChild(ae)}}}function c(ag){var af=d(ag);if(af){for(var ae in af){if(typeof af[ae]=="function"){af[ae]=null}}af.parentNode.removeChild(af)}}function d(ag){var ae=null;try{ae=n.getElementById(ag)}catch(af){}return ae}function I(ae){return n.createElement(ae)}function m(ag,ae,af){ag.attachEvent(ae,af);O[O.length]=[ag,ae,af]}function L(ag){var af=T.pv,ae=ag.split(".");ae[0]=parseInt(ae[0],10);ae[1]=parseInt(ae[1],10)||0;ae[2]=parseInt(ae[2],10)||0;return(af[0]>ae[0]||(af[0]==ae[0]&&af[1]>ae[1])||(af[0]==ae[0]&&af[1]==ae[1]&&af[2]>=ae[2]))?true:false}function B(aj,af,ak,ai){if(T.ie&&T.mac){return}var ah=n.getElementsByTagName("head")[0];if(!ah){return}var ae=(ak&&typeof ak=="string")?ak:"screen";if(ai){r=null;M=null}if(!r||M!=ae){var ag=I("style");ag.setAttribute("type","text/css");ag.setAttribute("media",ae);r=ah.appendChild(ag);if(T.ie&&T.win&&typeof n.styleSheets!=J&&n.styleSheets.length>0){r=n.styleSheets[n.styleSheets.length-1]}M=ae}if(T.ie&&T.win){if(r&&typeof r.addRule==x){r.addRule(aj,af)
}}else{if(r&&typeof n.createTextNode!=J){r.appendChild(n.createTextNode(aj+" {"+af+"}"))}}}function C(ag,ae){if(!q){return}var af=ae?"visible":"hidden";if(P&&d(ag)){d(ag).style.visibility=af}else{B("#"+ag,"visibility:"+af)}}function S(af){var ag=/[\\\"<>\.;]/;var ae=ag.exec(af)!=null;return ae&&typeof encodeURIComponent!=J?encodeURIComponent(af):af}var e=function(){if(T.ie&&T.win){window.attachEvent("onunload",function(){var aj=O.length;for(var ai=0;ai<aj;ai++){O[ai][0].detachEvent(O[ai][1],O[ai][2])}var ag=U.length;for(var ah=0;ah<ag;ah++){E(U[ah])}for(var af in T){T[af]=null}T=null;for(var ae in swfobject){swfobject[ae]=null}swfobject=null})}}();return{registerObject:function(ai,ae,ah,ag){if(T.w3&&ai&&ae){var af={};af.id=ai;af.swfVersion=ae;af.expressInstall=ah;af.callbackFn=ag;t[t.length]=af;C(ai,false)}else{if(ag){ag({success:false,id:ai})}}},getObjectById:function(ae){if(T.w3){return F(ae)}},embedSWF:function(ai,ao,al,an,af,ah,ag,ak,am,aj){var ae={success:false,id:ao};if(T.w3&&!(T.wk&&T.wk<312)&&ai&&ao&&al&&an&&af){C(ao,false);
Q(function(){al+="";an+="";var aq={};if(am&&typeof am===x){for(var at in am){aq[at]=am[at]}}aq.data=ai;aq.width=al;aq.height=an;var au={};if(ak&&typeof ak===x){for(var ar in ak){au[ar]=ak[ar]}}if(ag&&typeof ag===x){for(var ap in ag){if(typeof au.flashvars!=J){au.flashvars+="&"+ap+"="+ag[ap]}else{au.flashvars=ap+"="+ag[ap]}}}if(L(af)){var av=A(aq,au,ao);if(aq.id==ao){C(ao,true)}ae.success=true;ae.ref=av}else{if(ah&&G()){aq.data=ah;W(aq,au,ao,aj);return}else{C(ao,true)}}if(aj){aj(ae)}})}else{if(aj){aj(ae)}}},switchOffAutoHideShow:function(){q=false},ua:T,getFlashPlayerVersion:function(){return{major:T.pv[0],minor:T.pv[1],release:T.pv[2]}},hasFlashPlayerVersion:L,createSWF:function(ag,af,ae){if(T.w3){return A(ag,af,ae)}else{return undefined}},showExpressInstall:function(ag,ah,ae,af){if(T.w3&&G()){W(ag,ah,ae,af)}},removeSWF:function(ae){if(T.w3){E(ae)}},createCSS:function(ah,ag,af,ae){if(T.w3){B(ah,ag,af,ae)}},addDomLoadEvent:Q,addLoadEvent:y,getQueryParamValue:function(ah){var ag=n.location.search||n.location.hash;
if(ag){if(/\?/.test(ag)){ag=ag.split("?")[1]}if(ah==null){return S(ag)}var af=ag.split("&");for(var ae=0;ae<af.length;ae++){if(af[ae].substring(0,af[ae].indexOf("="))==ah){return S(af[ae].substring((af[ae].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(a){var ae=d(Y);if(ae&&p){ae.parentNode.replaceChild(p,ae);if(X){C(X,true);if(T.ie&&T.win){p.style.display="block"}}if(K){K(H)}}a=false}}}}();var Trex={__PAGE_PATH:"http://editor.daum.net/pages/",__KEY:{ENTER:"13",DELETE:"46",SPACE:"32",BACKSPACE:"8",PASTE:"86",CUT:"88"},I:{},X:{},define:function(a,c){return Object.extend(a,c)},available:function(c,a){if(!$tx("tx_"+a)){return false}if(!c){return false}if(c.use==false){return false}return true},getSWF:window.getSWF};(function(c){function d(h){var e=h;while(e.$reference){e=e.$reference}return e}function a(l){var j=l.constructor.superclass;if(j){var n=j.prototype.initialize;j.prototype.initialize=function(){this.$reference=l};var m=new j();j.prototype.initialize=n;var h=function(o){if(!m[o]){return null
}return function(){var t=arguments;var r=d(l);var p=r.$super;r.$super=m.$super;var q=m[o].apply(r,t);r.$super=p;return q}};var k={};for(var e in m){if(e.charAt(0)!="$"){if(typeof(m[e])=="function"){k[e]=h(e)}}}l.$super=k}}c.Class={create:function(h){var e=function(){var k=this.constructor.prototype;for(var j in k){if(k[j]&&typeof(k[j])==="object"){if(k[j].constructor==Array){this[j]=[].concat(k[j])}else{this[j]=Object.extend({},k[j])}}}a(this);var l=arguments;this.initialize.apply(this,l)};return c.Class.draft(h,e)},draft:function(k,l){var h=l?l:function(){a(this)};if(k.$const){Object.extend(h,k.$const)}if(k.$extend){Object.extend(h.prototype,k.$extend.prototype);h.superclass=k.$extend}if(k.$mixins){var j=$A(k.$mixins);j.each(function(m){Object.extend(h.prototype,m)})}for(var e in k){if(e.charAt(0)!="$"){h.prototype[e]=k[e]}}return h},overwrite:function(j,h){var e=j;if(e.prototype){Object.extend(e.prototype,h)}return e}};c.Mixin=c.Faculty={create:function(j){var h={};for(var e in j){if(j[e]&&typeof(j[e])==="object"){if(j[e].constructor==Array){h[e]=[].concat(j[e])
}else{h[e]=Object.extend({},j[e])}}else{h[e]=j[e]}}return h},toClass:function(e,h){return c.Class.create(Object.extend({initialize:h?h:function(){}},e))}}})(Trex);(function(a){Object.extend(a,{installs:[],registers:[],modules:[],modulesX:[],install:function(d,c){c.desc="[install] "+d;a.installs.push(c)},register:function(d,c){c.desc="[register] "+d;a.registers.push(c)},module:function(d,c){c.desc="[module] "+d;a.modules.push(c)},moduleX:function(d,c){c.desc="[moduleX] "+d;a.modulesX.push(c)},invoke:function(n,j,m,c,d,e){for(var h=0,k=n.length;h<k;h++){var l=n[h];if(l.desc){}l(j,m,c,d,e)}},invokeInstallation:function(e,h,j,d,c){a.invoke(a.installs,e,h,j,d,c)},invokeRegisters:function(e,h,j,d,c){a.invoke(a.registers,e,h,j,d,c)},invokeModules:function(e,h,j,d,c){a.invoke(a.modules,e,h,j,d,c)},group:function(c){try{}catch(d){}},groupEnd:function(){try{}catch(c){}}})})(Trex);(function(a){a.Ev={__EDITOR_PANEL_MOUSEDOWN:"editor.panel.mousedown",__CANVAS_PANEL_KEYDOWN:"canvas.panel.keydown",__CANVAS_PANEL_KEYUP:"canvas.panel.keyup",__CANVAS_PANEL_MOUSEDOWN:"canvas.panel.mousedown",__CANVAS_PANEL_MOUSEUP:"canvas.panel.mouseup",__CANVAS_PANEL_MOUSEOVER:"canvas.panel.mouseover",__CANVAS_PANEL_CLICK:"canvas.panel.click",__CANVAS_PANEL_SCROLLING:"canvas.panel.scrolling",__IFRAME_LOAD_COMPLETE:"iframe.load.complete",__CANVAS_SOURCE_PANEL_CLICK:"canvas.source.panel.click",__CANVAS_SOURCE_PANEL_KEYDOWN:"canvas.source.panel.mousedown",__CANVAS_SOURCE_PANEL_MOUSEDOWN:"canvas.source.panel.mousedown",__CANVAS_TEXT_PANEL_CLICK:"canvas.text.panel.click",__CANVAS_MODE_CHANGE:"canvas.mode.change",__TOOL_CLICK:"toolbar.button.click",__ON_SUBMIT:"editor.submit",__CANVAS_HEIGHT_CHANGE:"canvas.height.change",__CANVAS_PANEL_QUERY_STATUS:"canvas.panel.style.change",__CANVAS_PANEL_DELETE_SOMETHING:"canvas.panel.delkey.press",__ENTRYBOX_ENTRY_ADDED:"entrybox.entryadded",__ENTRYBOX_ENTRY_MODIFIED:"entrybox.entrymodified",__ENTRYBOX_ENTRY_REMOVED:"entrybox.entryremoved",__ENTRYBOX_ALL_ENTRY_REMOVED:"entrybox.removed.all.perfectly",__ATTACHBOX_SHOW:"attachbox.show",__ATTACHBOX_HIDE:"attachbox.hide",__CANVAS_BEFORE_UNLOAD:"canvas.unload",__CANVAS_ENTRY_ADDED:"canvas.entry.added",__COMMAND_NODE_ADDED:"cmd.entry.added",__CMD_ALIGN_LEFT:"align.left",__CMD_ALIGN_CENTER:"align.center",__CMD_ALIGN_RIGHT:"align.right",__CMD_ALIGN_FULL:"align.full",__CMD_ALIGN_IMG_LEFT:"align.img.left",__CMD_ALIGN_IMG_CENTER:"align.img.center",__CMD_ALIGN_IMG_FLOAT_LEFT:"align.img.floatleft",__CMD_ALIGN_IMG_FLOAT_RIGHT:"align.img.floatright",__CANVAS_MODE_INITIALIZE:"canvas.mode.initialize",__CANVAS_DATA_INITIALIZE:"canvas.load.data",__ENTRYBOX_ENTRY_REFRESH:"entrybox.entryrefresh",__PASTE_SEARCHRESULT:"trex.paste.info",__RUNTIME_EXCEPTION:"editor.runtime.exception",__REPORT_TO_MAGPIE:"editor.report.magpie"}
})(Trex);var TrexEvent={fire:function(d,a){if(d&&d.tagName){var c=a[d.tagName.toLowerCase()];if(c){c(d,a)}else{TrexEvent.propagateToParent(d,a)}}else{}},propagateToParent:function(c,a){var e=c.parentNode;if(e&&e.tagName){var d=a[e.tagName.toLowerCase()];if(d){d(e,a)}else{TrexEvent.propagateToParent(e,a)}}},stopPropagation:function(a){}};Trex.__CONFIG_COMMON={thumbs:{options:[{color:"#FF0000"},{color:"#FF5E00"},{color:"#FFBB00"},{color:"#FFE400"},{color:"#ABF200"},{color:"#1FDA11"},{color:"#00D8FF"},{color:"#0055FF"},{color:"#0900FF"},{color:"#6600FF"},{color:"#FF00DD"},{color:"#FF007F"},{color:"#000000"},{color:"#FFFFFF"},{color:"#FFD8D8"},{color:"#FAE0D4"},{color:"#FAECC5"},{color:"#FAF4C0"},{color:"#E4F7BA"},{color:"#CEFBC9"},{color:"#D4F4FA"},{color:"#D9E5FF"},{color:"#DAD9FF"},{color:"#E8D9FF"},{color:"#FFD9FA"},{color:"#FFD9EC"},{color:"#F6F6F6"},{color:"#EAEAEA"},{color:"#FFA7A7"},{color:"#FFC19E"},{color:"#FFE08C"},{color:"#FAED7D"},{color:"#CEF279"},{color:"#B7F0B1"},{color:"#B2EBF4"},{color:"#B2CCFF"},{color:"#B5B2FF"},{color:"#D1B2FF"},{color:"#FFB2F5"},{color:"#FFB2D9"},{color:"#D5D5D5"},{color:"#BDBDBD"},{color:"#F15F5F"},{color:"#F29661"},{color:"#F2CB61"},{color:"#E5D85C"},{color:"#BCE55C"},{color:"#86E57F"},{color:"#5CD1E5"},{color:"#6699FF"},{color:"#6B66FF"},{color:"#A366FF"},{color:"#F261DF"},{color:"#F261AA"},{color:"#A6A6A6"},{color:"#8C8C8C"},{color:"#CC3D3D"},{color:"#CC723D"},{color:"#CCA63D"},{color:"#C4B73B"},{color:"#9FC93C"},{color:"#47C83E"},{color:"#3DB7CC"},{color:"#4174D9"},{color:"#4641D9"},{color:"#7E41D9"},{color:"#D941C5"},{color:"#D9418D"},{color:"#747474"},{color:"#5D5D5D"},{color:"#980000"},{color:"#993800"},{color:"#997000"},{color:"#998A00"},{color:"#6B9900"},{color:"#2F9D27"},{color:"#008299"},{color:"#003399"},{color:"#050099"},{color:"#3D0099"},{color:"#990085"},{color:"#99004C"},{color:"#4C4C4C"},{color:"#353535"},{color:"#670000"},{color:"#662500"},{color:"#664B00"},{color:"#665C00"},{color:"#476600"},{color:"#22741C"},{color:"#005766"},{color:"#002266"},{color:"#030066"},{color:"#290066"},{color:"#660058"},{color:"#660033"},{color:"#212121"},{color:"#000000"}],transparent:{color:"transparent",border:"#999999",image:"#iconpath/ic_transparent4.gif?rv=1.0.1",thumb:"#iconpath/txt_transparent.gif?rv=1.0.1",thumbImage:"#iconpath/color_transparent_prev.gif?rv=1.0.1"}},textbox:{options:[{data:"txc-textbox1",style:{padding:"10px",backgroundColor:"#ffffff",border:"1px solid #f7f7f7"}},{data:"txc-textbox2",style:{padding:"10px",backgroundColor:"#eeeeee",border:"1px solid #eeeeee"}},{data:"txc-textbox3",style:{padding:"10px",backgroundColor:"#fefeb8",border:"1px solid #fefeb8"}},{data:"txc-textbox4",style:{padding:"10px",backgroundColor:"#fedec7",border:"1px solid #fedec7"}},{data:"txc-textbox5",style:{padding:"10px",backgroundColor:"#e7fdb5",border:"1px solid #e7fdb5"}},{data:"txc-textbox6",style:{padding:"10px",backgroundColor:"#dbe8fb",border:"1px solid #dbe8fb"}},{data:"txc-textbox7",style:{padding:"10px",backgroundColor:"#ffffff",border:"1px dashed #cbcbcb"}},{data:"txc-textbox8",style:{padding:"10px",backgroundColor:"#eeeeee",border:"1px dashed #c1c1c1"}},{data:"txc-textbox9",style:{padding:"10px",backgroundColor:"#fefeb8",border:"1px dashed #f3c534"}},{data:"txc-textbox10",style:{padding:"10px",backgroundColor:"#fedec7",border:"1px dashed #fe8943"}},{data:"txc-textbox11",style:{padding:"10px",backgroundColor:"#e7fdb5",border:"1px dashed #9fd331"}},{data:"txc-textbox12",style:{padding:"10px",backgroundColor:"#dbe8fb",border:"1px dashed #79a5e4"}},{data:"txc-textbox13",style:{padding:"10px",backgroundColor:"#ffffff",border:"1px solid #cbcbcb"}},{data:"txc-textbox14",style:{padding:"10px",backgroundColor:"#eeeeee",border:"1px solid #c1c1c1"}},{data:"txc-textbox15",style:{padding:"10px",backgroundColor:"#fefeb8",border:"1px solid #f3c534"}},{data:"txc-textbox16",style:{padding:"10px",backgroundColor:"#fedec7",border:"1px solid #fe8943"}},{data:"txc-textbox17",style:{padding:"10px",backgroundColor:"#e7fdb5",border:"1px solid #9fd331"}},{data:"txc-textbox18",style:{padding:"10px",backgroundColor:"#dbe8fb",border:"1px solid #79a5e4"}},{data:"txc-textbox19",style:{padding:"10px",backgroundColor:"#ffffff",border:"3px double #cbcbcb"}},{data:"txc-textbox20",style:{padding:"10px",backgroundColor:"#eeeeee",border:"3px double #c1c1c1"}},{data:"txc-textbox21",style:{padding:"10px",backgroundColor:"#fefeb8",border:"3px double #f3c534"}},{data:"txc-textbox22",style:{padding:"10px",backgroundColor:"#fedec7",border:"3px double #fe8943"}},{data:"txc-textbox23",style:{padding:"10px",backgroundColor:"#e7fdb5",border:"3px double #9fd331"}},{data:"txc-textbox24",style:{padding:"10px",backgroundColor:"#dbe8fb",border:"3px double #79a5e4"}}]}};
var TrexConfig=function(){var __IS_SETUP=false;var __POST_PROCESSOR=[];var __TREX_PARAM={};var __TREX_CONFIGURE={wrapper:"tx_trex_container",form:"tx_editor_form",params:[],pvpage:"#host#path/pages/blank.html",events:{preventUnload:true,useHotKey:true},save:{},adaptor:{},toolbar:{},sidebar:{attachbox:{},embeder:{},attacher:{},searcher:{}},plugin:{}};var __ICON_IMAGES_PATH="../images/icon/";var __DECO_IMAGES_PATH="../images/deco/";var _deepcopy=function(preset,service){var _dest=preset;if(!service){return _dest}for(var _name in service){switch(typeof(service[_name])){case"string":case"number":case"boolean":case"date":case"function":_dest[_name]=service[_name];break;default:if(service[_name]){if(service[_name].constructor==Array){_dest[_name]=[].concat(service[_name])}else{_dest[_name]=_dest[_name]||{};_deepcopy(_dest[_name],service[_name])}}else{_dest[_name]=null}break}}return _dest};var _createAnchors=function(){with(__TREX_CONFIGURE){return{Tool:toolbar,Sidebar:sidebar,Plugin:plugin,Adaptor:adaptor,Save:save,Attacher:sidebar.attacher,Embeder:sidebar.embeder,Searcher:sidebar.searcher}
}};var _addParameter=function(tname,pname){if(__IS_SETUP){throw new Error("configure is already setup (addParameter)")}__TREX_PARAM[tname]=pname};var _trexConfig={getUrl:function(url,params){if(url==null){return null}url=url.replace(/#host/g,__TREX_CONFIGURE.txHost).replace(/#path\/?/g,__TREX_CONFIGURE.txPath);for(var _name in __TREX_PARAM){url=url.replace(new RegExp("#".concat(_name),"g"),__TREX_CONFIGURE[__TREX_PARAM[_name]])}if(params){for(var name in params){url=url.replace(new RegExp("#".concat(name),"g"),params[name])}}return url},getPopFeatures:function(features){if(features==null){return null}if(typeof(features)==="string"){return features}var popFeatures=[];["toolbar","location","directories","menubar"].each(function(name){popFeatures.push(name+"="+(features[name]||"no"))});["scrollbars","resizable"].each(function(name){popFeatures.push(name+"="+(features[name]||"yes"))});["width","height"].each(function(name){popFeatures.push(name+"="+(features[name]||"500"))});["left","top"].each(function(name){popFeatures.push(name+"="+(features[name]||"100"))
});return popFeatures.join(",")},getDecoPath:function(url,subpath){if(__TREX_CONFIGURE.txDecoPath){url=url.replace(/#decopath\/?/,__TREX_CONFIGURE.txDecoPath)}else{subpath=subpath?subpath+"/":"";url=url.replace(/#decopath\/?/,__DECO_IMAGES_PATH+subpath)}return url},getIconPath:function(url,subpath){if(__TREX_CONFIGURE.txIconPath){url=url.replace(/#iconpath\/?/,__TREX_CONFIGURE.txIconPath)}else{subpath=subpath?subpath+"/":"";url=url.replace(/#iconpath\/?/,__ICON_IMAGES_PATH+subpath)}return url},setup:function(config){_deepcopy(__TREX_CONFIGURE,config);__TREX_CONFIGURE.params.each(function(name){_addParameter(name,name)});__POST_PROCESSOR.each(function(fn){fn(__TREX_CONFIGURE)});__IS_SETUP=true;return __TREX_CONFIGURE},addParameter:function(tname,pname){_addParameter(tname,pname)},clone:function(config){return _deepcopy({},config)},merge:function(){var _config={};$A(arguments).each(function(source){_deepcopy(_config,source)});return _config}};_trexConfig.add=function(config,postprocessing){if(__IS_SETUP){throw new Error("configure is already setup (mergeConfig)")
}_deepcopy(__TREX_CONFIGURE,config);if(postprocessing){__POST_PROCESSOR.push(postprocessing)}};_trexConfig.get=function(key){return __TREX_CONFIGURE[key]};var _addConfig=function(key,config,postprocessing){if(__IS_SETUP){throw new Error("configure is already setup (mergeConfig)")}this[key]=this[key]||{};_deepcopy(this[key],config);if(postprocessing){__POST_PROCESSOR.push(postprocessing)}};var _getConfig=function(key){return this[key]};var _anchors=_createAnchors();for(var _name in _anchors){_trexConfig["add"+_name]=_addConfig.bind(_anchors[_name]);_trexConfig["get"+_name]=_getConfig.bind(_anchors[_name])}return _trexConfig}();var TrexMessage=function(){var c={};var d=function(k,e){var j=k;for(var h in e){switch(typeof(e[h])){case"undefined":case"null":case"string":case"number":case"boolean":case"date":case"function":j[h]=e[h];break;default:if(e[h].constructor==Array){j[h]=[].concat(e[h])}else{d(j[h]||{},e[h])}break}}return j};var a={getMsg:function(h){var e=c[h]||"";if(e.indexOf("#iconpath")>-1){e=TrexConfig.getIconPath(e)
}if(e.indexOf("#decopath")>-1){e=TrexConfig.getDecoPath(e)}return e},addMsg:function(e){d(c,e)},printAll:function(){var h=console;for(var e in c){h.log(e+"="+c[e])}}};return a}();window.TXMSG=TrexMessage.getMsg;Trex.MarkupTemplate={};(function(){var a={};Trex.define(Trex.MarkupTemplate,{add:function(c,d){a[c]=d},get:function(c){if(!a[c]){return{evaluate:function(){return""},evaluateToDom:function(){return""}}}if(typeof(a[c])=="string"){var d=a[c].replace(/@[\w\.]+/g,function(e){return TXMSG(e)});a[c]=new Template(d)}return a[c]},splitList:function(o,k,h){var e={row:[]};var m=h.length;var l=e.row;for(var n=0;n<o;n++){l.push({col:[]});var c=l.last().col;for(var d=0;d<k;d++){var j={image:"",data:"&nbsp;",klass:""};if(n*k+d<m){if(typeof(h[n*k+d])=="string"){j.data=h[n*k+d]}else{j=Object.extend(j,h[n*k+d])}}c.push(j)}}return e}})})();var $tom={};(function(){var j={"%body":["body"],"%text":["#text","br"],"%element":["#element"],"%control":["img","object","hr","table","button"],"%inline":["span","font","u","i","b","em","strong","big","small","a","sub","sup","span"],"%block":["p","div","ul","ol","h1","h2","h3","h4","h5","h6","pre","dl","hr","table","button"],"%paragraph":["p","li","dd","dt","h1","h2","h3","h4","h5","h6","td","th","div","caption"],"%wrapper":["div","ul","ol","dl","pre","xmp","table","button"],"%innergroup":["li","dd","dt","td","th"],"%outergroup":["ul","ol","dl","tr","tbody","thead","tfoot","table"],"%tablegroup":["td","th","tr","tbody","thead","tfoot","table"],"%listgroup":["li","ul","ol"],"%datagroup":["dd","dt","dl"],"%listhead":["ul","ol"]};
var c={};for(var d in j){c[d]={};if(j[d]){$A(j[d]).each(function(k){c[d][k]=true})}}function a(k){var m={};var l=k.split(",");l.each(function(o){if(c[o]){for(var n in c[o]){m[n]=true}}else{m[o]=true}});return m}var h=Trex.Class.create({initialize:function(k){this.patterns=k;this.map=a(k)},hasParts:function(){return(this.patterns.length>0)},include:function(m){var l=a(m);for(var k in l){if(this.map[k]){return true}}return false},memberOf:function(m){var l=a(m);for(var k in this.map){if(l[k]){return true}}return false},extract:function(n){var m=a(n);var l=[];for(var k in this.map){if(m[k]){l.push(k)}}return $tom.translate(l.join(","))},getExpression:function(){if(!this.exprs){var l=[];for(var k in this.map){l.push(k)}this.exprs=l.join(",")}return this.exprs}});var e={};Object.extend($tom,{translate:function(k){if(!e[k]){e[k]=new h(k)}return e[k]}})})();Object.extend($tom,{__POSITION:{__START_OF_TEXT:-1,__MIDDLE_OF_TEXT:0,__END_OF_TEXT:1}});Object.extend($tom,{isElement:function(a){return $tom.kindOf(a,"%element")
},isBody:function(a){return $tom.kindOf(a,"%body")},isBlock:function(a){return $tom.kindOf(a,"%block")},isParagraph:function(a){return $tom.kindOf(a,"%paragraph")},isInline:function(a){if(this.isText(a)){return true}return $tom.kindOf(a,"%inline")},isText:function(a){return $tom.kindOf(a,"%text")},isControl:function(a){return $tom.kindOf(a,"%control")},getName:function(a){return((a&&a.nodeType==1)?a.nodeName.toLowerCase():"")},getText:function(a){return a.textContent||a.text||a.innerText||""},getLength:function(a){if(!a){return 0}if(a.nodeType==1){return a.childNodes.length}else{if(a.nodeType==3){return a.nodeValue.length}}return 0},indexOf:function(a){if(!a){return -1}var e=-1;var d=a.parentNode;var c=d.firstChild;while(c){e++;if(c==a){break}c=c.nextSibling}return e},hasContent:function(c,a){if(!c||c.nodeType!=3){return true}var d=$tom.removeMeaninglessSpace(c.nodeValue);if(a){d=d.replace(/\ufeff/g,"")}return(d!="")},hasChildren:function(c,a){if(!c){return false}var d=$tom.removeMeaninglessSpace(c.innerHTML);
if(a){d=d.replace(/\ufeff/g,"")}if(!d){return false}if(d.stripTags()){return true}if(d.search(/<br\s?\/?>/i)>-1){return true}if(d.search(/<span\sid="?tx_(start|end)_marker"?><\/span>/i)>-1){return true}return false},hasData:function(c,a){if(!c){return false}var d="";if(c.nodeType==1){d=c.innerHTML}else{d=c.nodeValue}d=$tom.removeMeaninglessSpace(d);if(d==""){return false}if(d.stripTags()!=""){return true}if(a){return false}if(d.search(/<br\s?\/?>/i)>-1){return true}return false},removeMeaninglessSpace:function(a){return a.replace(/(^[\f\n\r\t\v\u2028\u2029]*)|([\f\n\r\t\v\u2028\u2029]*$)/g,"")}});Object.extend($tom,{find:function(){var a,c;if(arguments.length==1){if(typeof(arguments[0])==="string"){a=document;c=arguments[0]}}else{if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){a=arguments[0];c=arguments[1]}}}if(!c){return null}var d=$tom.translate(c);return dFindy(a,d.getExpression())},collect:function(){var a,c;if(arguments.length==1){if(typeof(arguments[0])==="string"){a=document;
c=arguments[0]}}else{if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){a=arguments[0];c=arguments[1]}}}if(!c){return null}var d=$tom.translate(c);return dGetty(a,d.getExpression())},collectAll:function(){var a,c;if(arguments.length==1){if(typeof(arguments[0])==="string"){a=document;c=arguments[0]}}else{if(arguments.length==2){if(arguments[0].nodeType&&typeof(arguments[1])==="string"){a=arguments[0];c=arguments[1]}}}if(!c){return[]}var d=$tom.translate(c);return dGetties(a,d.getExpression())}});(function(){function a(c){if(c){if(typeof(c)==="function"){return c}else{var d=$tom.translate(c);return function(e){if(e.nodeType==1){if(d.include("#element")){return true}else{return dChecky(e,d.getExpression())}}else{return d.include("#text")}}}}else{return null}}Object.extend($tom,{kindOf:function(c,d){if(!c||!d){return false}return a(d)(c)},ancestor:function(d,e){if(!d||!d.parentNode){return null}var h=a(e);var c=d.parentNode;while(c){if($tom.isBody(c)){return null
}if(!h||h(c)){break}c=c.parentNode}return c},descendant:function(c,d){var e=$tom.descendants(c,d,true);if(e.length==0){return null}return e[0]},descendants:function(d,h,l){l=l||false;if(!d||!d.firstChild){return[]}var c=false;var k=a(h);var j=[];var e=function(o){if(l&&c){return}if(!$tom.first(o)){return}var p=$tom.children(o);for(var n=0,m=p.length;n<m;n++){if(!k||k(p[n])){j.push(p[n]);c=true}else{e(p[n])}}};e(d);return j},children:function(d,e){var h=[];if(!d||!d.firstChild){return h}var j=a(e);var c=$tom.first(d);while(c){if(!j||j(c)){h.push(c)}c=c.nextSibling}return h},next:function(d,e){if(!d||!d.nextSibling){return null}var h=a(e);var c=d.nextSibling;while(c){if($tom.hasContent(c)){if(!h||h(c)){break}}c=c.nextSibling}return c},previous:function(d,e){if(!d||!d.previousSibling){return null}var h=a(e);var c=d.previousSibling;while(c){if($tom.hasContent(c)){if(!h||h(c)){break}}c=c.previousSibling}return c},first:function(d,e){if(!d||!d.firstChild){return null}var h=a(e);var c=d.firstChild;
while(c){if($tom.hasContent(c)){if(!h||h(c)){break}}c=c.nextSibling}return c},last:function(d,e){if(!d||!d.lastChild){return null}var h=a(e);var c=d.lastChild;while(c){if($tom.hasContent(c)){if(!h||h(c)){break}}c=c.previousSibling}return c},extract:function(e,l,h){var j=[];if(!e||!l){return j}var k=a(h);var c=false;var d=e.firstChild;while(d){if($tom.include(d,l)){c=true}if(k&&k(d)){j.push(d)}else{if(c){break}else{j=[]}}d=d.nextSibling}return j},parent:function(c){if(!c||!c.parentNode){return null}return c.parentNode},body:function(d){if(!d||!d.parentNode){return null}var c=d.parentNode;while(c){if($tom.isBody(c)){return c}c=c.parentNode}return null},top:function(d,e){e=e||false;var c=d;while($tom.first(c)){c=$tom.first(c)}if(e){return c}else{if($tom.kindOf(c,"#tx_start_marker,#tx_end_marker")){c=c.nextSibling||c.parentNode}else{if($tom.kindOf(c,"%control")){c=c.parentNode}}return c}},bottom:function(d,e){e=e||false;var c=d;while($tom.last(c)){c=$tom.last(c)}if(e){return c}else{if($tom.kindOf(c,"#tx_start_marker,#tx_end_marker")){c=c.previousSibling||c.parentNode
}else{if($tom.kindOf(c,"%control")){c=c.parentNode}}return c}},include:function(d,e){if(!d||!e){return false}if(d==e){return true}var c=e;while(c){if($tom.isBody(c)){return false}else{if(c==d){return true}}c=c.parentNode}return false}})})();Object.extend($tom,{insertFirst:function(a,c){if(!a||!c){return}if(a.firstChild){a.insertBefore(c,a.firstChild)}else{a.appendChild(c)}return c},insertAt:function(a,c){if(!a||!c){return}c.parentNode.insertBefore(a,c);return a},insertNext:function(a,c){if(!a||!c){return}if(c.nextSibling){c.parentNode.insertBefore(a,c.nextSibling)}else{c.parentNode.appendChild(a)}return a},append:function(a,c){if(!a||!c){return}a.appendChild(c);return c},remove:function(a){if(!a){return}if(a.parentNode){a.parentNode.removeChild(a)}a=null},html:function(c,a){if(!c){return}c.innerHTML=a||"";return c},clean:function(a){return $tom.html(a)},stuff:function(d,c){if(!d){return d}if($tom.hasChildren(d,true)){return d}if(d.lastChild){var a=d;while(a.lastChild){a=a.lastChild}$tom.insertNext(c,a)
}else{$tom.append(d,c)}return d}});Object.extend($tom,{moveChild:function(a,d,c,h){if(!a||!d){return}c=Math.min(Math.max(c||0),a.childNodes.length);h=Math.min(Math.max(h||a.childNodes.length),a.childNodes.length);if(c>=h){return}var e=c;while(e++<h){d.appendChild(a.childNodes[c])}},moveChildToParent:function(a){if(!a){return}while(a.firstChild){a.parentNode.insertBefore(a.firstChild,a)}}});Object.extend($tom,{replace:function(a,c){if(!a||!c){return null}if($tom.getName(a)==$tom.getName(c)){$tom.remove(c);return a}else{$tom.insertAt(c,a);$tom.moveChild(a,c);$tom.remove(a);return c}},clone:function(c,a){return c.cloneNode(!!a)}});Object.extend($tom,{wrap:function(a,c){if(!a||!c){return null}if(!c.length){c=[].concat(c)}$tom.insertAt(a,c[0]);c.each((function(d){$tom.append(a,d)}));return a},unwrap:function(a){if(!a){return null}var c=$tom.first(a);$tom.moveChildToParent(a);$tom.remove(a);return c}});Object.extend($tom,{divideText:function(c,d){if(!$tom.isText(c)){return c}if(d<=0||d>=c.length){return c
}var a=c.cloneNode(false);c.deleteData(d,c.length);a.deleteData(0,d);$tom.insertNext(a,c);return a},divideNode:function(e,h){if(!$tom.isElement(e)){return null}var c=e.childNodes.length-h;var a=e.cloneNode(false);for(var d=0;d<c;d++){$tom.insertFirst(a,e.lastChild)}$tom.insertNext(a,e);return a},divideParagraph:function(e){var c=e;var a=$tom.indexOf(e);var d=c;while(c){if($tom.isBody(c)){break}else{if($tom.kindOf(c,"td,th,%wrapper,%outergroup")){break}else{if($tom.kindOf(c,"#tx_start_marker,#tx_end_marker")){a=$tom.indexOf(c)}else{if($tom.isControl(c)){a=$tom.indexOf(c)}else{if($tom.isText(c)){c=$tom.divideText(c,a);a=$tom.indexOf(c)}else{c=$tom.divideNode(c,a);a=$tom.indexOf(c);d=c;if($tom.kindOf(c,"p,li,dd,dt,h1,h2,h3,h4,h5,h6")){break}}}}}}c=c.parentNode}return d},split:function(d,a){if(!d){return null}var c=d;var e=[c];$A(d.getElementsByTagName(a)).each(function(h){if($tom.last(c)!=h){c=$tom.divideNode(c,$tom.indexOf(h)+1);e.push(c)}});return e}});Object.extend($tom,{paragraphOf:function(a){if(!a){return"p"
}var c=$tom.translate(a);if(c.memberOf("ul,ol")){return"li"}else{if(c.memberOf("dl")){return"dd"}else{if(c.memberOf("tr,tbody,thead,tfoot,table")){return"td"}else{return"p"}}}},inlineOf:function(){return"span"},outerOf:function(a){if(!a){return"span"}var c=$tom.translate(a);if(c.memberOf("li")){return"ol"}else{if(c.memberOf("dd,dt")){return"dl"}else{if(c.memberOf("td,th,tr")){return"table"}else{return"p"}}}}});(function(){var c=0;var e=Trex.Class.create({$const:{__FONT_SIZE_BASIS:9,__REG_EXT_NUMBER:new RegExp("[0-9.]+"),__REG_EXT_UNIT:new RegExp("px|pt|em")},initialize:function(){this.unitConverter={px2em:1/12,px2pt:9/12,em2px:12/1,em2pt:9/1,pt2px:12/9,pt2em:1/9}},calculate:function(m,k){if(m==null||m.length==0){m="0em"}if(k==null||k.length==0){k="0em"}var p=this.extractSign(k);var n=this.extractUnit(m);var l=this.extractUnit(k);var j=this.extractNumber(m).toNumber();var h=this.extractNumber(k).toNumber();if(n!=l){if(this.unitConverter[n+"2"+l]){j*=this.unitConverter[n+"2"+l]}}var o=0;if(p=="-"){o=Math.max(j-h,0)
}else{o=(j+h)}o=(Math.round(o*10)/10);if(o==0){return null}else{return o+l}},needCalculation:function(h){if(h==null){return false}else{return(h.charAt(0)=="+"||h.charAt(0)=="-")}},extractSign:function(j){var k="+";var h;if(j.charAt(0)=="+"||j.charAt(0)=="-"){k=j.charAt(0)}return k},extractNumber:function(k){var h=0;var j;if((j=k.match(e.__REG_EXT_NUMBER))!=null){h=j[0]}if(k.indexOf("%")>-1){h=h/100}return h},extractUnit:function(k){var h="em";var j;if((j=k.match(e.__REG_EXT_UNIT))!=null){h=j[0]}return h}});var d=new e();var a={colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",datetime:"dateTime",accesskey:"accessKey",tabindex:"tabIndex",enctype:"encType",maxlength:"maxLength",readonly:"readOnly",longdesc:"longDesc"};Object.extend($tom,{applyAttributes:function(k,j){if(!$tom.isElement(k)){return}for(var h in j){if(h=="style"){$tom.applyStyles(k,j[h])}else{$tom.setAttribute(k,h,j[h])}}},removeAttributes:function(k,j){if(!$tom.isElement(k)){return}for(var h in j){if(h=="style"){$tom.removeStyles(j[h])
}else{k.removeAttribute(h,c)}}},existAttributes:function(l,k){if(!$tom.isElement(l)){return false}var m;for(var j in k){if(j=="style"){for(var h in k[j]){m=l.style[h];return(m!=null&&m.length>0)}}else{m=l[j];return(m!=null&&m.length>0)}}return false},getAttribute:function(j,h){if(!$tom.isElement(j)){return null}if(j&&j.getAttribute){return j.getAttribute(a[h]||h)}else{return null}},setAttribute:function(j,h,l){if(!$tom.isElement(j)){return}if(l==null||l.length==0||l==0){j.removeAttribute(h,c)}else{try{j[h]=l}catch(k){j.setAttribute(a[h]||h,l)}}},applyStyles:function(k,j){var l;for(var h in j){if(d.needCalculation(j[h])){l=d.calculate(k.style[h],j[h])}else{l=j[h]}if(l==null||l.length==0){l=null}k.style[((h=="float")?((k.style.styleFloat===undefined)?"cssFloat":"styleFloat"):h)]=l}var m=$tom.getAttribute(k,"style");if(m==null){k.removeAttribute("style",c)}},removeStyles:function(k,j){for(var h in j){k.style[((h=="float")?((k.style.styleFloat===undefined)?"cssFloat":"styleFloat"):h)]=null}var l=$tom.getAttribute(k,"style");
if(l==null){k.removeAttribute("style",c)}},getStyleText:function(h){return $tom.getAttribute(h,"style")},setStyleText:function(h,j){return $tom.setAttribute(h,"style",j)}})})();Object.extend($tom,{goInto:function(c,a){if(!c||!c.scrollIntoView){return}c.scrollIntoView(a)},getScrollTop:function(a){if(!a){return 0}return(a.documentElement.scrollTop||a.body.scrollTop)},setScrollTop:function(c,a){if(!c){return}if(c.documentElement.scrollTop){c.documentElement.scrollTop=a}else{c.body.scrollTop=a}},getScrollLeft:function(a){if(!a){return 0}return(a.documentElement.scrollLeft||a.body.scrollLeft)},setScrollLeft:function(a,c){if(!a){return}if(a.documentElement.scrollLeft){a.documentElement.scrollLeft=c}else{a.body.scrollLeft=c}},getPosition:function(h,o){if(!h){return{x:0,y:0,width:0,height:0}}o=!!o;h=$tx(h);var m=(o)?$tx.cumulativeOffset(h):$tx.positionedOffset(h);var j;var l=h.style.display;if(l!="none"&&l!=null){j={width:h.offsetWidth,height:h.offsetHeight}}else{var d=h.style;var n=d.visibility;
var k=d.position;var c=d.display;d.visibility="hidden";d.position="absolute";d.display="block";var a=h.clientWidth;var e=h.clientHeight;d.display=c;d.position=k;d.visibility=n;j={width:a,height:e}}return{x:m[0],y:m[1],width:j.width,height:j.height}},getWidth:function(a){return(a.style.width||a.offsetWidth).parsePx()},setWidth:function(c,a){$tom.applyStyles(c,{width:a})},getHeight:function(a){return(a.style.height||a.offsetHeight).parsePx()},setHeight:function(c,a){$tom.applyStyles(c,{height:a})},replacePngPath:function(d){if($tx.msie&&$tx.msie_ver<7){if(document.location.href.indexOf("http://")>-1){return}try{var k=$tx.getStyle(d,"filter");var c=/src='([^']+)'/.exec(k)[1];if(!c||c=="none"){return}else{if(c.indexOf("http://")>-1){return}}var a=document.location.href.split("/");a.push("css");a.pop();c=c.replace(/\.\.\//g,function(e){a.pop();return""});var h=a.join("/")+"/"+c;d.style.filter=k.replace(/src='([^']+)'/,"src='"+h+"'")}catch(j){alert(j)}}}});(function utils(a){a.Util={_dispElIds:[],getDispElId:function(){var c;
do{c="tx_entry_"+Math.floor(Math.random()*10000)}while(a.Util._dispElIds.include(c));a.Util._dispElIds.push(c);return c},generateKey:function(){return parseInt(Math.random()*100000000)},toStyleString:function(d){var e=[];for(var c in d){if(d[c]){e.push(c.replace(/([A-Z])/g,"-$1").toLowerCase());e.push(":");e.push(d[c]);e.push(";")}}return e.join("")},toAttrString:function(d){var e=[];for(var c in d){if(d[c]){e.push(" "+c+'="'+d[c]+'"')}}return e.join("")},getMatchValue:function(e,d,h){var c;if((c=e.exec(d))!=null){return c[h]}else{return null}},getAttachmentType:function(c){c=(c||"").toLowerCase();switch(c){case"image/jpg":case"image/jpeg":case"image/png":case"image/tiff":case"image/gif":case"image/bmp":case"image/x-jg":case"image/ief":case"image/pict":case"jpg":case"bmp":case"gif":case"png":return"image";default:return"file"}},thumburl:function(c){c=(c||"").toLowerCase();switch(c){case"doc":case"docx":return TrexConfig.getIconPath("#iconpath/pn_word.gif?rv=1.0.1");case"xls":case"xlsx":return TrexConfig.getIconPath("#iconpath/pn_xls.gif?rv=1.0.1");
case"ppt":case"pptx":return TrexConfig.getIconPath("#iconpath/pn_ppt.gif?rv=1.0.1");case"pdf":return TrexConfig.getIconPath("#iconpath/pn_pdf.gif?rv=1.0.1");case"txt":return TrexConfig.getIconPath("#iconpath/pn_txt.gif?rv=1.0.1");case"hwp":return TrexConfig.getIconPath("#iconpath/pn_hwp.gif?rv=1.0.1");case"zip":case"alz":return TrexConfig.getIconPath("#iconpath/pn_zip.gif?rv=1.0.1");case"mp3":case"wav":case"ogg":case"wma":case"mp4":case"ape":case"ra":case"ram":return TrexConfig.getIconPath("#iconpath/pn_mp3.gif?rv=1.0.1");case"avi":case"mpeg":case"wmv":case"asf":return TrexConfig.getIconPath("#iconpath/pn_movie.gif?rv=1.0.1");case"swf":return TrexConfig.getIconPath("#iconpath/pn_swf.gif?rv=1.0.1");case"htm":case"html":return TrexConfig.getIconPath("#iconpath/pn_html.gif?rv=1.0.1");case"jpg":case"gif":case"png":case"bmp":TrexConfig.getIconPath("#iconpath/pn_etc.gif?rv=1.0.1");default:return TrexConfig.getIconPath("#iconpath/pn_etc.gif?rv=1.0.1")}},prevurl:function(c){c=(c||"").toLowerCase();
switch(c){case"doc":case"docx":return TrexConfig.getIconPath("#iconpath/p_word_s.gif?rv=1.0.1");case"xls":case"xlsx":return TrexConfig.getIconPath("#iconpath/p_xls_s.gif?rv=1.0.1");case"ppt":case"pptx":return TrexConfig.getIconPath("#iconpath/p_ppt_s.gif?rv=1.0.1");case"pdf":return TrexConfig.getIconPath("#iconpath/p_pdf_s.gif?rv=1.0.1");case"txt":return TrexConfig.getIconPath("#iconpath/p_txt_s.gif?rv=1.0.1");case"hwp":return TrexConfig.getIconPath("#iconpath/p_hwp_s.gif?rv=1.0.1");case"zip":case"alz":return TrexConfig.getIconPath("#iconpath/p_zip_s.gif?rv=1.0.1");case"mp3":case"wav":case"ogg":case"wma":case"mp4":case"ape":case"ra":case"ram":return TrexConfig.getIconPath("#iconpath/p_mp3_s.gif?rv=1.0.1");case"avi":case"mpeg":case"wmv":case"asf":return TrexConfig.getIconPath("#iconpath/p_movie_s.gif?rv=1.0.1");case"swf":return TrexConfig.getIconPath("#iconpath/p_swf_s.gif?rv=1.0.1");case"htm":case"html":return TrexConfig.getIconPath("#iconpath/p_html_s.gif?rv=1.0.1");case"jpg":return TrexConfig.getIconPath("#iconpath/p_jpg_s.gif?rv=1.0.1");
case"gif":return TrexConfig.getIconPath("#iconpath/p_gif_s.gif?rv=1.0.1");case"png":case"bmp":return TrexConfig.getIconPath("#iconpath/p_png_s.gif?rv=1.0.1");default:return TrexConfig.getIconPath("#iconpath/p_etc_s.gif?rv=1.0.1")}},getMatchedClassName:function(j,h){var c=false;var d="";for(var e=0;e<h.length;e++){d=h[e];if($tx.hasClassName(j,d)){c=d;break}}return c},getAllAttributesFromEmbed:function(c){var j={};c=c.replace(/<embed|>/ig,"");try{var h=/(\w+)=((?:\")[^\"]+(?:\"|$)|(?:')[^']+(?:'|$)|(?:[^\"'][^ \n]+($| |\n)))/ig;while((result=h.exec(c))!=null){j[result[1].trim().toLowerCase()]=result[2].replace(/^(\"|')/i,"").replace(/(\"|')$/i,"").trim()}}catch(d){}return j},getAllAttributes:function(e){var h={};var c;var d=new RegExp('style="[^"]*(?:width|WIDTH)\\s*:\\s*([0-9]+)px[^"]*"',"g");while((c=d.exec(e))!=null){h.width=c[1]}d=new RegExp('style="[^"]*(?:height|HEIGHT)\\s*:\\s*([0-9]+)px[^"]*"',"g");while((c=d.exec(e))!=null){h.height=c[1]}d=new RegExp('\\s+([a-zA-Z]+)="([^"]*)"',"g");
while((c=d.exec(e))!=null){if(!h[c[1].toLowerCase()]){h[c[1].toLowerCase()]=c[2]}}d=new RegExp("\\s+([a-zA-Z]+)='([^']*)'","g");while((c=d.exec(e))!=null){if(!h[c[1].toLowerCase()]){h[c[1].toLowerCase()]=c[2]}}d=new RegExp("\\s+([a-zA-Z]+)=([^\\s>]*)","g");while((c=d.exec(e))!=null){if(!h[c[1].toLowerCase()]){h[c[1].toLowerCase()]=c[2]}}return h}};a.HtmlCreator={createTableMarkup:function(k,l,e){var d=[];d.push('<table unselectable="on">');d.push("<tbody>");var c=e.length;var j;for(var m=0;m<k;m++){d.push("<tr>");for(var h=0;h<l;h++){if(m*l+h<c){j=e[m*l+h];if(j.image){d.push('<td class="tx-menu-list-item"><a href="javascript:;"><span class="'+((j.klass)?j.klass:"")+'"><img src="'+j.image+'" data="'+j.data+'"/></span></a></td>')}else{d.push('<td class="tx-menu-list-item"><a href="javascript:;"><span class="'+((j.klass)?j.klass:"")+'">'+j.data+"</span></a></td>")}}else{d.push('<td class="tx-menu-list-item"><a href="javascript:;"><span class="">&nbsp;</span></a></td>')}}d.push("</tr>")}d.push("</tbody>");
d.push("</table>");return d.join("\n")}};a.String={escapeQuot:function(c){return c.replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("'","g"),"&#39;")},unescapeQuot:function(c){return c.replace(new RegExp("&quot;","gi"),'"').replace(new RegExp("&#39;","g"),"'")},htmlspecialchars:function(c){return a.String.escapeQuot(c.replace(new RegExp("&","g"),"&amp;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;"))},unHtmlspecialchars:function(c){return a.String.unescapeQuot(c.replace(new RegExp("&amp;","gi"),"&").replace(new RegExp("&lt;","gi"),"<").replace(new RegExp("&gt;","gi"),">"))},parseAttribute:function(c,h){var j=new RegExp("(^|\\W)"+h+'="([^"]*)"',"gi");var e=new RegExp("(^|\\W)"+h+"='([^']*)'","gi");var d=new RegExp("(^|\\W)"+h+"=([^\\s>]*)","gi");if(result=j.exec(c)){return result[2]}else{if(result=e.exec(c)){return result[2]}else{if(result=d.exec(c)){return result[2]}else{return""}}}},changeAttribute:function(c,j,m){var k=new RegExp("(^|\\W)"+j+'="([^"]*)"',"gi");
var h=new RegExp("(^|\\W)"+j+"='([^']*)'","gi");var e=new RegExp("(^|\\W)"+j+"=([^\\s>]*)","gi");var d=new RegExp("<([\\w]+\\s*)","gi");var l=false;if(c.search(k)>-1){l=true;c=c.replace(k,m)}if(c.search(h)>-1){l=true;c=c.replace(h,m)}if(c.search(e)>-1){l=true;c=c.replace(e,m)}if(!l){c=c.replace(d,"<$1"+m+" ")}return c}};a.Validator=a.Class.create({initialize:function(){},strip:function(c){return c.stripTags().replace(/&nbsp;/g,"").replace(/\ufeff/g,"").trim()},exists:function(c){if(!c){return false}if(this.strip(c)==""){if(c.search(/<(img|iframe|embed|table|hr|script|TXDB)/i)<0){return false}}return true},equals:function(c,d){if(!c||!d){return false}if(c.search(/<(img|iframe|embed|table|hr|script|TXDB)/i)<0){if(this.strip(c)==this.strip(d)){return true}}return false}});a.Repeater=a.Class.create({initialize:function(c){this.execHandler=c},start:function(c){if(this.tItv){this.clear()}this.tItv=window.setInterval(this.onTimer.bind(this),c)},clear:function(){window.clearInterval(this.tItv);
this.tItv=null},onTimer:function(){if(this.execHandler!=null){this.execHandler()}}});a.Timer=a.Class.create({initialize:function(c){this.execHandler=c},start:function(c){window.setTimeout(this.onTimer.bind(this),c)},onTimer:function(){if(this.execHandler!=null){this.execHandler()}}});a.Paging=a.Class.create({$const:{DEFAULT_PAGE_SIZE:5,DEFAULT_BLOCK_SIZE:10},initialize:function(d,c){this.data=d;this.currentpage=c.initPage||1;this.totalrow=c.totalrow||this.getTotalRow();this.pagesize=c.pagesize||a.Paging.DEFAULT_PAGE_SIZE;this.blocksize=c.blocksize||a.Paging.DEFAULT_PAGE_SIZE;this.totalpage=Math.ceil(this.totalrow/this.pagesize);this.totalblock=Math.ceil(this.totalpage/this.blocksize)},getNextPage:function(){return(this.currentpage<this.totalpage)?this.currentpage+1:0},getPrevPage:function(){return(this.currentpage>1)?this.currentpage-1:0},getNextBlock:function(){var c=Math.ceil(this.currentpage/this.blocksize);return(c<this.totalblock)?c*this.blocksize+1:0},getPrevBlock:function(){var c=Math.ceil(this.currentpage/this.blocksize);
return(c>1)?(c-2)*this.blocksize+1:0},getPageList:function(){var d=[];var c=Math.ceil(this.currentpage/this.blocksize)-1;var h=(c*this.blocksize+1);var j=Math.min(this.totalpage,(h+this.blocksize-1));for(var e=h;e<=j;e++){d.push(e)}return d},movePage:function(c){this.currentpage=c||this.currentpage},getOnePageData:function(){var c=[];var h=(this.currentpage-1)*this.pagesize;var d=Math.min(this.currentpage*this.pagesize,this.totalrow);for(var e=h;e<d;e++){c.push(this.data[e])}return c},getTotalRow:function(){return this.data.length}});a.Slidebar=a.Class.create({initialize:function(c){this.elContext=c.el;this.knobWidth=c.knobWidth;this.isDisabled=false;this.handler=function(e){if(!this.isDisabled&&typeof c.handler=="function"){c.handler(e)}};c.defaultValue=c.defaultValue||0;this.logicObj={interval:c.interval||5,min:c.min||0,max:c.max||100};this.physicObj={min:0,width:c.barSize||100};this.physicObj.max=this.physicObj.width-this.knobWidth;this.physicObj.interval=this.logicObj.interval*this.physicObj.max/this.logicObj.max;
this.startPos=0;this.startX=0;this.isDrag=false;this.result=0;var d=$tom.collect(this.elContext,"dd.tx-slide");$tom.collect(d,"span.tx-slide-min").innerHTML="";$tom.collect(d,"span.tx-slide-max").innerHTML="";this.bindEvent();this.setKnobPosition(c.defaultValue)},regenerate:function(c){c=parseInt(c*this.physicObj.width/this.logicObj.max);this.setKnobPosition(c)},bindEvent:function(){var e=$tom.collect(this.elContext,"dd.tx-slide");var d=$tom.collect(e,"a.tx-slide-prev");var c=$tom.collect(e,"a.tx-slide-next");var j=$tom.collect(e,"div.tx-slide-bar");var h=this.elKnob=$tom.collect(e,"div.tx-slide-knob");$tx.observe(h,"mousedown",function(k){this.isDrag=true;this.startPos=this.getKnobPosition();this.startX=k.clientX;$tx.stop(k)}.bind(this));$tx.observe(h,"mouseup",function(k){this.isDrag=false}.bind(this));$tx.observe(this.elContext,"mousemove",function(k){if(this.isDrag){this.setKnobPosition(this.startPos+k.clientX-this.startX);$tx.stop(k);this.handler(this.result)}}.bind(this));$tx.observe(d,"click",function(m){var l=Math.round(this.physicObj.interval)-1;
var k=this;var n=function(){var o=k.getKnobPosition();k.setKnobPosition(o-1);if(l-->0){setTimeout(n,10)}else{k.handler(k.result)}};n();$tx.stop(m)}.bind(this));$tx.observe(c,"click",function(m){var l=Math.round(this.physicObj.interval);var k=this;var n=function(){var o=k.getKnobPosition();k.setKnobPosition(o+1);if(--l>0){setTimeout(n,10)}else{k.handler(k.result)}};n();$tx.stop(m)}.bind(this));$tx.observe(this.elContext,"mouseup",function(k){if(this.isDrag){this.isDrag=false}}.bind(this));$tx.observe(h,"click",function(k){$tx.stop(k)}.bind(this));$tx.observe(j,"click",function(l){if(!this.isDrag){var k=l.layerX||l.x;this.setKnobPosition(k-this.knobWidth/2);this.handler(this.result)}}.bind(this))},getKnobPosition:function(){var c=$tx.getStyle(this.elKnob,"left");return c.parsePx()},setKnobPosition:function(c){if(this.isDisabled){return}c=(c<this.physicObj.max)?c:this.physicObj.max;c=(c>this.physicObj.min)?c:this.physicObj.min;$tx.setStyle(this.elKnob,{left:c.toPx()});this.result=Math.round(c*this.logicObj.interval/this.physicObj.interval)
},setDisable:function(){this.isDisabled=true},setEnable:function(){this.isDisabled=false},getDisabled:function(){return this.isDisabled}});a.DynamicSizer=a.Class.create({initialize:function(c){this.config=c;this.wrapper=c.el;this.elEventContext=tx.div({className:"tx-dynamic-sizer-context"});this.currentSize={row:0,col:0};this.dynamicSizingEnabled=true;if(!c.moveHandler){c.moveHandler=function(){}}if(!c.clickHandler){c.clickHandler=function(){}}this.wrapper.appendChild(this.elEventContext);this.previewTable=new a.DynamicSizer.PreviewTable({parentEl:this.elEventContext,mouseOverHandler:this.changeSize.bind(this),mouseClickHandler:this.selectSize.bind(this)})},clear:function(){this.dynamicSizingEnabled=true;this.changeSize(0,0)},changeSize:function(d,c){if(this.dynamicSizingEnabled){this.currentSize.row=d;this.currentSize.col=c;this._changeSelectionSize(d,c);this.config.moveHandler(d,c)}},_changeSelectionSize:function(d,c){this.previewTable.moveSelectionPos(d,c)},toggleDynamicSizing:function(){this.dynamicSizingEnabled=!this.dynamicSizingEnabled;
if(this.dynamicSizingEnabled){this.selection.enableResize()}else{this.selection.disableResize()}},selectSize:function(c){this.config.clickHandler(c,this.currentSize)},getCurruentSize:function(){return this.currentSize}});a.DynamicSizer.PreviewTable=a.Class.create({$const:{DEFAULT_TD_STYLE:{},DEFAULT_TABLE_PROPERTY:{cellpadding:"0",cellspacing:"1"},MAX_SIZE:{COL:10,ROW:10}},initialize:function(d){this.config=d;this.elTable=null;this.elTable=this.generateTable("tx-event");this.elSelection=tx.div({className:"tx-selection"},this.generateTable("tx-selection"));var e=this.generateTable("tx-panel");this.eventBinding();d.parentEl.appendChild(this.elTable);d.parentEl.appendChild(this.elSelection);d.parentEl.appendChild(e);var h=$tom.getPosition(this.elTable);var c=a.DynamicSizer.PreviewTable.MAX_SIZE;this.cellSize={width:Math.round((h.width-h.x)/c.COL),height:(h.height-h.y)/c.ROW}},generateTable:function(k){var e=tx.tbody();var d=a.DynamicSizer.PreviewTable;for(var h=0;h<d.MAX_SIZE.ROW;h++){var m=tx.tr();
for(var c=0;c<d.MAX_SIZE.COL;c++){var n=tx.td(tx.div({style:d.DEFAULT_TD_STYLE}));n=this.setCoordToAttr(n,c+1,h+1);m.appendChild(n)}e.appendChild(m)}var l=tx.table(d.DEFAULT_TABLE_PROPERTY);$tx.addClassName(l,k||"");l.appendChild(e);return l},moveSelectionPos:function(h,d){var e=(d*this.cellSize.width).toPx();var c=(h*this.cellSize.height).toPx();$tx.setStyle(this.elSelection,{width:e,height:c})},setCoordToAttr:function(d,c,e){d.setAttribute("col",c);d.setAttribute("row",e);return d},getCoordFromAttr:function(c){return{col:c.getAttribute("col")||0,row:c.getAttribute("row")||0}},eventBinding:function(){this.mouseOverHandler=this.config.mouseOverHandler;this.mouseClickHandler=this.config.mouseClickHandler;var c=this;var e=function(k){var j=$tx.element(k)||{};var h=(j.tagName||"").toUpperCase();if(j&&h=="TD"){var l=c.getCoordFromAttr(j);c.mouseOverHandler(l.row,l.col)}$tx.stop(k)};var d=function(h){c.mouseClickHandler(h)};$tx.observe(this.elTable,"mouseover",e);$tx.observe(this.elTable,"click",d)
}})})(Trex);Trex.ImageScale=Trex.Class.create({initialize:function(d,c){if(!d.imageurl){return}if(d.actualwidth){return}var a=function(h,e){d.actualwidth=h;d.actualheight=e;if(c){c(h,e)}};setTimeout(function(){var e=new Image();e.onerror=function(){e=null};if(e.onreadystatechange){e.onreadystatechange=function(){if(this.readyState=="complete"){a(this.width,this.height);e=null}}}else{e.onload=function(){a(this.width,this.height);e=null}}e.src=d.imageurl},10)}});Trex.ImageResizer=Trex.Class.create({initialize:function(l,d){var h=l;var k=d.maxWidth||200;var j=d.maxHeight||200;var e=d.defImgUrl;var a=d.onComplete||function(n,m){};function c(r,o){var p,n;var q=r.width;var m=r.height;if(q==k&&m==j){n=k;p=j}else{if(q<k&&m<j){n=q;p=m}else{p=j;n=Math.floor(j*(q/m));if(n>k){n=k;p=Math.floor(k*(m/q))}}}h.width=n;h.height=p;h.src=o;_tmpImage=null;a(n,p)}this.execResize=function(m){var n=new Image();n.onerror=function(){h.width=k;h.height=j;h.src=e;n=null};if(n.onreadystatechange){n.onreadystatechange=function(){if(this.readyState=="complete"){c(n,m)
}}}else{n.onload=function(){c(n,m)}}n.src=m}}});Trex.Flash={DEFAULT:{flashvar:{debug:"false"},paraObj:{allowScriptAccess:"always",quality:"low",menu:"false",scale:"noscale",salign:"tl",loop:"false"},attrObj:{bgcolor:"#FFFFFF"}},minFlashVer:"9.0.28",load:function(k,d,e,c){var j=$tx.extend({},Trex.Flash.DEFAULT.flashvar);var l=$tx.extend({},Trex.Flash.DEFAULT.paraObj);var h=$tx.extend({},Trex.Flash.DEFAULT.attrObj);var a=c?c:{};$tx.extend(j,a.flashvarObj);$tx.extend(l,a.paraObj);$tx.extend(h,a.attrObj);h.id=e;if(!$tx(d)){document.body.appendChild(tx.div({id:d}))}swfobject.embedSWF(k,d,a.width?a.width:"0",a.height?a.height:"0",this.minFlashVer,false,j,l,h)},get:function(a){return swfobject.getObjectById(a)},getPlayerVersion:function(){return swfobject.getFlashPlayerVersion()},hasPlayerVersion:function(a){return swfobject.hasFlashPlayerVersion(a)},ready:function(c,a){if(!Trex.Flash.get(c)){setTimeout(function(){Trex.Flash.ready(c,a)},500);return}setTimeout(a,500)}};function $txSWF(a){return Trex.Flash.get(a)
}Trex.I.XHRequester=Trex.Faculty.create({createXMLHttp:function(){var c=null;try{if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{if(window.ActiveXObject){c=new ActiveXObject("Msxml2.XMLHTTP");if(!c){c=new ActiveXObject("Microsoft.XMLHTTP")}}}return c}catch(a){return null}},sendRequest:function(a,c,d,h,m,n){if(c==null&&c!=""){return null}var k=null;var j=this.createXMLHttp();if(j==null){return null}var o=function(){if(j.status==200){if(a.toUpperCase()=="HEAD"){k=m(j.getAllResponseHeaders())}else{k=m(j.responseText)}}else{k=n(j.status)}j=null};try{if(h){j.onreadystatechange=function(){if(j.readyState==4){o()}}}if(a.toUpperCase()=="POST"){j.open("POST",c,h);j.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");j.setRequestHeader("X-Requested-With","XMLHttpRequest");j.setRequestHeader("Content-Length",d.length);j.setRequestHeader("Connetion","close");j.send(d)}else{if(d&&d.length>0){c=c+((c.indexOf("?")>-1)?"&":"?")+d}j.open(a.toUpperCase(),c,h);j.setRequestHeader("X-Requested-With","XMLHttpRequest");
j.send(null)}if(!h){o()}return k}catch(l){return null}}});Trex.Responder={callbacks:{},process:function(c,a){},newKey:function(){var a="exe_"+Math.floor(Math.random()*100000);if(this[a]){return this.newKey()}else{return a}},register:function(c){var a=this.newKey();this.callbacks[a]=function(d){c(d);this.callbacks[a]=null}.bind(this);return a}};Trex.I.FHRequester=Trex.Faculty.create({sendRequest:function(a,c,d,h,l,p,o){var e=Trex.Flash.get("tx_fhr");if(!e){e=function(){Trex.Flash.load("http://editor.daum.net/swf/FHR3.swf?rv=1.1.0","tx_fhr_target","tx_fhr");return Trex.Flash.get("tx_fhr")}();setTimeout(this.sendRequest.bind(this,a,c,d,h,l,p),100);return}if(!e.send){setTimeout(this.sendRequest.bind(this,a,c,d,h,l,p),50);return}var n=Trex.Responder.register(l);var k='Trex.Responder.callbacks["'+n+'"]';var m="Trex.Responder.process";if(p){var j=Trex.Responder.register(function(r,q){if(r==-1){p(r,q)}else{if(o){o(r,q)}}});m='Trex.Responder.callbacks["'+j+'"]'}if(c.charAt(0)==="/"){c="http://"+document.location.host+c
}if(a.toUpperCase()=="GET"){if(!d){d=""}c=c+((c.indexOf("?")>-1)?"&":"?")+d}if(c){e.send(a,c,d,k,m)}}});Trex.I.JSRequester=Trex.Faculty.create({importScript:function(a,j,h){if(a==null&&a!=""){return null}j=j||"utf-8";h=h||document;try{var d=h.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("charset",j);h.body.appendChild(d);var c=h.write;h.write=function(l){var e=h.createElement("div");h.body.appendChild(e);e.innerHTML+=l};if($tx.msie){d.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){h.write=c}}}else{d.onload=function(){h.write=c}}d.setAttribute("src",a)}catch(k){console.log(k)}}});window.$stop={};window.$propagate={};Trex.I.JobObservable=Trex.Faculty.create({jobObservers:{},observeJob:function(c,a){if(!this.jobObservers[c]){this.jobObservers[c]=[]}this.jobObservers[c].push(a)},reserveJob:function(e,c,d){d=d||500;if(!this.jobObservers[e]){this.jobObservers[e]=[]}var a=this;this.jobObservers[e].push(function(){var h=$A(arguments);
setTimeout(function(){c.apply(a,h)},d)})},fireJobs:function(d){var a=this;var c=$A(arguments).slice(1);if(!this.jobObservers[d]){return}try{this.jobObservers[d].each(function(e){e.apply(a,c)})}catch(h){if(h!=$stop){throw h}}}});Trex.I.KeyObservable=Trex.Faculty.create({keyObservers:{},observeKey:function(d,c){var a=function(e){return(e.ctrlKey?"T":"F")+(e.altKey?"T":"F")+(e.shiftKey?"T":"F")+"_"+e.keyCode}(d);if(!this.keyObservers[a]){this.keyObservers[a]=[]}this.keyObservers[a].push(c)},fireKeys:function(h){var d=function(e){return(e.ctrlKey?"T":"F")+(e.altKey?"T":"F")+(e.shiftKey?"T":"F")+"_"+e.keyCode}(h);if(!this.keyObservers[d]){return}var a=this;var c=false;try{this.keyObservers[d].each(function(e){try{e.apply(a,[h])}catch(k){if(k==$propagate){c=true}}})}catch(j){if(j!=$stop){throw j}}if(!c){try{$tx.stop(h)}catch(j){}}},registerKeyEvent:function(a){try{$tx.observe(a,"keydown",this.fireKeys.bind(this),true)}catch(c){}}});Trex.I.ElementObservable=Trex.Faculty.create({elementObservers:{},observeElement:function(d,a){if(d==null){this.observeElement({tag:"*tx-final-body*"},a)
}else{if(d.length){for(var c=0;c<d.length;c++){var e=d[c];this.observeElement(e,a)}}else{if(!this.elementObservers[d.tag]){this.elementObservers[d.tag]={}}if(!d.klass){d.klass="*tx-all-class*"}if(!this.elementObservers[d.tag][d.klass]){this.elementObservers[d.tag][d.klass]=[]}this.elementObservers[d.tag][d.klass].push(a)}}},fireElements:function(h){if(!h){return}var d=h;var c=$A(arguments).slice(1);var a=this;try{if($tom.kindOf(d,"img,hr,table,button,iframe")){var k=this.collectObserverByElement(d.nodeName.toLowerCase(),d.className);if(k){k.each(function(e){e.apply(a,[d].concat(c))})}}else{while(d){var k=this.collectObserverByElement(d.nodeName.toLowerCase(),d.className);if(k){k.each(function(e){e.apply(a,[d].concat(c))})}if($tom.isBody(d)){break}d=$tom.parent(d)}}}catch(j){if(j!=$stop){throw j}}this.fireFinally()},fireFinally:function(){var a=this;var c=$A(arguments).slice(1);var d=this.collectObserverByElement("*tx-final-body*");if(d){d.each(function(e){e.apply(a,[null].concat(c))})}},collectObserverByElement:function(c,a){if(!this.elementObservers[c]){return null
}var h=[];a=a||"";if(a!=""){var d=a.split(" ");for(var e in this.elementObservers[c]){if(d.include(e)){h.push(this.elementObservers[c][e])}}}if(this.elementObservers[c]["*tx-all-class*"]){h.push(this.elementObservers[c]["*tx-all-class*"])}return h.flatten()}});Trex.I.MouseoverObservable=Trex.Faculty.create({mouseoverObservers:{},observeMouseover:function(a,c,d){if(!this.mouseoverObservers[a]){this.mouseoverObservers[a]={success:[],fail:[],flag:false}}this.mouseoverObservers[a]["success"].push(c);if(d){this.mouseoverObservers[a]["fail"].push(d)}},fireMouseover:function(h){if(!h){return}var d=h;var a=this;try{for(var c in this.mouseoverObservers){this.mouseoverObservers[c].flag=false}while(d){var l=this.collectMouseoverObserver(d);if(l.length>0){var k=this.getPositionByNode(d);l.each(function(e){e.apply(a,[d,k])})}if($tom.isBody(d)){break}d=$tom.parent(d)}}catch(j){if(j!=$stop){throw j}}this.runMouseoverFailHandler()},runMouseoverFailHandler:function(){var c=[];for(var a in this.mouseoverObservers){if(!this.mouseoverObservers[a].flag){c.push(this.mouseoverObservers[a]["fail"])
}}c.flatten().each(function(d){d()})},collectMouseoverObserver:function(k){var l=[];var d=k.className||"";var c=k.tagName;if(c){c=c.toLowerCase();if(this.mouseoverObservers[c]){l.push(this.mouseoverObservers[c]["success"]);this.mouseoverObservers[c]["flag"]=true}}if(d!=""){var e=d.split(" ");for(var j=0,a=e.length;j<a;j++){var h=c+"."+e[j];if(this.mouseoverObservers[h]){l.push(this.mouseoverObservers[h]["success"]);this.mouseoverObservers[h]["flag"]=true}}}return l.flatten()}});Trex.I.Runnable=Trex.Faculty.create({isRunning:false,repeater:null,threads:[],startThread:function(a){if(this.repeater){this.repeater.clear()}else{this.repeater=new Trex.Repeater(this.runThread.bind(this))}this.repeater.start(a)},stopThread:function(){this.repeater.clear()},runThread:function(){if(this.isRunning){return}if(this.threads.length>0){this.isRunning=true;(this.threads.shift())();this.isRunning=false}},putThread:function(a,c){if(c){this.threads.unshift(a)}else{this.threads.push(a)}}});TrexMessage.addMsg({"@menu.pallete.revert":"\uae30\ubcf8\uc0c9\uc73c\ub85c","@adoptor.label":"\uac00\ub098\ub2e4","@adoptor.transparent":"\ud22c\uba85"});
Trex.MarkupTemplate.add("menu.colorpallete.text",'#{for:items}<li class="tx-menu-list-item" style="background-color:#{color}"><a unselectable="on" style="color:#{text}">#{label}</a></li>#{/for:items}');Trex.MarkupTemplate.add("menu.colorpallete.thumb",'#{for:items}<li class="tx-menu-list-item" unselectable="on" style="background-color:#{color};border:none;#{if:image!=null}background-image:url(#{image})#{/if:image};"></li>#{/for:items}');Trex.MarkupTemplate.add("menu.colorpallete.revert",'<p class="tx-pallete-revert"><a unselectable="on" href="javascript:;" title="@menu.pallete.revert">@menu.pallete.revert</a></p>');Trex.I.ColorPallete=Trex.Faculty.create({isGradeInit:false,isPickerDisplayed:false,onregenerated:function(a,c){this.setColorValueAtInputbox(c)},setColorValueAtInputbox:function(d){if(!d){return}if(typeof d!="string"&&d.toString){var d=d.toString()}var e=d.split("|")[0];var a=$tom.collect(this.elInner,"p.tx-pallete-input input");var c=$tom.collect(this.elInner,"p.tx-pallete-input span");
if(d&&a&&c){a.value=e;c.style.backgroundColor=e}},hookEvent:function(w){var o=this.elMenu;var m=this.elInner=$tom.collect(o,"div.tx-menu-inner");var p=$tom.collect(m,"ul.tx-pallete-text-list");if(w.texts){var x=TXMSG("@adoptor.label");var q=w.texts.options;Trex.MarkupTemplate.get("menu.colorpallete.text").evaluateToDom({items:q},p);var l=$tom.collectAll(p,"li");this.addColorClickEvent(l,q)}else{m.removeChild(p);p=null}if(w.thumbs){var r=!!w.needTrans;var n=[].concat(w.thumbs.options);if(r){n.pop();n.push(Object.extend({},w.thumbs.transparent))}var h=$tom.collect(m,"ul.tx-pallete-thumb-list");Trex.MarkupTemplate.get("menu.colorpallete.thumb").evaluateToDom({items:n},h);var c=$tom.collectAll(h,"li");this.addColorClickEvent(c,n)}this.elPicker=$tom.collect(m,"div.tx-pallete-picker");var d=$tom.collect(m,"div.tx-pallete-buttons");var u=this.elMore=$tom.collect(d,"p.tx-pallete-more a");$tx.observe(u,"click",this.togglePicker.bind(this));if(w.needRevert){$tom.insertFirst(d,Trex.MarkupTemplate.get("menu.colorpallete.revert").evaluateAsDom({}));
$tx.observe($tom.collect(d,"p.tx-pallete-revert a"),"click",function(y){this.onSelect(y,null);this.hide()}.bind(this))}var k=$tom.collect(this.elInner,"p.tx-pallete-input");var a=this.elPreview=$tom.collect(k,"span");var t=this.elInput=$tom.collect(k,"input");var j=this.elEnter=$tom.collect(k,"a");var e=this;$tx.observe(t,"blur",function(){e.lastValue=t.value});$tx.observe(j,"click",this.onColorEnter.bind(this))},addColorClickEvent:function(j,c){for(var e=0,a=j.length;e<a;e++){var d=j[e];var h=c[e];$tx.observe(d,"click",this.onSelect.bindAsEventListener(this,h.color+(h.text?"|"+h.text:"")))}},_generatePicker:function(){var c=this.elPicker;var d=$tom.collect(c,"div.tx-pallete-pickerbox");$tx.observe(d,"mouseout",this.onMouseOut.bind(this));var e=this.elChromaBar=$tom.collect(d,"div.tx-chromabar");$tom.replacePngPath(e);$tx.observe(e,"mousedown",this.onChromDown.bindAsEventListener(this));$tx.observe(e,"mousemove",this.onChromMove.bindAsEventListener(this));$tx.observe(e,"mouseup",this.onChromUp.bindAsEventListener(this));
this.elHueBar=$tom.collect(d,"div.tx-huebar");var a=this.elHueBar;this.hueDownHandler=this.onHueDown.bindAsEventListener(this);this.hueMoveHandler=this.onHueMove.bindAsEventListener(this);this.hueUpHandler=this.onHueUp.bindAsEventListener(this);this.hueClickHandler=this.onHueClick.bindAsEventListener(this);$tx.observe(a,"mousedown",this.hueDownHandler);$tx.observe(a,"click",this.hueClickHandler);this.nColWidth=150;this.nColHeight=120;this.nHueHeight=120;this.mRGB={r:0,g:0,b:0};this.mHSV={h:0,s:100,v:100};this.setHueColor("FF0000")},reinitGrade:function(){var c=$tx.cumulativeOffset(this.elMenu);var a=$tx.positionedOffset(this.elChromaBar);this.iChromPos={x:(c[0]+a[0]),y:(c[1]+a[1])};a=$tx.positionedOffset(this.elHueBar);this.iHuePos={x:(c[0]+a[0]),y:(c[1]+a[1])}},onColorEnter:function(c){var a;if(this.elInput.value==TXMSG("@adoptor.transparent")){a="transparent"}else{a=Trex.Color.getValidColor(this.elInput.value)}if(a!==null){this.onSelect(c,a)}this.hide()},previewColor:function(a){this.changeColor(a)
},onMouseOut:function(){if(this.lastValue!==null&&this.lastValue!==undefined){this.changeColor(this.lastValue)}},changeColor:function(a){a=Trex.Color.getHexColor(a);this.elPreview.style.backgroundColor=a;if(a=="transparent"){this.elInput.value=TXMSG("@adoptor.transparent")}else{this.elInput.value=a}},enterColor:function(){if(this.elInput.value==TXMSG("@adoptor.transparent")){this.changeColor("transparent")}else{if(this.elInput.value.length==7){var a=Trex.Color.getValidColor(this.elInput.value);if(a!==null){this.changeColor(a)}}}},togglePicker:function(d){var a=this.elMore;var c=this.elPicker;if(this.isPickerDisplayed){a.className="tx-more-down";$tx.hide(c)}else{a.className="tx-more-up";$tx.show(c);if($tx.msie&&$tx.msie_ver<7){c.style.padding="1px";setTimeout(function(){c.style.padding="0px"},0)}if(!this.isGradeInit){this._generatePicker();this.isGradeInit=true;this.reinitGrade()}}this.isPickerDisplayed=!this.isPickerDisplayed;$tx.stop(d)},getChromCoords:function(c){var d=(c.clientX-this.iChromPos.x)+document.documentElement.scrollLeft;
var a=(c.clientY-this.iChromPos.y)+document.documentElement.scrollTop;d=Math.min(this.nColWidth,Math.max(0,d));a=Math.min(this.nColHeight,Math.max(0,a));return{x:d,y:a}},getHueCoords:function(c){var d=(c.clientX-this.iHuePos.x)+document.documentElement.scrollLeft;var a=(c.clientY-this.iHuePos.y)+document.documentElement.scrollTop;d=Math.min(this.nHueHeight,Math.max(0,a));a=Math.min(this.nColWidth,Math.max(0,d));return{x:d,y:a}},getColorByEvent:function(a,h){var d=(a/(this.nColWidth))*100;var c=(1-h/(this.nColHeight))*100;var e=3;d=Math.floor(Math.min(Math.max(d,0),100));if(d<e){d=0}else{if(d>100-e){d=100}}c=Math.floor(Math.min(Math.max(c,0),100));if(c<e){c=0}else{if(c>100-e){c=100}}this.mHSV.s=d;this.mHSV.v=c;this.mRGB=this.hsv2rgb(this.mHSV.h,this.mHSV.s,this.mHSV.v);return this.rgb2hex(this.mRGB.r,this.mRGB.g,this.mRGB.b)},onChromDown:function(a){this.mousedownDetected=true},onChromMove:function(c){if(this.mousedownDetected){var d=this.getChromCoords(c);var a=this.getColorByEvent(d.x,d.y);
this.previewColor(a)}},onChromUp:function(c){var d=this.getChromCoords(c);var a=this.getColorByEvent(d.x,d.y);this.previewColor(a);this.lastValue=a;this.mousedownDetected=false},getHueByEvent:function(a,e){var c=parseInt((a/(this.nHueHeight))*360);this.mHSV.h=Math.floor(Math.min(Math.max(c,0),360));var d=this.hsv2rgb(this.mHSV.h,100,100);return this.rgb2hex(d.r,d.g,d.b)},setHueColor:function(a){this.elChromaBar.style.backgroundColor=a},onHueDown:function(a){$tx.observe(document,"mousemove",this.hueMoveHandler);$tx.observe(document,"mouseup",this.hueUpHandler)},onHueMove:function(c){var d=this.getHueCoords(c);var a=this.getHueByEvent(d.x,d.y);this.setHueColor(a)},onHueClick:function(c){var d=this.getHueCoords(c);var a=this.getHueByEvent(d.x,d.y);this.setHueColor(a)},onHueUp:function(){$tx.stopObserving(document,"mousemove",this.hueMoveHandler);$tx.stopObserving(document,"mouseup",this.hueUpHandler)},hex2rgb:function(a){this.mRGB.r=(this.toDec(a.substr(0,1))*16)+this.toDec(a.substr(1,1));
this.mRGB.g=(this.toDec(a.substr(2,1))*16)+this.toDec(a.substr(3,1));this.mRGB.b=(this.toDec(a.substr(4,1))*16)+this.toDec(a.substr(5,1));return this.mRGB},toDec:function(c){var a="0123456789ABCDEF";return a.indexOf(c.toUpperCase())},rgb2hex:function(d,c,a){d=d.toString(16);if(d.length==1){d="0"+d}c=c.toString(16);if(c.length==1){c="0"+c}a=a.toString(16);if(a.length==1){a="0"+a}return"#"+d+c+a},hsv2rgb:function(d,o,m){d%=360;o/=100;m/=100;var a=0;g=0;b=0;if(o===0){a=Math.floor(m*255);g=Math.floor(m*255);b=Math.floor(m*255)}else{var j=d/60;var e=Math.floor(j);var n=m*(1-o);var l=m*(1-o*(j-e));var k=m*(1-o*(1-(j-e)));var c=0;nG=0;nB=0;if(e===0){c=m;nG=k;nB=n}else{if(e==1){c=l;nG=m;nB=n}else{if(e==2){c=n;nG=m;nB=k}else{if(e==3){c=n;nG=l;nB=m}else{if(e==4){c=k;nG=n;nB=m}else{if(e==5){c=m;nG=n;nB=l}}}}}}a=Math.floor(c*255);g=Math.floor(nG*255);b=Math.floor(nB*255)}return{r:a,g:g,b:b}},rgb2hsv:function(c,l,p){var e=(c/255);var o=(l/255);var t=(p/255);var k=0;s=0;v=0;var q=Math.min(e,o,t);var d=Math.max(e,o,t);
var n=d-q;v=n;if(n===0){k=0;s=0}else{s=n/d;var m=(((d-e)/6)+(n/2))/n;var a=(((d-o)/6)+(n/2))/n;var j=(((d-t)/6)+(n/2))/n;if(e==d){k=j-a}else{if(o==d){k=(1/3)+m-j}else{if(t==d){k=(2/3)+a-m}}}if(k<0){k+=1}if(k>1){k-=1}}return{h:k,s:s,v:v}}});Trex.Color={getHexColor:function(c){c=c.trim();if(c.indexOf("rgb")<0){if(c.length>0&&(c.indexOf("-moz-use")>-1||c=="transparent")){return"transparent"}else{return c}}var a=c.substring(4,c.length-1).split(",");if(a.length<3){return c}var j;var e="#";for(var d=0;d<3;d++){j=parseInt(a[d].trim()).toString(16).toUpperCase();if(j.length==1){e=e.concat("0"+j)}else{if(j.length>2){e=e.concat("FF")}else{e=e.concat(""+j)}}}return e},getValidColor:function(c){if(c===null||c=="transparent"){return"transparent"}var a=c.match(/#?([0-9a-f]{6}|[0-9a-f]{3})/i);if(a===null){return null}if(a[1].length==3){return"#"+a[1]+a[1]}else{return"#"+a[1]}},getOptColor:function(c,d){if(!c||c.length!=7||c.charAt(0)!="#"){return"#e5e5e5"}c=c.substring(1,7).toLowerCase();d=isNaN(d)?100:d;
var e="#";var k,a;for(var j=0;j<3;j++){k=parseInt(c.substr(j*2,2),16);a=Math.round(Math.floor((255-k)*(1-d*0.01)+k*(d*0.02))).toString(16);if(a.length==1){e+="0"+a}else{if(a.length>2){e+="ff"}else{e+=a}}}return e}};Trex.I.CookieBaker=Trex.Faculty.create({cookieName:null,cookieValue:null,initCookie:function(a,c){this.cookieName=a;this.cookieValue=function(){var h=document.cookie.split(";");for(var e=0;e<h.length;e++){var d=h[e].replace(/^\s+/,"");if(d.indexOf(a+"=")==0){return d.substring(a.length+1)}}return null}()||"";this.maxCnt=c||3},writeCookie:function(c,e){var a=this.cookieName;if(e){(time=new Date()).setTime(new Date().getTime()+e*24*60*60*1000);var d="; expires="+time.toGMTString()}else{var d=""}document.cookie=a+"="+c+d+"; path=/";this.cookieValue=c},readCookie:function(){return this.cookieValue},eraseCookie:function(){var a=this.cookieName;this.writeCookie(a,"",-1)},extractOptions:function(a,d){var e=a.toMap("data");var c=[];d.split("|").compact().each(function(h){if(e[h]){c.push(e[h])
}}.bind(this));return c},mergeValues:function(d,c){var a=d.split("|").compact();if(a.include(c)){return d}if(a.length>=this.maxCnt){a.pop()}a.unshift(c);return a.join("|")}});Trex.I.AlignExecution=Trex.Mixin.create({executeAlignImageMode:function(d){var h=this.constructor.__ImageModeProps.image;var c=d.getControl();if(!c){return}d.apply(c,h);var a=this.constructor.__ImageModeProps.paragraph;if(a){var e=$tom.find(c,"%paragraph");d.apply(e,a)}},executeAlignTextMode:function(e){var a=this.constructor.__TextModeProps.paragraph;var d=e.getControl();if(d){e.apply(d,{align:a.style["textAlign"]});if($tom.kindOf(d,"button")){var j=$tom.find(d,"%paragraph");if(j){e.apply(j,a)}var c=$tom.collect(d,"table");if(c){e.apply(c,{align:a.style["textAlign"]})}}}else{var h=e.blocks(function(){return"%paragraph"});e.apply(h,a);h=e.controls(function(){return"hr,table"});e.apply(h,{align:a.style["textAlign"]})}},queryImageFloat:function(c){var a=c.getControl();if(a){return c.queryStyle(a,"float")}else{return null
}},queryTextAlign:function(d){var c=d.findNode("%paragraph");var a=d.queryStyle(c,"textAlign");if(!a){a=d.queryAttr(c,"align")}if(!a||a=="start"){a="left"}return a},queryControlAlign:function(c){var a=c.getControl();if(a){_value=c.queryAttr(a,"align");return _value||"left"}else{return null}}});Trex.I.ListExecution=Trex.Mixin.create({executeToList:function(d,a,c){this.rngLstNodes=[];this.newGrpNode=function(){var h=d.newNode(a);d.apply(h,c);return h};this.newLstNode=function(){return d.newNode("li")};this.newPrNode=function(){return d.newNode("p")};var e=d.blocks(function(){return"%wrapper,%paragraph"});this._wrapList(d,e);$A(this.rngLstNodes).each(function(h){d.stuffNode(h)})},_wrapList:function(e,c){var d=null;var a=this;$A(c).each(function(l){if($tom.kindOf(l,"td,th")){var k=$tom.descendants(l,"%wrapper,%paragraph");if(k.length==0){var n=a.newPrNode();$tom.moveChild(l,n);$tom.append(l,n);k=[n]}a._wrapList(e,k)}else{if($tom.kindOf(l,"li")){if(d){$tom.append(d,l)}else{d=a.newGrpNode();var j=$tom.parent(l);
if($tom.kindOf(j,"ul,ol")){var h=$tom.divideNode(j,$tom.indexOf(l));$tom.insertAt(d,h);$tom.append(d,l);if(!$tom.hasChildren(j)){$tom.remove(j)}if(!$tom.hasChildren(h)){$tom.remove(h)}}else{$tom.append(d,l)}}a.rngLstNodes.push(l)}else{if(!d){d=a.newGrpNode();$tom.insertAt(d,l)}var m=a.newLstNode();if($tom.kindOf(l,"%wrapper")){$tom.wrap(m,l)}else{if($tom.kindOf(l,"%paragraph")){$tom.replace(l,m)}else{$tom.wrap(m,l)}}$tom.append(d,m);a.rngLstNodes.push(m)}}})},executeOffList:function(a){var c=a.blocks(function(){return"%listhead"});$A(c).each(function(h){var d="p";if($tom.ancestor(h,"%listgroup")){d="li"}var e=$tom.children(h,"li");$A(e).each(function(j){$tom.replace(j,a.newNode(d))});$tom.unwrap(h)})}});Trex.I.IndentExecution=Trex.Mixin.create({executeIndentByKeyEvent:function(a){if(a.isCollapsed()){var c=a.compareTextPos();if(c==$tom.__POSITION.__MIDDLE_OF_TEXT){this.executeAppendPadding(a);return}else{if(c==$tom.__POSITION.__END_OF_TEXT){if(a.findNode("td")){this.goNextCell(a);return}}}}this.executeIndentParagraph(a)
},executeOutdentByKeyEvent:function(a){if(a.isCollapsed()){var c=a.compareTextPos();if(c==$tom.__POSITION.__START_OF_TEXT){if(a.findNode("td")){this.goPreviousCell(a);return}}}this.executeOutdentParagraph(a)},executeIndentParagraph:function(a){var e=a.blocks(function(){return"%paragraph"});if(!e){return null}var h={style:{marginLeft:"+4em"}};var d;var c;$A(e).each(function(k){if($tom.kindOf(k,"li,dd,dt")){var j=$tom.ancestor(k,"ul,ol,dl");if(j){if(j!=d){c=null}if(c){$tom.append(c,k)}else{c=$tom.wrap($tom.clone(j),k)}d=j}else{$tom.applyAttributes(k,h)}}else{if($tom.kindOf(k,"td,th")){var l=a.newNode("p");$tom.moveChild(k,l);$tom.append(k,l);$tom.applyAttributes(l,h)}else{$tom.applyAttributes(k,h)}}})},executeOutdentParagraph:function(a){var c=a.blocks(function(){return"%paragraph"});if(!c){return null}var d={style:{marginLeft:"-4em"}};$A(c).each(function(j){if($tom.kindOf(j,"li,dd,dt")){var h=$tom.ancestor(j,"ul,ol,dl");if(h){var e=$tom.divideNode(h,$tom.indexOf(j));var k=$tom.ancestor(e,"ul,ol,dl");
if(k){$tom.insertAt(j,e)}else{var l=$tom.replace(j,a.newNode("p"));$tom.insertAt(l,e)}if(!$tom.first(h,"li")){$tom.remove(h)}if(!$tom.first(e,"li")){$tom.remove(e)}}else{$tom.applyAttributes(j,d)}}else{$tom.applyAttributes(j,d)}})},goNextCell:function(c){var e=c.findNode("td,th");var a=$tom.ancestor(e,"table");var d=$tom.collectAll(a,"td,th");while(d.length>0){if(e==d.shift()){break}}if(d.length>0){c.bookmarkInto(d[0])}else{c.bookmarkToNext(a)}},goPreviousCell:function(c){var e=c.findNode("td,th");var a=$tom.ancestor(e,"table");var d=$tom.collectAll(a,"td,th");while(d.length>0){if(e==d.pop()){break}}if(d.length>0){c.bookmarkInto(d[d.length-1])}else{c.bookmarkToPrevious(a)}},executeAppendPadding:function(a){a.pasteContent("&nbsp;&nbsp;&nbsp;&nbsp;",false)}});Trex.MarkupTemplate.add("button.itsnew",'<em class="tx-itsnew" title="new">new</em>');Trex.MarkupTemplate.add("button.select.text","<span>#{data}</span>");Trex.Button=Trex.Class.create({$const:{__borderClasses:{"tx-btn-trans":true,"tx-btn-lbg":true,"tx-btn-bg":true,"tx-btn-rbg":true,"tx-btn-lrbg":true,"tx-slt-tlbg":true,"tx-slt-tbg":true,"tx-slt-trbg":true,"tx-slt-blbg":true,"tx-slt-bbg":true,"tx-slt-brbg":true,"tx-slt-31bg":true,"tx-slt-31lbg":true,"tx-slt-31rbg":true,"tx-slt-70bg":true,"tx-slt-59bg":true,"tx-slt-42bg":true,"tx-btn-nlrbg":true,"tx-btn-43lrbg":true,"tx-btn-52lrbg":true,"tx-btn-57lrbg":true,"tx-btn-71lrbg":true,"tx-btn-48lbg":true,"tx-btn-48rbg":true,"tx-btn-30lrbg":true,"tx-btn-46lrbg":true,"tx-btn-67lrbg":true,"tx-btn-49lbg":true,"tx-btn-58bg":true,"tx-btn-46bg":true,"tx-btn-49rbg":true,"tx-btn-widget":true,"tx-btn-widget-tbg":true,"tx-btn-widget-brbg":true},addBorderClass:function(a){Trex.Button.__borderClasses[a]=true
},getBorderClass:function(e){var a=$tx.classNames(e);for(var d=0;d<a.length;d++){var c=a[d];var h=Trex.Button.__borderClasses[c];if(h){return c}}}},hasState:null,isRadioButton:null,isDisabled:null,lastValue:null,lastText:null,elButton:null,elIcon:null,borderClass:null,_command:function(){},setCommand:function(a){this._command=a},initialize:function(a){var h=this.config=a;if(h.borderClass){Trex.Button.addBorderClass(h.borderClass)}this.itsNew=!!h.itsnew;this.useSync=!!h.sync;this.hasState=!!h.status;this.isRadioButton=!!h.radio;this.isDisabled=false;this.lastValue=h.selectedValue||null;if(a.el){this.elButton=a.el}else{var c=h.id||"tx_"+h.identity;this.elButton=$must(c+(h.initializedId||""))}var e=this.elButton;var d=this.elIcon=$tom.collect(e,"a");if(!d){throw new Error("[Exception]Trex.Button : can't find elIcon for button '"+c+"'")}this.borderClass=Trex.Button.getBorderClass(e);if(this.oninitialized){this.oninitialized.bind(this)(h)}this.generate();if(this.itsNew){$tom.append(d,Trex.MarkupTemplate.get("button.itsnew").evaluateAsDom({}))
}if(h.selectedValue&&this.setValue){this.setValue(h.selectedValue)}if(h.selectedText&&this.setText){this.setText(h.selectedText)}if(h.selectedState&&this.setState){this.setState(h.selectedState)}},generate:function(){var a=this.elIcon;$tx.observe(a,"mousedown",this.onMouseDown.bindAsEventListener(this));$tx.observe(a,"mouseover",this.onMouseOver.bindAsEventListener(this));$tx.observe(a,"mouseout",this.onMouseOut.bindAsEventListener(this));$tx.observe(a,"keydown",this.onKeyDown.bindAsEventListener(this));$tx.observe(a,"click",this.onClick.bindAsEventListener(this));if(this.ongenerated){this.ongenerated.bind(this)(this.config)}},getCurrentBorderClass:function(e){var a=$tx.classNames(e);for(var d=0;d<a.length;d++){var c=a[d];if(c.indexOf(this.borderClass)!=-1){return c}}return"undefined"},normalState:function(){var a=this.getCurrentBorderClass(this.elButton);$tx.removeClassName(this.elButton,a);$tx.addClassName(this.elButton,this.borderClass)},hoveredState:function(){var a=this.getCurrentBorderClass(this.elButton);
$tx.removeClassName(this.elButton,a);$tx.addClassName(this.elButton,this.borderClass+"-hovered")},pushedState:function(){var a=this.getCurrentBorderClass(this.elButton);$tx.removeClassName(this.elButton,a);$tx.addClassName(this.elButton,this.borderClass+"-pushed")},currentState:function(){var c=this.getCurrentBorderClass(this.elButton);var a="normal";if(c.indexOf("-pushed")!=-1){a="pushed"}else{if(c.indexOf("-hovered")!=-1){a="hovered"}}return a},isPushed:function(){return("pushed"==this.currentState())},hasMenu:function(){return this.tool?!!(this.tool.menu):false},onMouseDown:function(a){if(a){$tx.stop(a)}if(this.isDisabled){return}if(this.hasMenu()||this.hasState){if(this._command()===false){return}}else{this.evsessionstarted=true}if(this.isPushed()){this.normalState()}else{this.pushedState()}},onMouseOver:function(){if(this.isDisabled||this.isPushed()){return}this.hoveredState()},onMouseOut:function(){if(this.evsessionstarted){this.normalState();this.evsessionstarted=false}if(this.isDisabled||this.isPushed()){return
}this.normalState()},onClick:function(a){if(a){$tx.stop(a)}if(this.isDisabled){return}if(!this.hasState){this._command();this.normalState();this.evsessionstarted=false}},onKeyDown:function(a){if(a.keyCode===13){this.onMouseDown(a);this.onClick(a)}},updateAfterCommand:function(a,c){this.setValueAndText(a,c);this.normalState()},setValueAndText:function(a,c){this.setValue(a);this.setText(c)},setValue:function(a){if(a){this.lastValue=a}},setText:function(a){this.lastText=a},getValue:function(){return this.lastValue},getText:function(){return this.lastText},setState:function(a){if(a){this.pushedState()}else{this.normalState()}},setClassName:function(a){this.elIcon.className=a},disable:function(){if(this.elButton){this.isDisabled=true;$tx.addClassName(this.elButton,"tx-disable")}},enable:function(){if(this.elButton){this.isDisabled=false;$tx.removeClassName(this.elButton,"tx-disable")}},release:function(){if(this.isDisabled){return}if(this.hasMenu()||!this.hasState){this.normalState()}}});Trex.Button.Select=Trex.Class.create({$extend:Trex.Button,ongenerated:function(){Trex.MarkupTemplate.get("button.select.text").evaluateToDom({data:$tom.getText(this.elIcon)},this.elIcon);
this.elText=$tom.collect(this.elIcon,"span");var a=$tom.collect(this.elButton,"a.tx-arrow");if(a){$tx.observe(a,"mousedown",this.onMouseDown.bindAsEventListener(this));$tx.observe(a,"mouseover",this.onArrowMouseOver.bindAsEventListener(this));$tx.observe(a,"mouseout",this.onArrowMouseOut.bindAsEventListener(this));$tx.observe(a,"click",this.onClick.bindAsEventListener(this))}},setText:function(a){this.elText.innerText=a},onArrowMouseOver:function(){if(this.isDisabled||this.isPushed()){return}this.hoveredState()},onArrowMouseOut:function(){if(this.isDisabled||this.isPushed()){return}this.normalState()}});Trex.Button.Splits=Trex.Class.create({$extend:Trex.Button,ongenerated:function(){var c=this.elButton;var a=this.elArrow=$tom.collect(c,"a.tx-arrow");if(!a){throw new Error("[Exception]Trex.Button.Splits : not exist element(a.tx-arrow)")}$tx.observe(a,"mousedown",this.onArrowMouseDown.bindAsEventListener(this));$tx.observe(a,"mouseover",this.onArrowMouseOver.bindAsEventListener(this));$tx.observe(a,"mouseout",this.onArrowMouseOut.bindAsEventListener(this));
$tx.observe(a,"click",this.onArrowClick.bindAsEventListener(this))},arrowHoveredState:function(){var a=this.getCurrentBorderClass(this.elButton);$tx.removeClassName(this.elButton,a);$tx.addClassName(this.elButton,this.borderClass+"-arrow-hovered")},arrowPushedState:function(){var a=this.getCurrentBorderClass(this.elButton);$tx.removeClassName(this.elButton,a);$tx.addClassName(this.elButton,this.borderClass+"-arrow-pushed")},onMouseDown:function(a){if(this.isDisabled){return}if(this.isPushed()){this.normalState();this._command();this.commandexecuted=true}else{this.pushedState();this.commandexecuted=false;this.evsessionstarted=true}},onClick:function(a){if(this.isDisabled){return}if(!this.commandexecuted){this.tool.execute(this.lastValue,this.lastText);this.evsessionstarted=false}else{this.commandexecuted=false}this.normalState();if(a){$tx.stop(a)}},onArrowMouseDown:function(){if(this.isDisabled){return}if(this._command()===false){return}if(this.isPushed()){this.normalState()}else{this.arrowPushedState()
}},onArrowClick:function(a){if(this.isDisabled){return}if(a){$tx.stop(a)}},onArrowMouseOver:function(){if(this.isDisabled||this.isPushed()){return}this.arrowHoveredState()},onArrowMouseOut:function(){if(this.isDisabled||this.isPushed()){return}if(this.commandexecuted){this.commandexecuted=false}this.normalState()}});Trex.Button.Toggle=Trex.Class.create({$extend:Trex.Button,setValue:function(a){if(a){this.pushedState()}else{this.normalState()}}});Trex.Button.Widget=Trex.Class.create({$extend:Trex.Button.Select,setText:function(a){this.elIcon.innerText=a;if(this.lastText){$tx.removeClassName(this.elIcon,this.lastText)}$tx.addClassName(this.elIcon,a);this.lastText=a},setMenu:function(d,a){this.hasState=true;var c=this;d.setCommand(function(){var e=a.apply(this,arguments);c.updateAfterCommand.apply(c,arguments);return e});c.setCommand(function(){if(!c.isPushed()){var e=c.getValue();d.show(e)}else{d.hide()}return true})}});Trex.Button.ColorWidget=Trex.Class.create({$extend:Trex.Button.Widget,setValue:function(a){$tx.setStyle(this.elIcon.parentNode,{backgroundColor:a});
this.lastValue=a},setText:function(){}});TrexMessage.addMsg({"@menu.pallete.enter":"\uc785\ub825","@menu.pallete.more":"\ub354\ubcf4\uae30"});Trex.Menu=Trex.Class.create({isInit:false,isDisplayed:false,_command:function(){},setCommand:function(a){this._command=a},initialize:function(a){var d=this.config=a;var e;if(d.el){e=d.el;if(!e){throw new Error("[Exception]Trex.Menu : not exist element("+d.el+")")}}else{var c=d.id;var h=((d.initializedId)?d.initializedId:"");if(!c){if(!d.identity){throw new Error("[Exception]Trex.Menu : not exist config - id")}c="tx_"+d.identity+"_menu"}e=$tx(c+h);if(!e){throw new Error("[Exception]Trex.Menu : not exist element("+c+")")}}this.elMenu=e;if(d.top){e.style.top=d.top+"px"}if(d.left){e.style.left=d.left+"px"}if(this.oninitialized){this.oninitialized.bind(this)(a)}if(this.ongenerated){this.generateHandler=this.ongenerated.bind(this)}if(this.onregenerated){this.regenerateHandler=this.onregenerated.bind(this)}},generate:function(a){if(this.generateHandler){var c=this.config;
this.generateHandler(c,a)}},regenerate:function(a){if(this.initHandler){this.initHandler()}if(this.regenerateHandler){var c=this.config;this.regenerateHandler(c,a)}},onSelect:function(d,e){var c=$A(arguments);var a=c.shift();this._command.apply(this,c);this.hide();$tx.stop(a)},onCancel:function(){if(this.cancelHandler){this.cancelHandler()}this.hide()},visible:function(){return this.isDisplayed},show:function(a){$tx.show(this.elMenu);if(!this.isInit){this.generate(a);this.isInit=true}this.regenerate(a);if(this.showSpecial){this.showSpecial()}this.isDisplayed=true},hide:function(a){$tx.hide(this.elMenu);this.isDisplayed=false},toggle:function(a){if(this.isDisplayed){this.hide()}else{this.show()}},release:function(a){if(!this.isInit){return}this.hide(a)}});Trex.MarkupTemplate.add("menu.select",'<ul class="tx-menu-list" unselectable="on">#{items}</ul>');Trex.MarkupTemplate.add("menu.select.item",'<li class="tx-menu-list-item"><a class="#{klass}" href="javascript:;" unselectable="on">#{label}</a></li>');
Trex.Menu.Select=Trex.Class.create({$extend:Trex.Menu,generate:function(){var d=this.config;var a=this.getCheckedConfig(d);var c=this.generateList(a);$tom.insertFirst(this.elMenu,c);if(this.generateHandler){this.generateHandler(d)}if(this.ongeneratedList){this.generateList=this.ongeneratedList.bind(this)}if(this.ongeneratedListItem){this.generateListItem=this.ongeneratedListItem.bind(this)}},getCheckedConfig:function(a){var c=a.options.select(function(d){if(d.expired==true){return false}else{return true}})||[];return c},generateList:function(h){var c=Trex.MarkupTemplate.get("menu.select").evaluateAsDom({items:this.generateListItem(h)});var e=$tom.collectAll(c,"li a");for(var a=0;a<h.length;a++){var j=h[a];var d=e[a];$tx.observe(d,"click",this.onSelect.bindAsEventListener(this,j.data,j.title))}return c},generateListItem:function(d){var a=[];for(var c=0;c<d.length;c++){a.push(Trex.MarkupTemplate.get("menu.select.item").evaluate(d[c]))}return a.join("")},onSelect:function(){var c=$A(arguments);
var a=c.shift();this._command.apply(this,c);this.hide();$tx.stop(a)}});Trex.MarkupTemplate.add("menu.items",['<table unselectable="on"><tbody>',"	#{for:row}<tr>",'		#{for:col}<td class="tx-menu-list-item">','<a href="javascript:;"><span class="#{klass}">','#{if:image!=""}<img src="#{image}" data="#{data}"/>#{/if:image}','#{if:image=""}#{data}#{/if:image}',"</span></a>","		</td>#{/for:col}","	</tr>#{/for:row}","</tbody></table>"].join(""));Trex.MarkupTemplate.add("menu.list",['<div class="tx-menu-inner">','	<div class="tx-menu-list">',"   	#{items}","    </div>","</div>"].join(""));Trex.Menu.List=Trex.Class.create({$extend:Trex.Menu,generate:function(){var d=this.config;var a=d.options.select(function(e){if(e.expired==true){return false}else{return true}})||[];this.cols=d.cols||1;this.rows=d.rows||a.length;var c=this.generateList(a);$tom.insertFirst(this.elMenu,c);if(this.ongeneratedList){this.generateList=this.ongeneratedList.bind(this)}if(this.ongeneratedListItem){this.generateListItem=this.ongeneratedListItem.bind(this)
}if(this.generateHandler){this.generateHandler(d)}},generateList:function(c){var a=Trex.MarkupTemplate.splitList(this.rows,this.cols,c);var d=Trex.MarkupTemplate.get("menu.list").evaluateAsDom({items:Trex.MarkupTemplate.get("menu.items").evaluate(a)});$tx.observe(d,"click",this.onSelect.bindAsEventListener(this));$tx.observe(d,"mouseover",this.onItemMouseOver.bindAsEventListener(this));$tx.observe(d,"mouseout",this.onItemMouseOut.bindAsEventListener(this));return d},onItemMouseOver:function(a){var c=$tx.findElement(a,"span");if(c.tagName&&c.tagName.toLowerCase()=="span"){$tx.addClassName(c,"tx-item-hovered")}$tx.stop(a)},onItemMouseOut:function(a){var c=$tx.findElement(a,"span");if(c.tagName&&c.tagName.toLowerCase()=="span"){$tx.removeClassName(c,"tx-item-hovered")}$tx.stop(a)},onSelect:function(c){var d=$tx.findElement(c,"span");if(d.tagName&&d.tagName.toLowerCase()=="span"){var a;if(d.firstChild&&d.firstChild.nodeType==1&&d.firstChild.tagName.toLowerCase()=="img"){a=$tom.getAttribute(d.firstChild,"data")||""
}else{a=d.innerText}this._command(a);this.hide()}$tx.stop(c)}});Trex.MarkupTemplate.add("menu.matrix",['<div class="tx-menu-inner">','	<ul class="tx-menu-matrix-title">','		#{for:matrices}<li class=""><a href="javascript:;" class="tx-menu-matrix-title-item">#{title}</a></li>#{/for:matrices}',"	</ul>",'	<div class="tx-menu-matrix-listset">','   	#{for:matrices}<div class="tx-menu-matrix-list #{klass}">',"       	#{items}","		</div>#{/for:matrices}","    </div>","</div>"].join(""));Trex.Menu.Matrix=Trex.Class.create({$extend:Trex.Menu,generate:function(){var d=this.config;var a=this.matrices=d.matrices.select(function(e){if(!e.onlyIE||$tx.msie){return true}else{return false}})||[];this.cols=d.cols||10;this.rows=d.rows||5;var c=this.generateMatrix(a);$tom.insertFirst(this.elMenu,c);if(this.ongeneratedList){this.generateList=this.ongeneratedList.bind(this)}if(this.ongeneratedListItem){this.generateListItem=this.ongeneratedListItem.bind(this)}if(this.generateHandler){this.generateHandler(d)}this.showFirstTab()
},regenerate:function(){if(this.showFirstTab){this.showFirstTab()}if(this.regenerateHandler){var a=this.config;this.regenerateHandler(a)}},generateMatrix:function(m){var n=this;var j=this.elMenu;var c=this.cols;var l=this.rows;m.each(function(p){var o=Trex.MarkupTemplate.splitList(l,c,p.options);p.items=Trex.MarkupTemplate.get("menu.items").evaluate(o)});var k=Trex.MarkupTemplate.get("menu.matrix").evaluateAsDom({matrices:m});var h=$tom.collectAll(k,"div.tx-menu-matrix-listset div.tx-menu-matrix-list");var a=$tom.collectAll(k,"ul.tx-menu-matrix-title li");var e=false;var d=0;m.each(function(o){var q=h[d];$tx.observe(q,"click",n.onSelect.bindAsEventListener(n));$tx.observe(q,"mouseover",n.onItemMouseOver.bindAsEventListener(n));$tx.observe(q,"mouseout",n.onItemMouseOut.bindAsEventListener(n));var p=a[d];$tx.observe(p,"click",n.onTitleClick.bindAsEventListener(n,p,q));if(o.defaultshow==true){n.showFirstTab=n.onTitleClick.bindAsEventListener(n,p,q);e=true}d++});if(!e){this.showFirstTab=this.onTitleClick.bindAsEventListener(this,a[0],h[0]);
e=true}return k},onTitleClick:function(d,c,a){if(this.lastElList==a){return}$tx.show(a);if(this.lastElList){$tx.hide(this.lastElList)}this.lastElList=a;if(this.lastElTitleItem){$tx.removeClassName(this.lastElTitleItem,"tx-selected")}$tx.addClassName(c,"tx-selected");this.lastElTitleItem=c;if(d){$tx.stop(d)}},onItemMouseOver:function(a){var c=$tx.findElement(a,"span");if(c.tagName&&c.tagName.toLowerCase()=="span"){$tx.addClassName(c,"tx-item-hovered")}$tx.stop(a)},onItemMouseOut:function(a){var c=$tx.findElement(a,"span");if(c.tagName&&c.tagName.toLowerCase()=="span"){$tx.removeClassName(c,"tx-item-hovered")}$tx.stop(a)},onSelect:function(a){var c=$tx.findElement(a,"span");if(c.tagName&&c.tagName.toLowerCase()=="span"){this._command(c.innerText);this.hide()}$tx.stop(a)}});Trex.MarkupTemplate.add("menu.colorPallete",['<div class="tx-menu-inner">','<ul class="tx-pallete-text-list"></ul>','<ul class="tx-pallete-thumb-list"></ul>','<p class="tx-pallete-input"><span style="background-color: rgb(7, 3, 3);"></span><input type="text" class="tx-color-value"/><a class="tx-enter">@menu.pallete.enter</a></p>','<div class="tx-pallete-buttons">','	<p class="tx-pallete-more"><a class="tx-more-down" href="javascript:;">@menu.pallete.more</a></p>',"</div>",'<div class="tx-pallete-picker">','	<div class="tx-pallete-pickerbox">','		<div class="tx-chromabar" style="background-color: rgb(255, 0, 0);"></div><div class="tx-huebar"></div>',"	</div>","</div>","</div>"].join(""));
Trex.Menu.ColorPallete=Trex.Class.create({$extend:Trex.Menu,$mixins:[Trex.I.ColorPallete],generate:function(c){var d=this.config;var e=this.elMenu;Trex.MarkupTemplate.get("menu.colorPallete").evaluateToDom({},e);var a=d.thumbs.transparent;d.thumbs.transparent=Object.extend(d.thumbs.transparent,{image:TrexConfig.getIconPath(a.image),thumb:TrexConfig.getIconPath(a.thumb),thumbImage:TrexConfig.getIconPath(a.thumbImage)});if(!this.hookEvent){throw new Error("[Exception]Trex.Menu.ColorPallete : not implement function(hookEvent)")}this.hookEvent(d);if(this.generateHandler){this.generateHandler(d)}},onSelect:function(){var c=$A(arguments);var a=c.shift();this._command.apply(this,c);this.remainColor(c);this.hide();$tx.stop(a)},remainColor:function(a){if(a){this.setColorValueAtInputbox(a)}}});Trex.MarkupTemplate.add("blackbox",'<div class="tx-blackbox">		<div class="tx-blackbox-panel"></div>		<div class="tx-content"></div>	</div>');Trex.BlackBox=Trex.Class.create({initialize:function(){},make:function(d){var c=this.elBlackbox=Trex.MarkupTemplate.get("blackbox").evaluateAsDom({});
var e=this.holder=d||document.body;$tom.insertFirst(e,c);this.elBlackboxPanel=$tom.collect(c,"div.tx-blackbox-panel");this.elContentArea=$tom.collect(c,"div.tx-content");var a=this.calculatePanelSize();this.panelWidth=a[0];this.panelHeight=a[1]},show:function(a){if(this.elContentArea.firstChild!=null){return false}$tom.append(this.elContentArea,a);$tx.setStyle(this.elBlackbox,{width:this.panelWidth.toPx(),height:this.panelHeight.toPx()});$tx.setStyle(this.elBlackboxPanel,{width:this.panelWidth.toPx(),height:this.panelHeight.toPx()});$tx.show(this.elBlackbox);this.alignCenter();return false},hide:function(){$tx.hide(this.elBlackbox);this.elContentArea.removeChild(this.elContentArea.firstChild)},calculatePanelSize:function(){var a=$tom.getPosition(this.holder);return[a.width,a.height]},resizeBlackbox:function(a){this.panelHeight=a;$tx.setStyle(this.elBlackbox,{height:this.panelHeight.toPx()});$tx.setStyle(this.elBlackboxPanel,{height:this.panelHeight.toPx()});this.alignCenter()},alignCenter:function(){var h=$tx.getStyle(this.elBlackbox,"width");
var a=$tx.getStyle(this.elBlackbox,"height");var e=$tom.getPosition(this.elContentArea.firstChild);var c=e.width.parsePx();var j=e.height.parsePx();var d=(this.panelWidth-c)/2;var k=(this.panelHeight>j)?(this.panelHeight-j)/2:0;$tx.setStyle(this.elContentArea,{marginLeft:d.toPx(),marginTop:k.toPx()})}});Trex.install("editor.getBlackBox & canvas.getBlackBox",function(d,e,h,c,a){var j=new Trex.BlackBox();d.getBlackBox=function(){return j};c.getBlackBox=function(){return j}});Trex.module("generate blackbox",function(h,j,k,c,a){var e=92;var l=h.getBlackBox();l.calculatePanelSize=function(){var n=c.getSizeConfig().wrapWidth;var m=c.getCurrentPanel().getPanelHeight().parsePx()+e;return[n,m]};var d=h.getWrapper();l.make(d);c.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:27},l.hide.bind(l));h.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:27},l.hide.bind(l));c.observeJob(Trex.Ev.__CANVAS_HEIGHT_CHANGE,function(m){l.resizeBlackbox(m.parsePx()+e)})});Trex.MarkupTemplate.add("noticebox",'<div class="tx-noticebox">	<dl>		<dt>			<span>#{head}</span>			<a href="javascript:;">close</a>		</dt>		<dd>			<p>#{body}</p>			<div>				<a href="javascript:;"><img src="#{confirm}" border="0"/></a>				<a href="javascript:;"><img src="#{cancel}" border="0" /></a>			</div>		</dd>	</dl></div>');
Trex.NoticeBox=Trex.Class.create({initialize:function(c,a){this.make({head:c.head,body:c.body,confirm:c.confirm||"http://icon.daum-img.net/editor/btn_confirm_s1.gif?rv=1.0.1",cancel:c.cancel||"http://icon.daum-img.net/editor/btn_cancel_s1.gif?rv=1.0.1"});this.blackbox=a},make:function(a){if(this.elBox){return this}a=a||{};var c=this.elBox=Trex.MarkupTemplate.get("noticebox").evaluateAsDom(a);$tx.observe($tom.collect(c,"dt a"),"click",this.cancel.bind(this));$tx.observe($tom.collectAll(c,"dd div a")[0],"click",this.confirm.bind(this));$tx.observe($tom.collectAll(c,"dd div a")[1],"click",this.cancel.bind(this));return this},weave:function(d,c,a){this.confirmHandler=d;this.cancelHandler=c;this.completeHandler=a;return this},show:function(){this.blackbox.show(this.elBox)},hide:function(a){this.blackbox.hide();return false},confirm:function(a){if(this.confirmHandler){this.confirmHandler()}return false},cancel:function(a){if(this.cancelHandler){this.cancelHandler()}this.hide(a);return false},complete:function(a){if(this.completeHandler){this.completeHandler()
}this.hide(a);return false}});Trex.install("editor.newNoticeBox",function(d,e,h,c,a){d.newNoticeBox=function(j){return new Trex.NoticeBox(j,d.getBlackBox())}});Trex.Editor=Trex.Class.create({$mixins:[Trex.I.JobObservable,Trex.I.KeyObservable],toolbar:null,sidebar:null,canvas:null,config:null,initialize:function(d){var l=this,k=this.config=TrexConfig.setup(d);var j=this.canvas=new Trex.Canvas(l,k);var c=this.toolbar=new Trex.Toolbar(l,k);var h=this.sidebar=new Trex.Sidebar(l,k);Trex.invokeInstallation(l,c,h,j,k);var a=k.events;var e=function(m){if(a.useHotKey){l.fireKeys(m)}};$tx.observe(document,"keydown",e.bindAsEventListener(this),false);if(j.mode!=Trex.Canvas.__WYSIWYG_MODE){j.fireJobs(Trex.Ev.__CANVAS_MODE_INITIALIZE,Trex.Canvas.__WYSIWYG_MODE,j.mode)}j.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(){var n=l.getInitializedId();var m=$tx("tx_loading"+n);if(!m){return}$tx.hide(m)});Trex.invokeRegisters(l,c,h,j,k);Trex.invokeModules(l,c,h,j,k)},getToolbar:function(){return this.toolbar
},getSidebar:function(){return this.sidebar},getCanvas:function(){return this.canvas},getUsedWebfont:function(){return this.canvas.getUsedWebfont()},getConfig:function(){return this.config},getParam:function(c){var a={},d=this.config;d.params.each(function(e){if(d[e]){a[e]=d[e]}});return a[c]},getWrapper:function(){return $must(this.config.wrapper)},getInitializedId:function(){return this.config.initializedId||""},saveEditor:function(){this.setDisableUnloadHandler();this.getSaver().submit()},loadEditor:function(a){this.getSaver().load(a)},getContent:function(){return this.getSaver().getContent()},getAttachments:function(c,a){return this.getSaver().getAttachments(c,a)},getEmbeddedData:function(a){return this.getSaver().getEmbeddedData(a)},getResults:function(a){return this.getSaver().getResults(a)}});(function(){Editor=Trex.Class.create({$const:{__ACTIVE:false,__PANEL_LOADED:false,__EDITOR_LOADED:false,__MULTI_LIST:[],__SELECTED_INDEX:0},initialize:function(c){StopWatch.start();var h;try{Editor.__EDITOR_LOADED=false;
Editor.__PANEL_LOADED=false;h=new Trex.Editor(c);var j=h.getInitializedId();if(j!=null){var a=j==""?0:j;Editor.__MULTI_LIST[a]=h;Editor.__SELECTED_INDEX=a}Object.extend(Editor,h);Editor.__EDITOR_LOADED=true;Editor.__ACTIVE=true}catch(d){if(h){h.fireJobs(Trex.Ev.__RUNTIME_EXCEPTION,d)}}}});Editor.modify=function(a){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){if(this.loadEditor){this.loadEditor(a)}}else{setTimeout(this.modify.bind(this,a),10)}};Editor.restore=function(a){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){var c=this.getAutoSaver();if(c){c.load(a)}}else{setTimeout(this.restore.bind(this,a),10)}};Editor.save=function(){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){if(this.saveEditor){this.saveEditor()}}else{setTimeout(this.saveEditor.bind(this),10)}return false};Editor.focus=function(){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){var a=this.getCanvas();if(a){a.focus()}}else{setTimeout(this.focus.bind(this),10)}return false};Editor.focusOnTop=function(){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){var a=this.getCanvas();
if(a){a.focusOnTop()}}else{setTimeout(this.focusOnTop.bind(this),10)}return false};Editor.focusOnBottom=function(){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){var a=this.getCanvas();if(a){a.focusOnBottom()}}else{setTimeout(this.focusOnBottom.bind(this),10)}return false};Editor.permitUnload=function(){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){this.setDisableUnloadHandler()}else{setTimeout(this.permitUnload.bind(this),500)}};Editor.onPanelLoadComplete=function(a){if(Editor.__PANEL_LOADED==true&&Editor.__EDITOR_LOADED==true){if(a){a()}}else{Editor.panelLoadCompleteHandler=a}};Editor.switchEditor=function(a){Editor.__SELECTED_INDEX=a;Object.extend(Editor,Editor.__MULTI_LIST[a])};Editor.focusOnForm=function(a){if(Editor.__PANEL_LOADED&&Editor.__EDITOR_LOADED){window.focus();var c=Editor.getForm();if(c.getElementByName(a)){c.getElementByName(a).focus()}}else{setTimeout(Editor.focusOnForm.bind(Editor,a),500)}return false};Editor.prototype.switchEditor=Editor.switchEditor;Editor.prototype.focusOnForm=Editor.focusOnForm
})();Trex.Toolbar=Trex.Class.create({$mixins:[Trex.I.JobObservable],el:null,tools:null,initialize:function(a,c){this.canvas=a.getCanvas();var d=c.initializedId||"";this.el=$must("tx_toolbar_basic"+d,"Trex.Toolbar")},disableToolbar:function(){var c=this.tools;for(var a in c){if(c[a].button){c[a].button.disable()}}},serializeToolValues:function(){var e=this.tools;var a={};for(var d in e){var c=e[d];a[d]=c.button.lastValue}return a},widgetSeq:0,makeWidget:function(d,j,e){var c=this;var h=this.canvas;var a=new (function(){this.identity="widget"+(++c.widgetSeq);this.wysiwygonly=true;this.canvas=h;this.toolbar=c})();Trex.Tool.prototype.weave.bind(a)(d,j,e);this.tools[a.identity]=a;return a}});Trex.install("editor.getTool",function(e,h,j,d,c){var a=h.tools={};e.getTool=function(k){if(a[k]!=null){return a[k]}else{if(arguments.length==0){return a}else{return null}}}});Trex.register("new tools",function(j,l,a,c,d){var k=l.tools;var e=d.initializedId||"";for(var n in Trex.Tool){var m=Trex.Tool[n]["__Identity"];
if(m){var h=TrexConfig.getTool(m,d);h.initializedId=e;if(Trex.available(h,m+e)){k[m]=new Trex.Tool[n](j,l,h)}}}});Trex.module("bind events with tools",function(h,j,l,e,d){var c=j.tools;var a=function(q,p){if(q==p){return}for(var n in c){var m=c[n];var o=m.button;if(Trex.Canvas.__WYSIWYG_MODE==p){o.enable()}else{if(Trex.Canvas.__WYSIWYG_MODE==q){if(m.wysiwygonly){o.disable()}else{o.enable()}}}}};e.observeJob(Trex.Ev.__CANVAS_MODE_CHANGE,a);e.observeJob(Trex.Ev.__CANVAS_MODE_INITIALIZE,a);var k=function(o){for(var n in c){var m=c[n];if(o!=m.identity){if(m.button){m.button.release()}if(m.menu){m.menu.release()}}}};e.observeJob(Trex.Ev.__CANVAS_PANEL_CLICK,k);e.observeJob(Trex.Ev.__CANVAS_SOURCE_PANEL_CLICK,k);e.observeJob(Trex.Ev.__CANVAS_TEXT_PANEL_CLICK,k);j.observeJob(Trex.Ev.__TOOL_CLICK,k);e.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:27},k);h.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:27},k);$tx.observe(document,"click",function(n){var o=$tx.element(n);
var m=["tx-sidebar","tx-toolbar-basic","tx-toolbar-advanced","tx-sidebar-boundary","tx-toolbar-boundary","tx-toolbar-boundary"];if(Trex.Util.getMatchedClassName(o,m)){k("-")}},false)});Trex.Tool=Trex.Class.draft({identity:null,button:null,menu:null,initialize:function(c,d,a){if(!this.constructor.__Identity){throw new Error("[Exception]Trex.Tool : not implement const(__Identity)")}this.identity=this.constructor.__Identity;if(!c){throw new Error("[Exception]Trex.Tool : not exist argument(editor)")}this.editor=c;this.toolbar=d;this.canvas=c.getCanvas();this.config=a;this.wysiwygonly=((a.wysiwygonly!=null)?a.wysiwygonly:true);this.buttonCfg=TrexConfig.merge({id:"tx_"+this.identity},a);this.menuCfg=TrexConfig.merge({id:"tx_"+this.identity+"_menu"},a);this.oninitialized.bind(this)(a)},oninitialized:function(a){throw new Error("[Exception]Trex.Tool : not implements function(oninitialized)")},weave:function(h,a,c,l){var e=this;var m=this.identity;var k=this.toolbar;var j=this.canvas;this.button=h;
h.tool=this;var d=null;if(!a){h.setCommand(d=function(){k.fireJobs(Trex.Ev.__TOOL_CLICK,m);var n=c.apply(e,arguments);return n})}else{this.menu=a;a.tool=this;a.initHandler=l||function(){};a.cancelHandler=function(){h.setState(false)};a.setCommand(d=function(){var n=c.apply(e,arguments);h.updateAfterCommand.apply(h,arguments);return n});h.setCommand(function(){k.fireJobs(Trex.Ev.__TOOL_CLICK,m);if(!h.isPushed()){var o=h.getValue();a.show(o)}else{a.hide()}if($tx.msie){var n=j.getProcessor();if(n.restoreRange){setTimeout(function(){n.restoreRange()},0)}}return true})}this.execute=d}});Trex.Sidebar=Trex.Class.create({$const:{__REG_ENTRY_ATTR_PAIR_Q:new RegExp('([\\w]+)="([^"]+)"',"g"),__REG_ENTRY_ATTR_PAIR_NQ:new RegExp("([\\w]+)=([\\w]+)","g")},$mixins:[Trex.I.JobObservable],entryboxRegistry:null,initialize:function(a,d){var c=a.getCanvas();var e=(d.initializedId)?d.initializedId:"";this.entryboxRegistry={};this.getFields=function(){var h=[];for(var k in this.entryboxRegistry){var j=this.entryboxRegistry[k];
h=h.concat(j.getFields())}return h};this.syncSidebar=function(){var h=c.getContent();for(var j in this.entryboxRegistry){this.entryboxRegistry[j].syncBox(h)}};this.emptyEntries=function(){for(var h in this.entryboxRegistry){this.entryboxRegistry[h].empty()}};c.observeJob(Trex.Ev.__CANVAS_PANEL_DELETE_SOMETHING,function(){this.syncSidebar()}.bind(this))}});Trex.EntryBox=Trex.Class.draft({$mixins:[Trex.I.JobObservable],autoSeq:0,datalist:[],initialize:function(c,a,d){throw new Error("[Exception]Trex.EntryBox : not implements function(initialize)")},newSeq:function(){return(++this.autoSeq)},syncSeq:function(a){this.autoSeq=(a>this.autoSeq)?a:this.autoSeq;return a},empty:function(){this.fireJobs(Trex.Ev.__ENTRYBOX_ALL_ENTRY_REMOVED);this.datalist=[];entry=null},append:function(a){this.datalist.push(a);this.fireJobs(Trex.Ev.__ENTRYBOX_ENTRY_ADDED,a)},modify:function(a){this.fireJobs(Trex.Ev.__ENTRYBOX_ENTRY_MODIFIED,a)},remove:function(a){a.deletedMark=true;this.fireJobs(Trex.Ev.__ENTRYBOX_ENTRY_REMOVED,a)
},syncBox:function(a){this.datalist.each(function(c){c.execSync(a)})},getFields:function(){var a=[];this.datalist.each(function(c){a.push(c.getField())});return a.select(function(c){return(c!=null)})},getEntries:function(a){if(!a){return this.datalist}var c=[];this.datalist.each(function(d){if(d.type==a){c.push(d)}});return c}});Trex.Entry=Trex.Class.draft({$mixins:[Trex.I.JobObservable],existStage:false,deletedMark:false,initialize:function(d,c,e,a){throw new Error("[Exception]Trex.Entry : not implements function(initialize)")},setExistStage:function(a){this.existStage=a},execRegister:function(){this.register();this.entryBox.append(this);this.setExistStage(true)},execReload:function(){if(this.reload){this.reload()}this.entryBox.append(this);this.exchangeHandlerAtReload()},execRemove:function(){this.remove();this.entryBox.remove(this)},execReplace:function(a){this.replace(a);this.entryBox.modify(this);this.setExistStage(true)},execAppend:function(){this.register();this.setExistStage(true)
},execSync:function(a){this.setExistStage(this.checkExisted(a))},checkExisted:function(a){if(this.canvas.canHTML()){return(a.search(this.regHtml)>-1)}else{return(a.search(this.regText)>-1)}},getChangedContent:function(c,h,e,d){var a=false;if(c.search(h)>-1){a=true;if(this.actor.canResized){c=this.getChangedContentWithAttr(c,h,e,d)}else{c=c.replace(h,e)}}this.setExistStage(a);return c},getChangedContentFromHtml:function(a){return this.getChangedContent(a,this.regHtml,this.dispText,["id","class"])},getChangedContentToHtml:function(a){return this.getChangedContent(a,this.regText,this.dispHtml)},getChangedContentAtSave:function(a){return this.getChangedContent(a,this.regHtml,this.saveHtml,["id","class"])},getChangedContentAtLoad:function(a){return this.getChangedContent(a,this.regLoad,this.dispHtml)},getChangedContentWithAttr:function(h,a,n,j){j=j||[];var d=Trex.Util.getAllAttributes(n);var k=function(t){var r=Trex.Util.getMatchValue(/<([a-z]*)/i,n,1);var u=["<"+r.toLowerCase()];var q=Trex.Util.getAllAttributes(t);
for(var p in d){if(["width","height"].include(p)){if(!q[p]){u.push(p+'="'+d[p]+'"')}}else{u.push(p+'="'+d[p]+'"')}}for(var p in q){if(!j.include(p)){if(["width","height"].include(p)){u.push(p+'="'+q[p]+'"')}else{if(!d[p]){u.push(p+'="'+q[p]+'"')}}}}u.push("/>");return u.join(" ")};var m=h;var e;a.lastIndex=0;while((e=a.exec(m))!=null){var c=e[0];var o=k(c);var l=c.getRegExp();h=h.replace(new RegExp(l,"gmi"),o)}return h},getField:function(){if(!this.field){return null}return{name:this.field.name,value:[this.field.value,this.existStage].join("|")}},exchangeHandlerAtReload:function(){}});Trex.Actor=Trex.Class.draft({$mixins:[Trex.I.JobObservable],isDisabled:false,initialize:function(c,a){throw new Error("[Exception]Trex.Actor : not implements function(initialize)")},execAttach:function(d,c){var a=this.createEntry(this.getDataForEntry(d),c);a.execRegister();this.canvas.fireJobs("canvas."+(c||this.constructor.__Identity)+".added",a)},getDatalist:function(){return this.entryBox.getEntries(this.name)
},execReattach:function(h,d){var e=this.getDatalist();var j=this.getDataForEntry(h);if(e.length<1){var a=this.createEntry(j,d);a.execRegister()}else{var a=e[0];var c={regHtml:a.regHtml,regText:a.regText};a.setProperties(j);a.execReplace(c)}},execReload:function(e,d,c){var a=this.createEntry(this.getDataForEntry(e,d),c);a.execReload()},existEntry:function(){return((this.getDatalist().length==0)?false:true)},getFirstEntryData:function(){var a=this.getDatalist();return((a.length==0)?null:a[0].data)}});Trex.install("editor.getDocParser",function(e,h,j,c,a){var d=new Trex.Docparser(e,j,a);e.getDocParser=function(){return d}});Trex.Docparser=Trex.Class.create({initialize:function(c,d,a){this.editor=c;this.sidebar=d;this.config=a},filters:{},registerFilter:function(a,c){this.filters[a]=c},getFilter:function(a){return this.filters[a]},executeFilters:function(e,d){for(var a in this.filters){var c=this.filters[a];if(c[e]){d=c[e](d)}}return d},getContentsAtChangingMode:function(c,a,d){if(a==d){return c
}c=c||"";return this.executeFilters(a.concat("2").concat(d),c)},convertAtLoad:function(c,a,d){if(d=="original"){c=this.executeFilters(a.concat("@load"),c)}else{if(a!=d){c=this.executeFilters(d.concat("2").concat(a),c)}}return c},convertAtSave:function(d,c,a){if(a=="original"){d=this.executeFilters(c.concat("4save"),d)}else{if(c!=a){d=this.executeFilters(c.concat("2").concat(a),d)}}return d},text2source:function(a){return this.executeFilters("text2source",a)},text2html:function(a){if(a===""){return this.config.canvas.bogus_html}return this.executeFilters("text2html",a)},source2text:function(a){return this.executeFilters("source2text",a)},source2html:function(a){if(a===""){return this.config.canvas.bogus_html}return this.executeFilters("source2html",a)},html2text:function(a){return this.executeFilters("html2text",a)},html2source:function(a){return this.executeFilters("html2source",a)}});Trex.install("editor.getEntryProxy",function(e,h,j,d,c){var a=new Trex.EntryProxy(e,j,c);e.getEntryProxy=function(){return a
}});Trex.EntryProxy=Trex.Class.create({initialize:function(c,d,a){this.editor=c;this.sidebar=d;this.config=a},commands:{},registerCommand:function(a,c){this.commands[a]=c},getcommand:function(a){return this.commands[a]},executeCommand:function(d,c){for(var a in this.commands){var e=this.commands[a];if(e[d]){e[d](c)}}},setAttachments:function(a,d){a=a||[];d=d||"";var c=this.editor.getAttachBox();c.empty();var e=this.sidebar.getAttacher();a.each(function(j){var h=e[j.attacher];if(h){h.execReload(j.data,d,j.type)}})},getAttachments:function(a,c){c=!!c;var d=[];a.each(function(e){if(e.deletedMark){return}if(c||e.existStage){d.push({attacher:e.actor.name,existStage:e.existStage,data:Object.extend(e.data,{tmpSeq:e.dataSeq})})}});return d}});Trex.install("editor.getForm",function(d,e,h,c,a){var j=new Trex.FormProxy(d,h,a);d.getForm=function(){return j}});Trex.FormProxy=Trex.Class.create({initialize:function(c,e,a){this.editor=c;this.sidebar=e;this.config=a;var d=this.elForm=document.forms[a.form]||document.getElementById(a.form);
if(!d){throw new Error("[Exception]Trex.Form : not exist element - "+a.form)}d.onsubmit=function(){return false}},submit:function(){this.elForm.submit()},createField:function(a){this.elForm.appendChild(a)},getElements:function(){return this.elForm.elements},getElementByName:function(a){return this.elForm[a]},getFormField:function(){var c={};var e=this.getElements();var a;for(var d=0;d<e.length;d++){a=e[d];if(!["select","input","textarea"].include(a.tagName.toLowerCase())){continue}if(!a.name&&!a.id){continue}if(a.tagName.toLowerCase()=="select"){if(a.selectedIndex>0){c[a.name]=a.options[a.selectedIndex].value}}else{if(a.type=="radio"&&!a.checked){continue}else{if(a.type=="checkbox"&&!a.checked){continue}else{c[a.name||a.id]=a.value}}}}return c},setFormField:function(a){if(!a){return}var k=this.getElements();var e;var c;for(var h=0;h<k.length;h++){e=k[h];if(e.name===null||e.name.length===0){continue}if(!a[e.name]){continue}if(!["select","input","textarea"].include(e.tagName.toLowerCase())){continue
}c=a[e.name];if(e.tagName.toLowerCase()=="select"){for(var d=0;d<e.options.length;d++){if(e.options[d].value==c){e.options[d].selected=true;break}}}else{if(e.type=="radio"||e.type=="checkbox"){if(e.value==c){e.checked=true}continue}else{e.value=c}}}}});Trex.install("editor.getSaver",function(d,e,h,c,a){var j=new Trex.Save(d,e,h,c,a);d.getSaver=function(){return j}});Trex.Save=Trex.Class.create({editor:null,toolbar:null,sidebar:null,canvas:null,config:null,form:null,initialize:function(d,e,h,c,a){this.editor=d;this.toolbar=e;this.sidebar=h;this.canvas=c;this.config=a;this.form=d.getForm();this.docparser=d.getDocParser();this.entryproxy=d.getEntryProxy()},save:function(){try{if(validForm){if(!validForm(this.editor)){return false}}if(setForm){if(!setForm(this.editor)){return false}}return true}catch(a){this.editor.fireJobs(Trex.Ev.__RUNTIME_EXCEPTION,a);return false}},submit:function(){if(this.save()){this.editor.fireJobs(Trex.Ev.__ON_SUBMIT,this.editor);var a=this.form;setTimeout(function(){a.submit()
},500)}},getContent:function(c){var e=this.canvas;var a=e.mode;var h=c||"original";var d=e.getContent();d=this.docparser.convertAtSave(d,a,h);return d},getAttachments:function(c,a){a=a||false;var d=this.sidebar.getAttachments(c);return this.entryproxy.getAttachments(d,a)},getEmbeddedData:function(a){return this.sidebar.getEmbeddedData(a)},getResults:function(a){return this.sidebar.getResults(a)},load:function(k){if(!k){throw new Error("[Exception]Trex.Save : not exist argument(data)")}if(typeof(loadForm)!="undefined"){loadForm(this.editor,k)}var h=this.canvas;var j=this.toolbar;var a=this.sidebar;var l=this.form;var m=h.mode;var c=(!k.inputmode||k.inputmode=="html")?"original":k.inputmode;var d="";var e=k.content;if(typeof e=="string"){d=k.content}else{if(e&&e.nodeType&&(e.nodeType==1)){d=k.content.value}else{throw new Error("[Exception]Trex.Save : invalid argument(jsonData.content)")}}this.entryproxy.setAttachments(k.attachments,d);d=this.docparser.convertAtLoad(d,m,c);h.initContent(d);
a.syncSidebar();if(typeof(postLoad)!="undefined"){postLoad(this.editor,k)}},makeField:function(){var e=this.sidebar;var d=this.form;var a=this.getContent();d.createField(tx.textarea({name:"tx_content",style:{display:"none"}},a));var c=e.getFields();c.each(function(h){d.createField(tx.input({type:"hidden",name:h.name,value:h.value}))})}});Trex.module("new Trex.Resizer",function(e,h,j,d,c){var k=c.initializedId||"";var a=TrexConfig.get("resizer",c);if(Trex.available(a,"resizer"+k)){new Trex.Resizer(e,a)}});TrexConfig.add({resizer:{minHeight:200}});Trex.Resizer=Trex.Class.create({$const:{__Identity:"resizer"},$mixins:[Trex.I.JobObservable],initialize:function(e,c){var k=0;if(!e){return}var l=e.getInitializedId();var d=this.elBar=$must("tx_resizer"+l,"Trex.Worker.Resizer");if(!d){return}if($tx.msie_ver=="5.5"){d.setAttribute("align","center")}this.resizeHeightAtService=function(m){if(typeof(resizeHeight)!="undefined"){resizeHeight(m)}};var a=c.minHeight;var j;this.startDrag=function(n){var p=e.getCanvas();
var o=p.getCurrentPanel();if(o==null){return}var m=o.getPosition();this.panelHeight=m.height;this.dragStartPosY=n.clientY;this.isDragging=true;$tx.observe(document,"mousemove",this.documentDraggingHandler);$tx.observe(document,"mouseup",this.stopDragHandler);if(o.getName()==Trex.Canvas.__WYSIWYG_MODE){this.panelTop=m.y;j=o.getDocument();if(j==null){return}p.fireJobs("canvas.height.beforechange");$tx.observe(j,"mousemove",this.wysiwygDraggingHandler);$tx.observe(j,"mouseup",this.stopDragHandler)}$tx.stop(n)};this.stopDrag=function(m){var o=e.getCanvas();var n=o.getCurrentPanel();if(n==null){return}this.isDragging=false;$tx.stopObserving(document,"mousemove",this.documentDraggingHandler);$tx.stopObserving(document,"mouseup",this.stopDragHandler);if(j==null){return}$tx.stopObserving(j,"mousemove",this.wysiwygDraggingHandler);$tx.stopObserving(j,"mouseup",this.stopDragHandler);j=null;this.resizeHeightAtService(k);o.fireJobs("canvas.height.afterchange");$tx.stop(m)};this.dragingAtDocument=function(n){var p=e.getCanvas();
if(this.isDragging){var o=p.getCurrentPanel();if(o==null){return}try{var m=Math.max((this.panelHeight+n.clientY-this.dragStartPosY),a).toPx();o.setPanelHeight(m);k=m;p.fireJobs("canvas.height.change",m)}catch(q){}}$tx.stop(n)};this.dragingAtWysiwyg=function(n){var p=e.getCanvas();if(this.isDragging){var o=p.getCurrentPanel();if(o==null){return}try{var r=document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset;var m=Math.max((this.panelHeight+n.clientY-this.dragStartPosY+this.panelTop-r),a).toPx();o.setPanelHeight(m);p.fireJobs("canvas.height.change",m)}catch(q){}}$tx.stop(n)};this.startDragHandler=this.startDrag.bindAsEventListener(this);this.stopDragHandler=this.stopDrag.bindAsEventListener(this);this.documentDraggingHandler=this.dragingAtDocument.bindAsEventListener(this);this.wysiwygDraggingHandler=this.dragingAtWysiwyg.bindAsEventListener(this);this.isDragging=false;$tx.observe(d,"mousedown",this.startDragHandler);var h=e.getCanvas();h.observeJob("canvas.fullscreen.change",function(){$tx.hide(d)
});h.observeJob("canvas.normalscreen.change",function(){$tx.show(d)})}});(function(){var a=20;Trex.History=Trex.Class.create({});Trex.History.prototype={canvas:null,initialContent:null,undoTaskList:null,redoTaskList:null,currentTask:null,snapshotData:{},inithandlers:[],isNewTypingForUndo:false,initialize:function(e,d){var c=this;var h=this.canvas=e;this.currentTask=new Trex.History.Task({content:d.bogus_html,scrollTop:0},function(j){c.inithandlers.each(function(k){k(j)})});this.currentTask.makeSnapshot(this.snapshotData);this.undoTaskList=[];this.redoTaskList=[];h.observeJob("canvas.panel.undo",function(){var m=h.getProcessor();if(!m){return}if(c.undoTaskList.length==0){return}if(c.isNewTypingForUndo){var l=c.getTextData();var k=c.getTextHandler();var j=new Trex.History.Task(l,k);j.makeBackup(c.snapshotData);c.redoTaskList=[j];j.undo();c.isNewTypingForUndo=false}else{var j=c.currentTask;if(c.redoTaskList.length>a-1){c.redoTaskList.shift()}c.redoTaskList.push(j);j.undo();j.makeSnapshot(c.snapshotData);
var n=c.undoTaskList.last();if(c.undoTaskList.length>0){c.undoTaskList.pop()}c.currentTask=n}});h.observeJob("canvas.panel.redo",function(){var k=h.getProcessor();if(!k){return}if(c.redoTaskList.length==0){return}var j=c.currentTask;if(c.undoTaskList.length>a-1){c.undoTaskList.shift()}c.undoTaskList.push(j);var l=c.redoTaskList.last();if(c.redoTaskList.length>0){c.redoTaskList.pop()}c.currentTask=l;l.redo();l.makeSnapshot(c.snapshotData)})},initHistory:function(c){Object.extend(this.snapshotData,c);this.isNewTypingForUndo=true},addInitHandler:function(d,c){Object.extend(this.current.current,d);this.inithandlers.push(c);Object.extend(this.snapshotData,d)},saveHistory:function(e,d){if(this.undoTaskList.length>a-1){this.undoTaskList.shift()}this.undoTaskList.push(this.currentTask);this.redoTaskList=[];if(!e){e=this.getTextData();d=this.getTextHandler()}var c=new Trex.History.Task(e,d);c.swapData(this.snapshotData);this.currentTask=c;this.isNewTypingForUndo=false},saveHistoryByKey:function(c){if(c.code==229){return
}if(c.code==Trex.__KEY.ENTER||c.code==Trex.__KEY.SPACE){if(this.isNewTypingForUndo){this.saveHistory()}}else{if(c.code==Trex.__KEY.DELETE||c.code==Trex.__KEY.BACKSPACE){this.saveHistory()}else{if((c.code==Trex.__KEY.PASTE||c.code==Trex.__KEY.CUT)&&c.ctrl){this.saveHistory(true)}else{if(((c.code>32&&c.code<41)&&c.shift)||(c.code==65&&c.ctrl)){if(this.isNewTypingForUndo){this.saveHistory()}}else{if(c.ctrl||c.shift||c.alt){}else{this.isNewTypingForUndo=true}}}}}},injectHistory:function(d,c){this.currentTask.injectHandler(c);this.currentTask.injectData(d,this.snapshotData)},getTextHandler:function(){var c=this.canvas;return function(d){c.setContent(d.content);c.setScrollTop(d.scrollTop)}},getTextData:function(){var c=this.canvas;return{content:c.getContent(),scrollTop:c.getScrollTop()}}};Trex.History.Task=Trex.Class.create({initialize:function(d,c){this.handler=[];this.previous={};this.current=Object.extend({},d);this.handler.push(c)},swapData:function(c){this.makeBackup(c);this.makeSnapshot(c)
},makeBackup:function(d){for(var c in this.current){if(typeof d[c]=="string"||typeof d[c]=="number"){this.previous[c]=d[c]}else{this.previous[c]=Object.extend({},d[c])}}},makeSnapshot:function(d){for(var c in this.current){d[c]=this.current[c]}},injectHandler:function(c){this.handler.push(c)},injectData:function(e,d){Object.extend(this.current,e);for(var c in e){if(typeof d[c]=="string"||typeof d[c]=="number"){this.previous[c]=d[c]}else{this.previous[c]=Object.extend({},d[c])}}for(var c in this.current){d[c]=this.current[c]}},redo:function(){for(var c=0;c<this.handler.length;c++){this.handler[c](this.current)}},undo:function(){for(var c=0;c<this.handler.length;c++){this.handler[c](this.previous)}}})})();(function(a){TrexConfig.add({canvas:{doctype:"html",mode:["text","html","source"],styles:{color:"#333333",fontFamily:"\ub3cb\uc6c0",fontSize:"9pt",backgroundColor:"#ffffff",lineHeight:"1.5",padding:"8px"},selectedMode:"html",readonly:false,initHeight:400,minHeight:200,ext:"html",param:"",bogus_html:(($tx.msie)?"<p>&nbsp;</p>":"<p><br/></p>"),newlinepolicy:"p"}},function(d){var h=TrexConfig.get("canvas",d);
var c=d.events;h.initializedId=d.initializedId;h.useHotKey=c.useHotKey;var j=TrexConfig.getTool("switcher",d);if(a.available(j,"switcher"+h.initializedId)){h.mode=j.options.pluck("data")}var k=TrexConfig.getTool("fontfamily",d);if(a.available(k,"fontfamily"+h.initializedId)){if(k.webfont&&k.webfont.use){h.webfont=k.webfont;h.webfont.options.each(function(l){l.url=TrexConfig.getUrl(l.url)})}}var e=TrexConfig.get("resizer",d);if(e){h.minHeight=e.minHeight}h.wysiwygUrl=TrexConfig.getUrl(["#host#path/pages/wysiwyg",((h.doctype=="html")?"_html":"_xhtml"),".",(h.ext?h.ext:"html"),"?prefix="+d.initializedId,"&",h.param].join(""))});TrexConfig.add({size:{}});a.Canvas=a.Class.create({$const:{__TEXT_MODE:"text",__HTML_MODE:"source",__WYSIWYG_MODE:"html",__WYSIWYG_PADDING:8,__IMAGE_PADDING:5},$mixins:[a.I.JobObservable,a.I.KeyObservable,a.I.ElementObservable,a.I.MouseoverObservable],editor:null,elContainer:null,config:null,history:null,panels:null,initialize:function(c,h){var j=this.editor=c;var e=this;
var d=this.config=TrexConfig.get("canvas",h);var k=((h.initializedId)?h.initializedId:"");this.elContainer=$must("tx_canvas"+k,"Trex.Canvas");this.wysiwygEl=$must("tx_canvas_wysiwyg_holder"+k,"Trex.Canvas");this.sourceEl=$must("tx_canvas_source_holder"+k,"Trex.Canvas");this.textEl=$must("tx_canvas_text_holder"+k,"Trex.Canvas");this.initConfig(h);this.createPanel();this.history=new a.History(this,d)},initConfig:function(e){var d=this.config;this.getRootConfig=function(){return e};this.getConfig=function(){return d};this.getStyleConfig=function(j){if(j){return d.styles[j]}else{return d.styles}};var c=TrexConfig.get("size",e);var h=$tx.getDimensions(this.elContainer);c.wrapWidth=h.width;if(!c.contentWidth){c.contentWidth=c.wrapWidth}c.contentPadding=d.styles.padding.parsePx();this.getSizeConfig=function(){return c}},createPanel:function(){var e=this;var d=this.config;this.panels={};this.mode=d.selectedMode||a.Canvas.__WYSIWYG_MODE;if($tx.iphone||$tx.ipod){this.mode=a.Canvas.__TEXT_MODE}var c={text:function(h){return new a.Canvas.TextPanel(e,h)
},source:function(h){return new a.Canvas.HtmlPanel(e,h)},html:function(h){return new a.Canvas.WysiwygPanel(e,h)}};d.mode.each(function(h){if(c[h]){e.panels[h]=c[h](d)}});e.observeJob("canvas.panel.iframe.load",function(h){e.fireJobs(a.Ev.__IFRAME_LOAD_COMPLETE,h)});if(this.mode!=a.Canvas.__WYSIWYG_MODE){this.panels[a.Canvas.__WYSIWYG_MODE].hide()}this.panels[this.mode].show()},changeMode:function(k){var j=this.getRootConfig();var n=this.editor;var c=this.mode;if(c==k){return}var m=this.panels[c];var h=this.panels[k];if(!m||!h){throw new Error("[Exception]Trex.Canvas : not suppored mode")}var d=m.getContent();d=n.getDocParser().getContentsAtChangingMode(d,c,k);if(c==a.Canvas.__WYSIWYG_MODE){m.setContent("");try{this.focusOnTop()}catch(l){}}h.setContent(d);this.mode=k;this.fireJobs(a.Ev.__CANVAS_MODE_CHANGE,c,k);h.setPanelHeight(m.getPanelHeight());m.hide();h.show();try{if(k=="html"&&!this.getPanel("html").designModeActivated&&$tx.gecko){this.getPanel("html").el.contentDocument.designMode="on";
this.getPanel("html").designModeActivated=true}}catch(l){throw l}},focus:function(){this.panels[this.mode].focus()},focusOnTop:function(){if(!this.canHTML()){return}this.getProcessor().focusOnTop()},focusOnBottom:function(){if(!this.canHTML()){return}this.getProcessor().focusOnBottom()},getCanvasPos:function(){var c=$tx.cumulativeOffset(this.elContainer);return{x:c[0],y:c[1]}},setCanvasSize:function(c){if(this.panels[this.mode]&&c.height){this.panels[this.mode].setPanelHeight(c.height)}else{throw new Error("[Exception]Trex.Canvas : argument has no property - size.height ")}},canHTML:function(){return(this.mode==a.Canvas.__WYSIWYG_MODE)?true:false},getPanel:function(c){if(this.panels[c]){return this.panels[c]}else{return null}},getCurrentPanel:function(){if(this.panels[this.mode]){return this.panels[this.mode]}else{return null}},getProcessor:function(){return this.panels[this.mode].getProcessor()},getContent:function(){var c=this.panels[this.mode].getContent();if(c){c=c.replace(/\ufeff/g,"")
}return c},getScrollTop:function(){if(!this.canHTML()){return 0}return this.panels[this.mode].getScrollTop()},setScrollTop:function(c){if(!this.canHTML()){return}this.panels[this.mode].setScrollTop(c)},setContent:function(c){this.panels[this.mode].setContent(c);this.includeWebfontCss(c)},initContent:function(c){this.history.initHistory({content:c});this.panels[this.mode].setContent(c);this.includeWebfontCss(c);this.fireJobs(a.Ev.__CANVAS_DATA_INITIALIZE,a.Canvas.__WYSIWYG_MODE,null);this.focusOnTop()},includeWebfontCss:function(c){if(!this.canHTML()){return}return this.panels[this.mode].includeWebfontCss(c)},getUsedWebfont:function(){if(!this.canHTML()){return[]}return this.panels[this.mode].getUsedWebfont()},runScript:function(c){if(!this.canHTML()){return[]}this.panels[this.mode].runScript(c)},query:function(d){if(!this.canHTML()){return null}var c=this.getProcessor();return d(c)},execute:function(e){var d=this.history;var c=this.getProcessor();if(this.canHTML()){if($tx.msie){setTimeout(function(){c.restoreRange();
e(c);d.saveHistory();c.restore()},0)}else{e(c);c.focus();d.saveHistory();c.restore()}}else{e(c)}},moveCaret:function(c){if(!c){return}if(!this.canHTML()){return}this.getProcessor().moveCaretWith(c)},pasteContent:function(e,c,d){c=c||false;this.execute(function(h){h.pasteContent(e,c,d)})},pasteNode:function(e,c,d){if(!this.canHTML()){return}c=c||false;this.execute(function(h){h.pasteNode(e,c,d)})},addStyle:function(c){this.panels[this.mode].addStyle(c)},getStyle:function(c){return this.panels[this.mode].getStyle(c)},getPositionByNode:function(c){if(!this.canHTML()){return{x:0,y:0,width:0,height:0}}return this.panels[this.mode].getPositionByNode(c)}})})(Trex);Trex.module("focus body @after editor iframe load",function(d,e,h,c,a){c.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(j){if(!c.canHTML()){return}try{var k=c.getProcessor();k.focusOnTop()}catch(l){}})});Trex.module("make getter for 'iframeheight' and 'iframetop' size",function(e,h,j,d,c){var k=0;var a=0;d.observeJob(Trex.Ev.__CANVAS_HEIGHT_CHANGE,function(l){k=l.parsePx()
});d.observeJob("canvas.apply.background",function(){var m=d.getPanel(Trex.Canvas.__WYSIWYG_MODE);var l=$tom.getPosition(m.el);a=l.y});d.reserveJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(){var m=d.getPanel(Trex.Canvas.__WYSIWYG_MODE);k=m.getPanelHeight().parsePx();var l=$tom.getPosition(m.el);a=l.y},300);d.getIframeHeight=function(){return k};d.getIframeTop=function(){return a}});Trex.Canvas.BasedPanel=Trex.Class.draft({initialize:function(d,c){this.config=c;this.canvas=d;this.elHolder=this.getHolder(c);this.el=this.getPanel(c);if(!this.el){throw new Error("[Exception]Trex.Canvas.Panel : panel element is not founded")}var a=this.constructor.__MODE;this.getName=function(){return a};this.lastHeight=c.initHeight?c.initHeight.toPx():"400px"},focus:function(){this.el.focus()},show:function(){try{$tx.show(this.elHolder)}catch(a){}},hide:function(){$tx.hide(this.elHolder)},getStyle:function(a){if(this.el.style[a]){return this.el.style[a]}else{return null}},addStyle:function(c){for(var a in c){if(this.el.style[a]){this.el.style[a]=c[a]
}}},getPosition:function(){return $tom.getPosition(this.el)},getPanelHeight:function(){return $tom.getHeight(this.el).toPx()},setPanelHeight:function(a){a=a.toPx();if(this.lastHeight==a){return}$tom.setHeight(this.el,a);this.lastHeight=a}});(function(){Trex.Canvas.WysiwygPanel=Trex.Class.create({$extend:Trex.Canvas.BasedPanel,$const:{__MODE:Trex.Canvas.__WYSIWYG_MODE},initialize:function(canvas,config){var _panel=this;var _canvas=canvas;config=Object.extend({},config);this.$super.initialize(canvas,config);var _elPanel=this.el;var _win=_elPanel.contentWindow;var _doc;var _processor;var _name=this.constructor.__MODE;this.getName=function(){return _name};this.getDocument=function(){return _doc};this.getWindow=function(){return _win};this.getContent=function(){return _doc.body.innerHTML};this.setContent=function(content){_doc.body.innerHTML=content?content.replace(/\ufeff/g,""):config.bogus_html;if($tx.msie){var _pNodes=$tom.collectAll(_doc.body,"p,li");for(var i=0,len=_pNodes.length;i<len;
i++){if($tom.getLength(_pNodes[i])==0){_pNodes[i].innerHTML="&nbsp;"}if($tom.getLength(_pNodes[i])==1&&_pNodes[i].innerHTML=="&nbsp;"){_pNodes[i].innerHTML=""}}}};this.getProcessor=function(){return _processor};this.focus=function(){_processor.focus()};this.getStyle=function(name){return $tx.getStyle(_doc.body,name)};this.addStyle=function(styles){try{for(var name in styles){_doc.body.style[name]=styles[name]}}catch(e){}};this.getScrollTop=function(){return $tom.getScrollTop(_doc)};this.setScrollTop=function(scrollTop){$tom.setScrollTop(_doc,scrollTop)};this.getScrollLeft=function(){return $tom.getScrollLeft(_doc)};var _relative;this.getPositionByNode=function(node){return _relative.getRelative(node)};var _webfontLoader;this.includeWebfontCss=function(content){if($tx.msie){_webfontLoader.load(content)}};this.getUsedWebfont=function(){if(!$tx.msie){return[]}return _webfontLoader.getUsed()};var _isJsHolding=false;var _jsQueue=[];var _runScript=function(){if(_jsQueue.length==0){return}if(!_isJsHolding){_isJsHolding=true;
try{_win.eval(_jsQueue.shift())}catch(e){}finally{_isJsHolding=false}}setTimeout(_runScript,5)};this.runScript=function(script){_jsQueue.push(script);_runScript()};_canvas.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(panelDoc){_doc=panelDoc;installHyperscript(_win,_doc);if(config.newlinepolicy=="br"){_processor=new Trex.Canvas.ProcessorBR(_win,_doc)}else{_processor=new Trex.Canvas.ProcessorP(_win,_doc)}_relative=new WysiwygRelative(_doc,_elPanel);_webfontLoader=new WebfontLoader(_doc,config);if(!(config.readonly||false)){if($tx.msie||$tx.chrome||$tx.webkit_ver>=3){_doc.body.setAttribute("contentEditable","true")}else{setTimeout(function(){try{_doc.designMode="On";if($tx.gecko){_doc.execCommand("enableInlineTableEditing",false,false)}}catch(e){_panel.designModeActivated=false}},10)}}try{_panel.setBodyStyle(_doc,config.styles)}catch(e){}_panel.setContent();Editor.__PANEL_LOADED=true});_canvas.reserveJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(panelDoc){try{_panel.setFontStyle(_doc,config.styles)
}catch(e){}_panel.bindEvents(_win,_doc,_canvas,config)},500);_elPanel.setAttribute("src",config.wysiwygUrl)},bindEvents:function(win,doc,canvas,config){var _doc=doc;var _win=win;var _canvas=canvas;var _cvConfig=config;var _history=_canvas.history;var _processor=_canvas.getProcessor();var _cachedKeyCode;var _typingCount=0;var _isNewTypingForSync=false;var _queryKey={};[13,8,32,33,34,37,38,39,40,46].each(function(key){_queryKey[key]=true});var _wysiwyghandlers={keydown:function(ev){_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_KEYDOWN,ev);if(config.useHotKey){_canvas.fireKeys(ev)}},keypress:function(ev){switch(ev.keyCode){case 8:case 16:case 17:case 18:case 32:case 33:case 34:case 37:case 38:case 39:case 40:case 46:case 229:return}if(_cachedKeyCode&&_cachedKeyCode==ev.keyCode){return}else{if(++_typingCount>10){_queryState(ev);_typingCount=0}}_cachedKeyCode=ev.keyCode},keyup:function(ev){if(_queryKey[ev.keyCode]){_processor.clearDummy()}_history.saveHistoryByKey({code:ev.keyCode,ctrl:ev.ctrlKey||(ev.keyCode==17),alt:ev.altKey||(ev.keyCode==18),shift:ev.shiftKey||(ev.keyCode==16)});
try{_isNewTypingForSync=true;_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_KEYUP,ev);if(_queryKey[ev.keyCode]){_queryState(ev)}if(ev.keyCode==Trex.__KEY.DELETE||ev.keyCode==Trex.__KEY.BACKSPACE){_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_DELETE_SOMETHING)}}catch(e){}},mouseover:function(ev){try{_canvas.fireMouseover($tx.element(ev))}catch(e){}_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_MOUSEOVER,ev)},mousedown:function(ev){_processor.clearDummy();try{_canvas.fireElements($tx.element(ev))}catch(e){}_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_MOUSEDOWN,ev);if(_history.isNewTypingForUndo){_history.saveHistory()}},mouseup:function(ev){_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_MOUSEUP,ev);setTimeout(function(){_propertySyncHandler(true)},20)},click:function(ev){_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_CLICK,ev)},scroll:function(ev){_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_SCROLLING,ev)}};var handlers=_wysiwyghandlers;for(var eventType in handlers){var handler=handlers[eventType];if(eventType=="keypress"){eventType=($tx.msie||$tx.webkit)?"keydown":"keypress"
}if(eventType=="scroll"){if($tx.opera){setTimeout(function(){$tx.observe(_win,eventType,handler,false)},100)}else{$tx.observe(_win,eventType,handler,false)}}else{$tx.observe(_doc,eventType,handler,false)}}var _propertySyncHandler=function(isMouseEv){try{_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS);if(!isMouseEv){_canvas.fireElements(_processor.getTxSel().getNode())}}catch(e){}};var _queryState=function(ev){if(!_canvas.canHTML()){return}var _processor=_canvas.getProcessor();setTimeout(function(){_propertySyncHandler()},0)};_canvas.syncProperty=function(isMouseEv){setTimeout(function(){_propertySyncHandler(isMouseEv)},20)};var _intvl=-1;var _checkContentChange=function(){if(_isNewTypingForSync){_canvas.fireJobs(Trex.Ev.__CANVAS_PANEL_DELETE_SOMETHING);_isNewTypingForSync=false}};setTimeout(function(){_intvl=setInterval(_checkContentChange,3000)},10000)},setBodyStyle:function(doc,styles){for(var _style in styles){if("||color||fontSize||fontFamily||lineHeight||".indexOf("||"+_style+"||")<0){doc.body.style[_style]=styles[_style]
}}},setFontStyle:function(doc,styles){var _csses=new Template("			body, td, button {				color:#{color};				font-size:#{fontSize};				font-family:#{fontFamily};				line-height:#{lineHeight};			}			a, a:hover, a:link, a:active, a:visited { color:#{color}; }			div.txc-search-border { border-color:#{color}; }			div.txc-search-opborder { border-color:#{color}; }			img._tx-unresizable { width: auto !important; height: auto !important; }			blockquote.txc-info h3, blockquote.txc-info h4 { font-size:#{fontSize}; }			button a { text-decoration:none #{if:browser=='firefox'}!important#{/if:browser}; color:#{color} #{if:browser=='firefox'}!important#{/if:browser}; }		").evaluate(Object.extend(styles,{browser:$tx.browser}));var _elStyle=doc.createElement("style");_elStyle.setAttribute("type","text/css");if(_elStyle.styleSheet){_elStyle.styleSheet.cssText=_csses}else{_elStyle.textContent=_csses}doc.getElementsByTagName("head")[0].appendChild(_elStyle)},getPanel:function(config){var _initializedId=((config.initializedId)?config.initializedId:"");
return $must("tx_canvas_wysiwyg"+_initializedId,"Trex.Canvas.WysiwygPanel")},getHolder:function(config){var _initializedId=((config.initializedId)?config.initializedId:"");return $must("tx_canvas_wysiwyg_holder"+_initializedId,"Trex.Canvas.WysiwygPanel")},show:function(){this.$super.show();var _processor=this.getProcessor();if(_processor){setTimeout(function(){try{_processor.focusOnBottom()}catch(e){}},100)}},hide:function(){var _processor=this.getProcessor();if(_processor){_processor.blur()}this.$super.hide()}});var __SCROLL_WIDTH=16;var WysiwygRelative=Trex.Class.create({initialize:function(doc,elPanel){this.doc=doc;this.elPanel=elPanel},getRelative:function(node){var _relatives={x:0,y:0,width:0,height:0};if(node){var _position=$tom.getPosition(node,true);var _frameHeight=$tom.getHeight(this.elPanel);var _scrollTop=$tom.getScrollTop(this.doc);if(_position.y+_position.height<_scrollTop||_position.y>_scrollTop+_frameHeight){return _relatives}else{var _frameLeft=0;var _frameTop=0;var _frameWidth=$tom.getWidth(this.elPanel);
var _scrollLeft=$tom.getScrollLeft(this.doc);_relatives.x=_frameLeft+((_scrollLeft>0)?0:_position.x);_relatives.width=Math.min(_frameWidth-_position.x-__SCROLL_WIDTH,_position.width-((_scrollLeft>0)?_scrollLeft-_position.x:0));_relatives.height=_position.height;_relatives.y=_position.y-_scrollTop+_frameTop}}return _relatives}});var WebfontLoader=Trex.Class.create({initialize:function(doc,config){this.doc=doc;this.styleCnt=0;this.defWebfont=config.styles.fontFamily;this.useWebfont=(config.webfont&&config.webfont.use);this.webfontCfg=config.webfont||[];this.elStyleSheet=this.getStyleSheet()},load:function(content){if(!content){return}if(!this.useWebfont){return}var _matchs=[];content+=" // font-family:"+this.defWebfont;content.replace(/font-family\s*:\s*(\w*)/gi,function(full,name){_matchs.push(name);return full});if(_matchs.length==0){return}var _loader=this;setTimeout(function(){var _matchedSource=_matchs.uniq().join("||");_loader.webfontCfg.options.each(function(item){if(item.url&&_matchedSource.indexOf(item.data)>-1){_loader.imports(item)
}})},10)},getUsed:function(){var _result=[];if(!this.useWebfont){return _result}this.webfontCfg.options.each(function(item){if(!item.url){_result.push(item.data)}});return _result},getStyleSheet:function(){return this.doc.styleSheets[this.styleCnt++]},imports:function(item){try{this.elStyleSheet.addImport(item.url,2)}catch(e){this.elStyleSheet=this.getStyleSheet();this.elStyleSheet.addImport(item.url,2)}item.url=null}})})();Trex.module("interrupt enter key action @ wysiwyg panel",function(d,h,j,c,a){var e=c.config.newlinepolicy;c.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:Trex.__KEY.ENTER},function(l){if(!c.canHTML()){return}var k=c.getProcessor();try{k.getTxSel().collapse(false);if(e=="p"){k.controlEnterByParagraph(l)}else{k.controlEnterByLinebreak(l)}}catch(m){if(m==$propagate){throw m}}});c.observeKey({ctrlKey:false,altKey:false,shiftKey:true,keyCode:Trex.__KEY.ENTER},function(l){if(!c.canHTML()){return}var k=c.getProcessor();try{k.getTxSel().collapse(false);if(e=="p"){k.controlEnterByLinebreak(l)
}else{k.controlEnterByParagraph(l)}}catch(m){if(m==$propagate){throw m}}})});Trex.Canvas.HtmlPanel=Trex.Class.create({$extend:Trex.Canvas.BasedPanel,$const:{__MODE:Trex.Canvas.__HTML_MODE},initialize:function(c,a){this.$super.initialize(c,a);var d=new Trex.Canvas.TextAreaProcessor(this.el);this.getProcessor=function(){return d};this.bindEvents();this.lastHeight=(this.lastHeight-9*2).toPx()},bindEvents:function(){var a={keydown:function(e){var h=this.canvas;var d=this.config;this.canvas.fireJobs(Trex.Ev.__CANVAS_SOURCE_PANEL_KEYDOWN,e)},keyup:function(d){this.canvas.getProcessor().savePosition()},mousedown:function(d){this.canvas.fireJobs(Trex.Ev.__CANVAS_SOURCE_PANEL_MOUSEDOWN,d)},mouseup:function(d){this.canvas.getProcessor().savePosition()},click:function(d){this.canvas.fireJobs(Trex.Ev.__CANVAS_SOURCE_PANEL_CLICK,d)}};for(var c in a){$tx.observe(this.el,c,a[c].bind(this),true)}},getPanel:function(a){var c=((a.initializedId)?a.initializedId:"");return $must("tx_canvas_source"+c,"Trex.Canvas.HtmlPanel")
},getHolder:function(a){var c=((a.initializedId)?a.initializedId:"");return $must("tx_canvas_source_holder"+c,"Trex.Canvas.HtmlPanel")},show:function(){this.$super.show();var c=this.el;var a=this.elHolder;setTimeout(function(){c.focus();if($tx.msie&&$tx.msie_ver<7){a.style.padding="1px";setTimeout(function(){a.style.padding="0px"},0)}},100)},getContent:function(){return this.el.value},setContent:function(c){var a=new Trex.Validator();if(a.exists(c)){this.el.value=c}else{this.el.value=""}},getPanelHeight:function(){return($tom.getHeight(this.el).parsePx()+2).toPx()},setPanelHeight:function(a){this.$super.setPanelHeight((a.parsePx()-2).toPx())}});Trex.Canvas.TextPanel=Trex.Class.create({$extend:Trex.Canvas.BasedPanel,$const:{__MODE:Trex.Canvas.__TEXT_MODE},initialize:function(c,a){this.$super.initialize(c,a);var d=new Trex.Canvas.TextAreaProcessor(this.el);this.getProcessor=function(){return d};this.bindEvents();this.lastHeight=(this.lastHeight-9*2).toPx()},bindEvents:function(){var a={keydown:function(d){},keyup:function(d){},mousedown:function(d){},mouseup:function(d){},click:function(d){this.canvas.fireJobs(Trex.Ev.__CANVAS_TEXT_PANEL_CLICK,d)
}};for(var c in a){$tx.observe(this.el,c,a[c].bind(this),true)}},getPanel:function(a){var c=((a.initializedId)?a.initializedId:"");return $must("tx_canvas_text"+c,"Trex.Canvas.TextPanel")},getHolder:function(a){var c=((a.initializedId)?a.initializedId:"");return $must("tx_canvas_text_holder"+c,"Trex.Canvas.TextPanel")},show:function(){this.$super.show();var c=this.el;var a=this.elHolder;setTimeout(function(){c.focus();if($tx.msie&&$tx.msie_ver<7){a.style.padding="1px";setTimeout(function(){a.style.padding="0px"},0)}},100)},getContent:function(){return this.el.value},setContent:function(a){this.el.value=a},getPanelHeight:function(){return($tom.getHeight(this.el).parsePx()+2).toPx()},setPanelHeight:function(a){this.$super.setPanelHeight((a.parsePx()-2).toPx())}});Trex.module("interrupt enter key action @ text panel",function(d,h,j,c,a){var e=c.config.newlinepolicy;var k=c.config.insertbr;if(e=="br"&&k){c.observeJob(Trex.Ev.__CANVAS_SOURCE_PANEL_KEYDOWN,function(l){if(c.canHTML()){return}c.getProcessor().controlEnter(l)
})}});Trex.I.Marker={};Trex.I.Marker.Standard={paste:function(){var a=this.processor.getRange();var h=this.endMarker=this.processor.create("span",{id:"tx_end_marker"});var k=a.endContainer;var c=a.endOffset;if(k.nodeType==3){k.splitText(c);k.parentNode.insertBefore(h,k.nextSibling)}else{k.insertBefore(h,k.childNodes[c])}var j=this.startMarker=this.processor.create("span",{id:"tx_start_marker"});var e=a.startContainer;var d=a.startOffset;if(e.nodeType==3){e.splitText(d);e.parentNode.insertBefore(j,e.nextSibling)}else{e.insertBefore(j,e.childNodes[d])}},remove:function(){$tom.remove(this.startMarker);$tom.remove(this.endMarker)}};Trex.I.Marker.Trident={paste:function(){this.clear();var c=this.processor.getRange();var a=this.processor.doc.body;var e=c.duplicate();e.collapse(true);e.pasteHTML('<span id="tx_start_marker"></span>');this.startMarker=$tom.collect(a,"#tx_start_marker");var d=c.duplicate();d.collapse(false);d.pasteHTML('<span id="tx_end_marker"></span>');this.endMarker=$tom.collect(a,"#tx_end_marker")
},clear:function(){var a=this.processor.doc.body;$tom.remove($tom.collect(a,"#tx_start_marker"));$tom.remove($tom.collect(a,"#tx_end_marker"))},remove:function(){$tom.remove(this.startMarker);$tom.remove(this.endMarker)}};Trex.Canvas.Marker=Trex.Class.create({$mixins:[(($tx.msie)?Trex.I.Marker.Trident:Trex.I.Marker.Standard)],initialize:function(a){this.processor=a},backup:function(){this.processor.bookmarkWithMarker(this)},checkCollapsed:function(){return($tom.next(this.startMarker)==this.endMarker)}});Trex.I.Selection={};Trex.I.Selection.Standard={getSel:function(){return this.win.getSelection()},getText:function(){return this.getSel().toString()},getNode:function(){var a=this.getRange();if(a){var c=a.startContainer;if(c.nodeType==1){if($tom.isBody(c)){return(c)}else{return(c.childNodes[a.startOffset])}}else{return(c.parentNode)}}else{return null}},createRange:function(){return this.doc.createRange()},createTextRange:function(){return this.doc.createRange()},getRange:function(d){var c=this.getSel();
if(c&&c.rangeCount>0){if(d==null){if(c.rangeCount==1){return c.getRangeAt(0)}else{return this.mergeRange(c)}}else{var a=c.getRangeAt(0);a.collapse(d);return a}}else{return this.doc.createRange()}},isCollapsed:function(){var a=this.getSel();return(a&&a.isCollapsed)},collapse:function(c){var d=this.getSel();if(d&&d.rangeCount>0){var a=d.getRangeAt(0);a.collapse(c)}},getControl:function(){var c=this.getSel();if(c.isCollapsed){return null}var a=c.anchorNode.childNodes[c.anchorOffset];if($tom.kindOf(a,"%control")){return a}else{return null}},hasControl:function(){return(this.getControl()!=null)},selectControl:function(c){var a=this.createRange();a.selectNode(c);var d=this.getSel();d.removeAllRanges();d.addRange(a)},compareTextPos:function(){var a=this.getRange();if(a){var c=a.startContainer;if(c.nodeType==3){if(a.startOffset==0){return $tom.__POSITION.__START_OF_TEXT}else{if(a.startOffset==c.textContent.length){return $tom.__POSITION.__END_OF_TEXT}else{return $tom.__POSITION.__MIDDLE_OF_TEXT
}}}}return $tom.__POSITION.__END_OF_TEXT},mergeRange:function(j){try{var h=[];for(var d=0,m=j.rangeCount;d<m;d++){h.push(j.getRangeAt(d))}j.removeAllRanges();var c=h[0].startContainer.childNodes[h[0].startOffset];var l=h[m-1].endContainer.childNodes[h[m-1].endOffset-1];var a=this.doc.createRange();try{a.setStart(c,0)}catch(k){a.collapse(true)}try{a.setEnd(l,l.childNodes.length)}catch(k){}j.addRange(a);return j.getRangeAt(0)}catch(k){return j.getRangeAt(0)}},setStart:function(a,c,h){try{a.setStart(c,h)}catch(d){a.collapse(true);a.setStart(c,h)}},setEnd:function(a,c,h){try{a.setEnd(c,h)}catch(d){a.collapse(false);a.setEnd(c,h)}},selectRange:function(a){var c=this.getSel();c.removeAllRanges();c.addRange(a);return c}};Trex.I.Selection.Trident={getSel:function(){return this.doc.selection},getText:function(){return this.getSel().createRange().text},getNode:function(){var c=this.getSel();var a=c.type.toLowerCase();if(a==="control"){return(c.createRange().item(0))}else{return(c.createRange().parentElement())
}},createRange:function(){var a=this.getSel();return a.createRange()},createTextRange:function(){return this.doc.body.createTextRange()},getRange:function(e){var d=this.getSel();var c=d.type.toLowerCase();if(c=="none"){return d.createRange()?d.createRange():function(){var h=this.doc.body.createTextRange();h.collapse(true);h.select();return h}()}if(e==null){return d.createRange()}else{if(c==="text"){var a=d.createRange();a.collapse(e);a.select();return d.createRange()}else{if(c==="control"){d.empty()}return d.createRange()}}},isCollapsed:function(){var d=this.getSel();var c=d.type.toLowerCase();if(c==="none"){return true}else{if(c==="control"){return true}else{if(c==="text"){var a=d.createRange();if(a&&a.htmlText){return(a.htmlText.length==0)}else{return true}}else{return true}}}},collapse:function(d){var e=this.getSel();var c=e.type.toLowerCase();if(c==="text"){var a=e.createRange();a.collapse(d);a.select();return e.createRange()}else{if(c==="control"){e.empty()}return e.createRange()}},getControl:function(){var d=this.getSel();
var a=d.type.toLowerCase();if(a==="control"){var c=d.createRange().item(0);if($tom.kindOf(c,"%control")){return c}else{return null}}else{return null}},hasControl:function(){var c=this.getSel();var a=c.type.toLowerCase();if(a==="control"){return true}else{return false}},selectControl:function(c){var a=this.doc.body.createControlRange();a.add(c);a.select()},compareTextPos:function(){var d=this.getSel();var c=d.type.toLowerCase();if(c==="none"){var a=d.createRange();var e=a.duplicate();e.moveToElementText(a.parentElement());if(a.compareEndPoints("StartToStart",e)==0){return $tom.__POSITION.__START_OF_TEXT}else{if(a.compareEndPoints("EndToEnd",e)==0){return $tom.__POSITION.__END_OF_TEXT}else{return $tom.__POSITION.__MIDDLE_OF_TEXT}}}return $tom.__POSITION.__END_OF_TEXT},transTextRange:function(a,h,j,d){var e=this.createTextRange();var c=this.win.span("\ufeff");$tom.insertAt(c,h);e.moveToElementText(c);$tom.remove(c);e.collapse(true);e.moveStart("character",j);if(d){a.setEndPoint("StartToStart",e)
}else{a.setEndPoint("EndToEnd",e)}return a},setStart:function(a,c,h){try{this.transTextRange(a,c,h,true)}catch(d){console.log(d)}return a},setEnd:function(a,c,h){try{this.transTextRange(a,c,h,false)}catch(d){console.log(d)}return a},selectRange:function(a){a.select()}};Trex.I.Selection.Gecko={};Trex.I.Selection.Webkit={getControl:function(){var e=this.getSel();if(e.isCollapsed){return null}if($tom.isElement(e.anchorNode)){var d=e.anchorNode.childNodes[e.anchorOffset];if($tom.kindOf(d,"%control")){return d}else{return null}}var c=$tom.previous(e.focusNode);var a=$tom.next(e.anchorNode);if(c==a){return $tom.first(c,"%control")}else{return null}},selectControl:function(c){var a=this.createRange();a.selectNode(c);var d=this.getSel();d.removeAllRanges();d.addRange(a)}};Trex.I.Selection.Presto={};Trex.Canvas.Selection=Trex.Class.create({$mixins:[Trex.I.Selection.Standard,(($tx.msie)?Trex.I.Selection.Trident:{}),(($tx.gecko)?Trex.I.Selection.Gecko:{}),(($tx.webkit)?Trex.I.Selection.Webkit:{}),(($tx.presto)?Trex.I.Selection.Presto:{})],initialize:function(a){this.processor=a;
this.win=a.win;this.doc=a.doc}});Trex.Canvas.Bookmark=Trex.Class.create({startContainer:null,startOffset:0,endContainer:null,endOffset:0,initialize:function(a){this.processor=a;this.win=a.win;this.doc=a.doc;this.dummy=function(){return a.newDummy()}},collapse:function(a){if(a){this.updateEnd(this.startContainer,this.startOffset)}else{this.updateStart(this.endContainer,this.endOffset)}},save:function(a){this.updateStart(a.startContainer,a.startOffset);this.updateEnd(a.endContainer,a.endOffset)},saveAroundNode:function(a){this.updateStartBefore($tom.top(a));this.updateEndAfter($tom.bottom(a))},saveIntoFirst:function(c){var a=$tom.top(c);this.updateEndBefore(a);this.collapse(false)},saveIntoLast:function(c){var a=$tom.bottom(c);this.updateEndBefore(a);this.collapse(false)},savePreviousTo:function(c){if($tom.previous(c)){var a=$tom.top($tom.previous(c));this.updateEndAfter(a)}else{this.updateEndBefore(c)}this.collapse(false)},saveNextTo:function(c){if($tom.next(c)){var a=$tom.top($tom.next(c));
this.updateEndBefore(a)}else{this.updateEndAfter(c)}this.collapse(false)},saveWithMarker:function(a){if(a.checkCollapsed()){this.updateEndAfter(a.endMarker);this.collapse(false)}else{this.updateStartBefore(a.startMarker);this.updateEndAfter(a.endMarker)}},select:function(d){if(this.startContainer&&this.endContainer){var a=d.createTextRange();try{d.setStart(a,this.startContainer,this.startOffset);d.setEnd(a,this.endContainer,this.endOffset)}catch(c){console.log(c)}d.selectRange(a)}this.reset()},updateStart:function(a,c){this.startContainer=a;this.startOffset=c},updateStartBefore:function(c){var a=this.dummy();$tom.insertAt(a,c);this.startContainer=a;this.startOffset=0},updateStartAfter:function(c){var a=this.dummy();$tom.insertNext(a,c);this.startContainer=a;this.startOffset=0},updateEnd:function(a,c){this.endContainer=a;this.endOffset=c},updateEndBefore:function(c){var a=this.dummy();$tom.insertAt(a,c);this.endContainer=a;this.endOffset=0},updateEndAfter:function(c){var a=this.dummy();$tom.insertNext(a,c);
this.endContainer=a;this.endOffset=0},reset:function(){this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0}});Trex.Canvas.TextAreaProcessor=Trex.Class.create({$mixins:[],initialize:function(a){this.el=a},focus:function(){this.el.focus()},blur:function(){window.focus()},savePosition:function(){if(this.el.createTextRange){this.currentPos=document.selection.createRange().duplicate()}},controlEnter:function(c){var a=this;a.insertTag("<br/>","")},insertTag:function(h,m){var k=this.el;var l=$tx.webkit?window.getSelection:document.selection;if(l){if(l.createRange){var j=this.currentPos;j.text=h+j.text+m;this.savePosition(k);k.focus()}else{k.value=k.value+h+m}}else{if(k.selectionStart){var c=k.value.substr(0,k.selectionStart);var l=k.value.substr(k.selectionStart,k.selectionEnd-k.selectionStart);var e=k.value.substr(k.selectionEnd);var d=k.selectionStart;var a=k.scrollTop;k.value=c+h+l+m+e;if(k.setSelectionRange){if(l.length==0){k.setSelectionRange(d+h.length,d+h.length)
}else{k.setSelectionRange(d,d+h.length+l.length+m.length)}k.focus()}k.scrollTop=a}else{k.value+=h+m;k.focus(k.value.length-1)}}return true}});Trex.I.Processor={};Trex.I.Processor.Standard={txSelection:null,initialize:function(c,a){this.win=c;this.doc=a;this.txSelection=new Trex.Canvas.Selection(this);this.bookmark=new Trex.Canvas.Bookmark(this)},getTxSel:function(){return this.txSelection},getSel:function(){return this.txSelection.getSel()},getRange:function(){return this.txSelection.getRange()},getBookmark:function(){return this.bookmark},isCollapsed:function(){return this.txSelection.isCollapsed()},getNode:function(){return this.txSelection.getNode()},getControl:function(){return this.txSelection.getControl()},hasControl:function(){return this.txSelection.hasControl()},selectControl:function(a){return this.txSelection.selectControl(a)},getText:function(){return this.txSelection.getText()},compareTextPos:function(){return this.txSelection.compareTextPos()},findNode:function(a){try{return $tom.find(this.getNode(),a)
}catch(c){return null}},queryStyle:function(d,c){if(!d){return null}c=((c=="float")?((d.style.styleFloat===undefined)?"cssFloat":"styleFloat"):c);if(d.style&&d.style[c]){return d.style[c]}else{if(d.currentStyle&&d.currentStyle[c]){return d.currentStyle[c]}else{if(window.getComputedStyle){var a=this.doc.defaultView.getComputedStyle(d,null);return((a)?a[c]:null)}}}return null},queryAttr:function(c,a){if(!c){return null}return $tom.getAttribute(c,a)},queryCommandState:function(c){try{return this.doc.queryCommandState(c)}catch(a){return false}},execCommand:function(d,a){try{this.doc.execCommand(d,false,a)}catch(c){}},execWithMarker:function(c){var a=new Trex.Canvas.Marker(this);this.bookmarkTo();try{a.paste();a.backup();c(a)}catch(d){console.log(d)}finally{a.remove()}},focus:function(){this.win.focus()},blur:function(){window.focus()},focusOnTop:function(){this.win.focus();this.moveCaretTo(this.doc.body,true);this.doc.body.scrollTop=0},focusOnBottom:function(){this.win.focus();this.moveCaretTo(this.doc.body,false);
this.doc.body.scrollTop=this.doc.body.scrollHeight},moveCaretTo:function(c,a){if(!c){return}this.bookmarkInto(c,a);this.bookmark.select(this.txSelection)},moveCaretWith:function(c){if(!c){return}var a=this.findNode(c);if(a){this.bookmark.saveNextTo(a);this.bookmark.select(this.txSelection)}},selectAround:function(a){if(!a){return}this.bookmark.saveAroundNode(a);this.bookmark.select(this.txSelection)},bookmarkInto:function(c,a){if(!c){return}a=(a==null)?true:a;if(a){this.bookmark.saveIntoFirst(c)}else{this.bookmark.saveIntoLast(c)}},bookmarkToPrevious:function(a){if(!a){return}this.bookmark.savePreviousTo(a)},bookmarkToNext:function(a){if(!a){return}this.bookmark.saveNextTo(a)},bookmarkTo:function(a){a=a||this.txSelection.getRange();this.bookmark.save({startContainer:a.startContainer,startOffset:a.startOffset,endContainer:a.endContainer,endOffset:a.endOffset})},bookmarkWithMarker:function(a){this.bookmark.saveWithMarker(a)},restore:function(){this.bookmark.select(this.txSelection)},create:function(){var c=$A(arguments),a=c.shift();
var d=this.newNode(a);each(c,function(e){if(e.nodeType){$tom.append(d,e)}else{if(typeof(e)=="string"||typeof(e)=="number"){d.innerHTML+=e}else{if(typeof(e)=="array"){for(var h=0;h<e.length;h++){$tom.append(d,e[h])}}else{$tom.applyAttributes(d,e)}}}});return d},pasteNode:function(j,h,l){if(!j){return}if(!j.length){j=[].concat(j)}this.txSelection.collapse(false);var e=this.txSelection.getRange();if(h){var d,c,a;var k=this;this.execWithMarker(function(m){d=$tom.find(m.endMarker,"p,li,dd,dt,h1,h2,h3,h4,h5,h6");if(d){a=$tom.divideParagraph(m.endMarker)}else{a=k.newNode("p");$tom.insertAt(a,m.endMarker)}});if(d){c=$tom.clone(a)}else{c=this.newNode("p")}$tom.insertAt(c,a);j.each(function(m){$tom.append(c,m)});if(l){$tom.applyAttributes(c,l)}if(d){if(!$tom.hasData(d)){$tom.remove(d)}}this.stuffNode(a);this.bookmark.saveIntoFirst(a)}else{this.execWithMarker(function(m){j.each(function(n){$tom.insertNext(n,m.endMarker)})})}return j[0]},pasteContent:function(d,c,h){var a=this.create("div");a.innerHTML=d;
var e=$tom.children(a);return this.pasteNode(e,c,h)},replace:function(d,a,c){this.bookmark.saveAroundNode(d);return $tom.replace(d,this.create(a,c))},blocks:function(e){var j=[];var a=this.getRange();var h=e();if(this.hasControl()){var d=this.getControl();if($tom.kindOf(d.parentNode,h)){j.push(d.parentNode)}}else{var c=this;this.execWithMarker(function(k){var m=c.getBlockRangeIterator(h,k.startMarker,k.endMarker);var l;while(m.hasNext()){l=m.next();if($tom.kindOf(l,"#tx_start_marker,#tx_end_marker")){}else{j.push(l)}}})}return j},inlines:function(h){var l=[];var c=this.getRange();var j=h();var e=this;var k=function(){return e.create($tom.inlineOf())};if(this.hasControl()){var d=this.getControl();if($tom.kindOf(d,j)){l.push(d)}else{var a=k();$tom.insertNext(a,d);$tom.append(a,d)}}else{this.execWithMarker(function(n){if(n.checkCollapsed()){var m=k();$tom.append(m,e.newDummy());$tom.insertNext(m,n.startMarker);e.bookmarkTo({startContainer:m,startOffset:1,endContainer:m,endOffset:1});l.push(m)
}else{var p=e.getInlineRangeIterator(j,n.startMarker,n.endMarker);var o;while(p.hasNext()){o=p.next();if($tom.kindOf(o,"#tx_start_marker,#tx_end_marker")){}else{if($tom.kindOf(o,"br")){}else{l.push(o)}}}}})}return l},controls:function(c){var d=[];var a=this.getRange();if(this.hasControl()){if($tom.kindOf(this.getControl(),c())){d.push(this.getControl())}}return d},apply:function(c,a){if(!c){return null}if(!c.length){c=[].concat(c)}c.each(function(d){$tom.applyAttributes(d,a)});return c},wrap:function(d,a,c){if(!d){return null}if(!d.length){d=[].concat(d)}c=c||{};return $tom.wrap(this.create(a,c),d)},unwrap:function(a){if(!a){return}this.bookmark.saveAroundNode(a);return $tom.unwrap(a)}};Trex.module("observe that @when control elements are focused at",function(d,e,h,c,a){if($tx.webkit||$tx.presto){c.observeJob(Trex.Ev.__CANVAS_PANEL_MOUSEDOWN,function(l){var k=c.getProcessor();var j=$tx.element(l);if($tom.kindOf(j,"img,hr,iframe,table")){var k=c.getProcessor();var m=$tom.find(j,"button");
if(m){k.selectControl(m)}else{k.selectControl(j)}}else{if($tom.kindOf(j,"button")){k.selectControl(j)}}})}});Trex.I.Processor.Trident={stuffNode:function(a){return $tom.stuff(a,this.newText(" "))},controlEnterByParagraph:function(d){var c=this.findNode("div");if(!c){throw $propagate}var e=this.findNode("%paragraph");if($tom.kindOf(e,"p")){if($tom.first(c,"p")==e){var a;this.execWithMarker(function(h){a=$tom.divideParagraph(h.endMarker)});this.stuffNode(e);this.stuffNode(a);this.moveCaretTo(a)}else{throw $propagate}}else{if($tom.kindOf(e,"li,td,th,dd,dt")){throw $propagate}else{var a=this.newParagraph("p");this.execWithMarker(function(h){$tom.insertNext(a,h.endMarker)});this.moveCaretTo(a)}}},controlEnterByLinebreak:function(c){if(!!this.findNode("blockquote,div,p,strong,u,em,strike,span,font,td,body")){var a=this.getTxSel().getRange();a.pasteHTML("<br />\n");a.collapse(false);a.select()}}};Trex.module("delete image element @when backspace key event fires",function(d,e,h,c,a){if($tx.msie){c.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:Trex.__KEY.BACKSPACE},function(l){var k=c.getProcessor();
if(k.hasControl()&&k.getControl()){try{var j=k.getControl();$tom.remove(j)}catch(m){}throw $stop}})}});Trex.module("delete table element @when backspace key event fires",function(d,e,h,c,a){if($tx.msie){var j;c.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:Trex.__KEY.BACKSPACE},function(m){var l=c.getProcessor();var k=l.getRange();try{if(j==k.boundingLeft){var o=$tom.previous(l.getNode());if($tom.kindOf(o,"table")){$tom.remove(o)}}}catch(n){}j=k.boundingLeft;throw $propagate})}});Object.extend(Trex.I.Processor.Trident,{lastRange:null,shouldHandleOnActivate:true,restoreRange:function(){if(!this.shouldHandleOnActivate){return}if(this.lastRange){try{this.lastRange.select()}catch(h){var d=this.getSel();var c=d.type.toLowerCase();if(c==="control"){d.empty();var a=d.createRange();a.collapse(false);a.select()}}finally{this.lastRange=null}}}});Trex.module("bind iframe activate or deactivate event",function(d,e,h,c,a){if($tx.msie){c.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(j){var k=c.getProcessor();
$tx.observe(j,"beforedeactivate",function(n){var l=n.toElement;if(l){k.shouldHandleOnActivate=false;k.lastRange=null}else{var m=$tx.element(n);if(!m||!$tom.isElement(m)){return}k.shouldHandleOnActivate=!$tom.kindOf(m,"iframe,object");k.lastRange=k.getRange()}});$tx.observe(j,"activate",function(l){k.lastRange=null})})}});Trex.I.Processor.Gecko={stuffNode:function(a){return $tom.stuff(a,this.newNode("br"))},controlEnterByParagraph:function(d){var c=this.findNode("li,td,th");if(c){throw $propagate}var h=this.findNode("button");if(h){this.moveCaretTo($tom.next(h));throw $propagate}var a;this.getTxSel().collapse(false);var e=this.findNode("%paragraph");if(e){this.execWithMarker(function(j){a=$tom.divideParagraph(j.endMarker)});this.stuffNode(e)}else{a=this.newParagraph("p");this.execWithMarker(function(j){$tom.insertAt(a,j.endMarker)})}this.stuffNode(a);this.restoreScrollTop(a);this.moveCaretTo(a)},controlEnterByLinebreak:function(a){throw $propagate}};Trex.I.Processor.Webkit={stuffNode:function(a){return $tom.stuff(a,this.newNode("br"))
},controlEnterByParagraph:function(d){var c=this.findNode("span");if(!c||!c.style.backgroundColor){throw $propagate}var e=this.findNode("%paragraph");var a;this.execWithMarker(function(h){a=$tom.divideParagraph(h.endMarker)});this.stuffNode(e);this.stuffNode(a);this.moveCaretTo(a)},controlEnterByLinebreak:function(e){var d=this;var c=this.getRange(false);var j=c.endContainer.parentNode;if(j&&(j.tagName=="P"||j.tagName=="DIV"||j.tagName=="BODY"||j.tagName=="BLOCKQUOTE")){if(j.tagName=="BLOCKQUOTE"||$tx.hasClassName(j,"txc-textbox")||$tx.hasClassName(j,"txc-moreless")){$tx.stop(e);var a=d.win.br();c.insertNode(a);c.selectNode(a);c.collapse(false);a=d.win.br();c.insertNode(a);c.selectNode(a);c.collapse(false);var c=d.getRange(false);c.selectNodeContents(a.nextSibling);var h=d.getSel();h.removeAllRanges();h.addRange(c);h.collapseToStart()}}}};Trex.I.Processor.Presto={stuffNode:function(a){return $tom.stuff(a,this.newNode("br"))}};Trex.I.Processor.StandardP={putBogusParagraph:function(){var d=this.doc.body;
var c=$tom.last(d);if(c&&$tom.kindOf(c,"p")){return}var a=this.newParagraph("p");if($tom.kindOf(c,"br")){$tom.replace(c,a)}else{$tom.append(d,a)}}};Trex.module("put bogus paragraph @when any key event fires",function(d,e,h,c,a){if($tx.msie){return}if(c.config.newlinepolicy=="p"){c.reserveJob(Trex.Ev.__CANVAS_PANEL_KEYUP,function(k){if(!c.canHTML()){return}var j=c.getProcessor();j.putBogusParagraph()},10)}});Trex.I.Processor.TridentP={};Trex.I.Processor.GeckoP={restoreScrollTop:function(c){if(!c){return}if(this.win.innerHeight<this.doc.documentElement.offsetHeight){var a=document.documentElement.scrollTop;$tom.goInto(c,false);document.documentElement.scrollTop=a}}};Trex.I.Processor.WebkitP={};Trex.I.Processor.PrestoP={};var Split=function(){this.initialize.apply(this,arguments)};Split.prototype={initialize:function(a,c){this.root=a;this.clonePolicy=c.clonePolicy?c.clonePolicy:"backend";this.target=c.target?c.target:null;this.filter=c.filter?c.filter:true},run:function(){return this.split(this.target)
},split:function(e){var d=e;var a=d.parentNode;if(a.nodeName=="BODY"){return}if(!this.filter(d)){return d}var h;if(a&&a!==this.root){h=a.cloneNode(false);if(this.clonePolicy=="backend"){do{var c=d.nextSibling;h.appendChild(d);var d=c}while(d);if(a.nextSibling){a.parentNode.insertBefore(h,a.nextSibling)}else{a.parentNode.appendChild(h)}this.split(h)}else{if(this.clonePolicy=="frontend"){do{var c=d.previousSibling;if(!h.firstChild){h.appendChild(d)}else{h.insertBefore(d,h.firstChild)}d=c}while(d);a.parentNode.insertBefore(h,a);this.split(h)}}}else{}return h}};Trex.I.Processor.StandardBR={expand:function(a){this.moveStartElement(a.beforeStart);this.moveEndElement(a.afterEnd)},moveStartElement:function(e){var c,a;var d=["P","DIV","OL","UL","LI","BLOCKQUOTE","TABLE","TR","TD","BODY"];this.walkBetweenNodesDesc(e,this.doc.body.firstChild,function(j){a=j;if(!c){if(j.nodeType!=1){return}if(j.nodeName=="BR"){c=j}else{var h=d.detect(function(k){if(k==j.nodeName){c=j;return true}return false})}}});
if(!c){c=a.parentNode}if(c.nodeName=="BR"){if(c.nextSibling){c.parentNode.insertBefore(e,c.nextSibling)}else{c.parentNode.appendChild(e)}}else{if(this.isParentOf(e,c)){c.insertBefore(e,c.firstChild)}else{c.parentNode.insertBefore(e,c.nextSibling)}}},moveEndElement:function(a){var d,c;var e=["P","DIV","OL","UL","LI","BLOCKQUOTE","TABLE","TR","TD","BODY"];this.walkBetweenNodes2(a,this.doc.body.lastChild,function(h){c=h;if(!d){if(h.nodeType!=1){return}if(h.nodeName=="BR"){d=h}else{e.detect(function(j){if(j==h.nodeName){d=h;return true}return false})}}});if(!d){d=c||a.parentNode.lastChild}if(d.nodeName=="BR"){if(d.nextSibling){d.parentNode.insertBefore(a,d.nextSibling)}else{d.parentNode.appendChild(a)}}else{if(this.isParentOf(a,d)){d.appendChild(a)}else{d.parentNode.insertBefore(a,d)}}},findSameParent:function(e,c){var d;var h=[e];var a=e;while(a.nodeName!="BODY"){a=a.parentNode;h.push(a)}a=c;while(a.nodeName!="BODY"){for(var j=0;j<h.length;j++){if(h[j]===a){d=h[j];break}}a=a.parentNode}R;return(d||this.doc.body)
},hasSameTagName:function(c){var a;for(var e=0;e<c.length;e++){var d=c[e];if(!a){a=d.tagName}else{if(a!=d.tagName){return false}}}return a},collectTextNodesBetweenMarkers:function(d,a){var c=[];this.walkBetweenNodes(d,a,function(e){if(e.nodeType==3){if(!e.nodeValue.match(new RegExp("^[s\t\n]+$"))){c.push(e)}}else{if($tom.kindOf(e,"img")){c.push(e)}}});return c},walkBetweenNodes2:function(c,a,h){var e=0;var d=1;var k=c,j=d;var l=function(n,m){k=n;j=m;h(k)};if(c===a){h(c)}else{do{if(k.firstChild&&j!=e){l(k.firstChild,d)}else{if(k.nextSibling){l(k.nextSibling,d)}else{if(k.parentNode){l(k.parentNode,e)}}}}while(k!=a)}},walkBetweenNodes:function(c,a,h){var e=0;var d=1;var k=c,j=d;var l=function(n,m){k=n;j=m;if(j==d){h(k)}};if(c===a){h(c)}else{do{if(k.firstChild&&j!=e){l(k.firstChild,d)}else{if(k.nextSibling){l(k.nextSibling,d)}else{if(k.parentNode){l(k.parentNode,e)}}}}while(k!=a)}},walkBetweenNodesDesc:function(c,a,h){var e=0;var d=1;var k=c,j=d;var l=function(n,m){k=n;j=m;h(k)};if(c===a){h(c)
}else{do{if(k.lastChild&&j!=e){l(k.lastChild,d)}else{if(k.previousSibling){l(k.previousSibling,d)}else{if(k.parentNode){l(k.parentNode,e)}}}}while(k!=a)}},exec:function(d,c){try{var a=this.getTxRange(this.getRange());if(c){this.expand(a)}var e=this.tidy(a);if(d){d(e)}}finally{this.clean()}},groupInlineElementsWith:function(c,a,e){if(a===e){return[a]}else{if(a.nextSibling===e){return[a,e]}}var l=[];var d=this.doc.createElement(c);var n=a.nodeName;var h=e.nodeName;var m=false;var k=a;do{if(k.nodeType==1&&(k.nodeName=="UL"||k.nodeName=="OL"||k.nodeName=="TABLE"||k.nodeName=="TR"||k.nodeName=="DIV"||k.nodeName=="P")){if(!m){l.push(k)}if(d.hasChildNodes()){k.parentNode.insertBefore(d,k);l.push(d);d=this.doc.createElement("div")}}else{if(k.nodeName=="LI"||k.nodeName=="TD"){l.push(k)}else{var j=k.previousSibling;d.appendChild(k);k=j}}if(k.nextSibling){k=k.nextSibling;m=false}else{k=k.parentNode;m=true}if(n=="TD"&&(k.nodeName=="TD"||k.nodeName=="TR"||k.nodeName=="TH"||k.nodeName=="TABLE")){}else{if(n=="LI"&&(k.nodeName=="LI"||k.nodeName=="OL"||k.nodeName=="UL")){}else{if(n=="P"||n=="DIV"){if(k.nodeType==3){}else{if(k.nodeName=="TABLE"||k.nodeName=="OL"||k.nodeName=="UL"){if(h=="LI"||h=="TD"){l.push(k);
break}}}}else{break}}}if(k===e){l.push(k);break}else{if(k.nodeName=="BODY"){break}}}while(true);return l},tidy:function(j){var e=function(n){return["P","UL","OL","TABLE","DIV"].detect(function(o){if(n.nodeType==1&&o==n.nodeName){if(o=="DIV"){if(n.className=="txc-textbox"||n.className=="txc-moreless"){return false}}return true}else{return false}})};var m=function(o){var n=o.parentNode;if(n.nodeName=="BODY"){return false}else{if(n.nodeName=="UL"||n.nodeName=="OL"){return false}else{if(n.nodeName=="TBODY"||n.nodeName=="TD"||n.nodeName=="TR"||n.nodeName=="TABLE"){return false}else{if(n.className=="txc-textbox"||n.className=="txc-moreless"){return false}}}}return true};var a,d;var h=j.beforeStart;var c=j.afterEnd;if(h.parentNode.nodeName=="BODY"||h.parentNode.className=="txc-textbox"||h.parentNode.className=="txc-moreless"){var l=this.doc.createElement("div");h.parentNode.insertBefore(l,h);var k=h;while(true){if(!k){break}if(e(k)){break}l.appendChild(k);k=l.nextSibling}a=l}else{a=new Split(this.doc.body,{clonePolicy:"frontend",target:h,filter:m}).run();
if(a.nodeName=="LI"||a.nodeName=="UL"||a.nodeName=="OL"){a=a.nextSibling}else{while(!(a.parentNode.nodeName=="BODY"||a.parentNode.className=="txc-textbox"||a.parentNode.className=="txc-moreless")){a=a.parentNode}a=a.nextSibling}}if(c.parentNode.nodeName=="BODY"){var l=this.doc.createElement("div");if(c.nextSibling){c.parentNode.insertBefore(l,c.nextSibling)}else{c.parentNode.appendChild(l)}var k=c;while(true){if(!k){break}if(e(k)){break}if(l.hasChildNodes()){l.insertBefore(k,l.firstChild)}else{l.appendChild(k)}k=l.previousSibling}d=l}else{d=new Split(this.doc.body,{clonePolicy:"backend",target:c,filter:m}).run();if(d.nodeName=="LI"||d.nodeName=="UL"||d.nodeName=="OL"){d=d.previousSibling}else{while(!(d.parentNode.nodeName=="BODY"||d.parentNode.className=="txc-textbox"||d.parentNode.className=="txc-moreless")){d=d.parentNode}d=d.previousSibling}}return{startElement:a,endElement:d}},clean:function(){var d=this.doc.getElementById("tx_beforestart_mark");if(d){var e=d.parentNode;if(e.childNodes.length==1){e.parentNode.removeChild(e)
}else{d.parentNode.removeChild(d)}}var a=this.doc.getElementById("tx_afterend_mark");if(a){if(a.parentNode.childNodes.length!=1){a.parentNode.removeChild(a)}else{var h=a;var e=h.parentNode;while(true){if(e.childNodes.length==1){h=e;e=e.parentNode}else{break}}h.parentNode.removeChild(h)}}},isParentOf:function(e,d){var a=e.parentNode;var c=false;while(a){if(a===d){c=true;break}a=a.parentNode}return c},applyAttributesGroupByParagraph:function(c){var a=this;this.exec(function(j){var d=a.groupInlineElementsWith("div",j.startElement,j.endElement);d.each(function(e){$tom.applyAttributes(e,c)});try{a.selectNodes(d)}catch(h){}},true)},wrapInBlock:function(c,a){this.wrapWith(c,a,false)},wrapWith:function(c,a,e){var l=e?e:false;var d=this.getRange();var k;if($tx.msie){try{k=this.win[c](a);k.setAttribute("id","tmp_wrapped_item");k.innerHTML=d.htmlText!=""?d.htmlText+"<br />":"<br />";d.pasteHTML(k.outerHTML);d.select();if(l){d.collapse(false)}k=this.doc.getElementById("tmp_wrapped_item");k.removeAttribute("id")
}finally{var j=this.doc.getElementById("tmp_wrapped_item");if(j){j.removeAttribute("id")}}}else{var h=d.extractContents();if(h.childNodes.length==0||h.childNodes[0].nodeValue==""){h=this.win.br()}k=this.win[c](a,h);d.insertNode(k);d.selectNode(k);if(l){d.collapse(false)}}this.moveCaretTo(k);return true},wrapInList:function(c,a){var d=this.win[c](a?a:{});this.wrapEachLineWith(d,"li",{})},wrapEachLineWith:function(d,l,c){var e=this.getRange();var a=this;var k;if($tx.msie){try{k=a.win[l](c);k.setAttribute("id","tmp_wrapped_item");k.innerHTML=e.htmlText;d.appendChild(k);e.pasteHTML(d.outerHTML);e.select();e.collapse(false);k=this.doc.getElementById("tmp_wrapped_item");k.removeAttribute("id")}finally{var j=this.doc.getElementById("tmp_wrapped_item");if(j){j.removeAttribute("id")}}}else{var h=e.extractContents();if(h.childNodes.length==0||h.childNodes[0].nodeValue==""){h=this.win.br()}k=this.win[l](c,h);d.appendChild(k);e.insertNode(d);e.selectNode(d);e.collapse(false)}this.moveCaretTo(k)},pasteContent:function(a,c){this.paste(a);
if(c){this.paste("<br />")}},pasteNode:function(a,d){var c=this.win.div();c.appendChild(a);this.paste(c.innerHTML);if(d){this.paste("<br />")}c=null},paste:function(j){var m=this.getRange();if($tx.msie){var n=j?j:"<br />";m.pasteHTML(n);m.select();m.collapse(false)}else{var h=this.win.div();h.innerHTML=j;m.extractContents();var o=null;for(var c=0,d=h.childNodes.length-1;d>=c;d--){var k=h.childNodes[d];if(k){if(!o){o=k}m.insertNode(k)}}m.selectNode(o);m.collapse(false);h=null;o=null}var a=this.doc.getElementById("new_object");return a},selectNodes:function(d){if(d.length==0){return}else{if(d.length==1){var h=d[0];if(this.hasControl()){var j=this.win.span("\ufeff");$tom.insertAt(j,h);var a=this.doc.body.createTextRange();a.moveToElementText(j);a.collapse(true);$tom.remove(j);a.select()}var c=this.getRange();c.setEndPoint("EndToEnd",this.getPointedEndRange(h,"<node>text^</node>"));try{c.setEndPoint("StartToStart",this.getPointedStartRange(h,"<node>^text</node>"))}catch(k){c.setEndPoint("StartToStart",this.getPointedStartRange(h,"^<node>text</node>"))
}c.select()}else{var c=this.getRange();c.setEndPoint("EndToEnd",this.getPointedEndRange(d[d.length-1],"<node>text^</node>"));c.setEndPoint("StartToStart",this.getPointedStartRange(d[0],"<node>^text</node>"));c.select()}}},getPointedStartRange:function(h,e){var c=this.getRange();var a=this.win.span("\ufeff");if(e=="<node>^text</node>"){$tom.insertAt(a,h.firstChild);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(false);if(c.compareEndPoints("EndToStart",d)==-1){c.setEndPoint("EndToStart",d)}c.setEndPoint("StartToStart",d)}else{if(e=="<node>text^</node>"){$tom.append(h,a);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(true);if(c.compareEndPoints("EndToEnd",d)==-1){c.setEndPoint("EndToEnd",d)}c.setEndPoint("StartToEnd",d)}else{if(e=="^<node>text</node>"){$tom.insertAt(a,h);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(true);if(c.compareEndPoints("EndToStart",d)==-1){c.setEndPoint("EndToStart",d)}c.setEndPoint("StartToStart",d)
}else{if(e=="^<node>text</node>"){$tom.insertNext(a,h);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(false);if(c.compareEndPoints("EndToEnd",d)==-1){c.setEndPoint("EndToEnd",d)}c.setEndPoint("StartToEnd",d)}}}}$tom.remove(a);return c},getPointedEndRange:function(h,e){var c=this.getRange();var a=this.win.span("\ufeff");if(e=="<node>^text</node>"){$tom.insertAt(a,h.firstChild);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(true);if(c.compareEndPoints("StartToEnd",d)==1){c.setEndPoint("StartToEnd",d)}c.setEndPoint("EndToEnd",d)}else{if(e=="<node>text^</node>"){$tom.append(h,a);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(false);if(c.compareEndPoints("StartToEnd",d)==1){c.setEndPoint("StartToEnd",d)}c.setEndPoint("EndToEnd",d)}else{if(e=="^<node>text</node>"){$tom.insertAt(a,h);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(false);if(c.compareEndPoints("StartToEnd",d)==1){c.setEndPoint("StartToEnd",d)
}c.setEndPoint("EndToEnd",d)}else{if(e=="^<node>text</node>"){$tom.insertNext(a,h);var d=this.doc.body.createTextRange();d.moveToElementText(a);d.collapse(true);if(c.compareEndPoints("StartToEnd",d)==1){c.setEndPoint("StartToEnd",d)}c.setEndPoint("EndToEnd",d)}}}}$tom.remove(a);return c},getTxRange:function(d){var e=this.getSel();var d=this.getRange();var k=d.collapsed;var m=this.win.span({id:"tx_beforestart_mark"});var h=this.win.span({id:"tx_afterend_mark"});var c=d.startContainer;var j=d.startOffset;var a=d.endContainer;var l=d.endOffset;if(a.nodeType==3){a.splitText(l);a.parentNode.insertBefore(h,a.nextSibling)}else{a.insertBefore(h,a.childNodes[l])}if(c.nodeType==3){c.splitText(j);c.parentNode.insertBefore(m,c.nextSibling)}else{c.insertBefore(m,c.childNodes[j])}return{beforeStart:m,afterEnd:h,rng:d,collapsed:k}}};Trex.I.Processor.TridentBR={getTxRange:function(a){var j,c;var h=this.getSel();if(h.type=="Control"){_node=a.item(0);j=this.win.span({id:"tx_beforestart_mark"});c=this.win.span({id:"tx_afterend_mark"});
_node.parentNode.insertBefore(j,_node);if(_node.nextSibling){_node.parentNode.insertBefore(c,_node.nextSibling)}else{_node.parentNode.appendChild(_afterEnd)}}else{if(a.htmlText.length!=0){var l=a.duplicate();var k=a.duplicate();l.collapse(true);l.pasteHTML('<span id="tx_beforestart_mark"></span>');k.collapse(false);k.pasteHTML('<span id="tx_afterend_mark"></span>');j=this.doc.getElementById("tx_beforestart_mark");c=this.doc.getElementById("tx_afterend_mark")}else{var e=a.duplicate();e.collapse(false);e.pasteHTML('<span id="tx_beforestart_mark"></span><span id="tx_afterend_mark"></span>');j=this.doc.getElementById("tx_beforestart_mark");c=this.doc.getElementById("tx_afterend_mark")}var d=a.htmlText.length}return{beforeStart:j,afterEnd:c,rng:a,collapsed:(d==0?true:false)}}};Trex.I.Processor.GeckoBR={changeAlign:function(a){var c;switch(a.style.textAlign){case"left":c="justifyleft";break;case"center":c="justifycenter";break;case"right":c="justifyright";break;case"justify":c="justifyfull";break
}this.execCommand(c)}};Trex.I.Processor.WebkitBR={changeAlign:function(a){var c;switch(a.style.textAlign){case"left":c="justifyleft";break;case"center":c="justifycenter";break;case"right":c="justifyright";break;case"justify":c="justifyfull";break}this.execCommand(c)}};Trex.I.Processor.PrestoBR={};(function(){var a=Trex.Class.create({initialize:function(e,d,h,c){this.processor=e;this.start=h;this.end=c||this.start;this.current=this.start;this.wTranslator=$tom.translate(d).extract("%wrapper");this.pTranslator=$tom.translate(d).extract("%paragraph")},hasNext:function(){return !!this.current},next:function(){var d=this.current;d=this.find(d);var c=d;if($tom.include(d,this.end)){c=null}else{while(c&&!$tom.next(c)){c=$tom.parent(c);if($tom.isBody(c)){c=null}}if(c){c=$tom.next(c)}}if(c==this.end){c=null}this.current=c;return d},find:function(j){var e;var h=j;if(!$tom.hasContent(h)){return h}while(h){e=h;if($tom.isBody(h)){break}if($tom.kindOf(h,this.wTranslator.getExpression())){return h}if($tom.kindOf(h,"%wrapper,%outergroup")){h=$tom.descendant(e,this.pTranslator.getExpression());
if(h){return h}h=$tom.descendant(e,"%paragraph");if(h){e=h;break}}if($tom.kindOf(h,this.pTranslator.getExpression())){return h}h=h.parentNode}var d=$tom.paragraphOf($tom.getName(e));var k=this.processor.newNode(d);var c=$tom.extract(e,j,"%text,%inline,img,object,embed,hr");$tom.wrap(k,c);this.processor.stuffNode(k);return k}});Object.extend(Trex.I.Processor.Standard,{getBlockRangeIterator:function(d,e,c){return new a(this,d,e,c)}})})();(function(){var a=Trex.Class.create({initialize:function(e,d,h,c){this.processor=e;this.start=h;this.end=c||this.start;this.current=this.start;this.iTranslator=$tom.translate(d).extract("%inline")},hasNext:function(){return !!this.current},next:function(){var d=this.current;d=this.find(d);var c=d;if(d==this.end){c=null}else{while(c&&!$tom.next(c)){c=$tom.parent(c);if($tom.isBody(c)){c=null}}if(c){c=$tom.next(c)}}if($tom.include(c,this.end)){c=$tom.top(c,true)}this.current=c;return d},find:function(j){var h=j;if($tom.kindOf(h,"%paragraph,%outergroup,%block")||$tom.isBody(h)){var e=h;
h=$tom.top(e,true);if(!h){var d=$tom.inlineOf();var c=this.processor.create(d);$tom.append(e,c);return c}}if($tom.kindOf(h,"br")){return h}else{if(!$tom.hasContent(h)){return h}}if($tom.kindOf(h,this.iTranslator.getExpression())){return h}var d=$tom.inlineOf();var c=this.processor.create(d);$tom.insertAt(c,h);if(h){$tom.append(c,h)}return c}});Object.extend(Trex.I.Processor.Standard,{getInlineRangeIterator:function(d,e,c){return new a(this,d,e,c)}})})();(function(){var a=null;var c={};var d={};Object.extend(Trex.I.Processor.Standard,{newNode:function(e){if(a!=this.doc){c={};a=this.doc}if(!c[e]){c[e]=this.win[e]()}return $tom.clone(c[e],false)},newText:function(e){return this.doc.createTextNode(e)},newParagraph:function(e){if(a!=this.doc){d={};a=this.doc}if(!d[e]){d[e]=this.stuffNode(this.newNode(e))}return $tom.clone(d[e],true)}})})();(function(){var a=null;var c=null;var e=false;var d=[];Object.extend(Trex.I.Processor.Standard,{newDummy:function(h){h=!!h;if(a!=this.doc){c=null;d=[];a=this.doc
}if(!c){c=this.doc.createTextNode("\ufeff")}var j=$tom.clone(c);if(!h){d.push(j);e=true}return j},clearDummy:function(){if(!e){return}for(var k=0,h=d.length;k<h;k++){try{var j=d.shift();if(j&&j.nodeValue){if(j.nodeValue=="\ufeff"){$tom.remove(j)}else{j.nodeValue==j.nodeValue.replace(/\ufeff/g,"")}}}catch(l){}}e=false}})})();Trex.Canvas.Processor=Trex.Class.draft({$mixins:[Trex.I.Processor.Standard,(($tx.msie)?Trex.I.Processor.Trident:{}),(($tx.gecko)?Trex.I.Processor.Gecko:{}),(($tx.webkit)?Trex.I.Processor.Webkit:{}),(($tx.presto)?Trex.I.Processor.Presto:{})]});Trex.Canvas.ProcessorP=Trex.Class.create({$extend:Trex.Canvas.Processor,$mixins:[Trex.I.Processor.StandardP,(($tx.msie)?Trex.I.Processor.TridentP:{}),(($tx.gecko)?Trex.I.Processor.GeckoP:{}),(($tx.webkit)?Trex.I.Processor.WebkitP:{}),(($tx.presto)?Trex.I.Processor.PrestoP:{})]});Trex.Canvas.ProcessorBR=Trex.Class.create({$extend:Trex.Canvas.Processor,$mixins:[Trex.I.Processor.StandardBR,(($tx.msie)?Trex.I.Processor.TridentBR:{}),(($tx.gecko)?Trex.I.Processor.GeckoBR:{}),(($tx.webkit)?Trex.I.Processor.WebkitBR:{}),(($tx.presto)?Trex.I.Processor.PrestoBR:{})]});
Trex.register("filter > mode change",function(e,h,j,c,a){function k(n){var o=[[new RegExp("<head[^>]*>.*?<\\/head>","gi"),""],[new RegExp("<script[^>]*>.*?<\\/script>","gi"),""],[new RegExp("<style[^>]*>.*?<\\/style>","gi"),""],[new RegExp("<!--.*?-->","gi"),""],[new RegExp("<h[1-6][^>]*>(.+?)<\\/h[1-6]>","gi"),"\n$1\n\n"],[new RegExp("(<p[^>]*>(.+?)<\\/p>)","gi"),"$1\n"],[new RegExp("<br[^>]*>\\n","gi"),"\n"],[new RegExp("<br[^>]*>","gi"),"\n"],[new RegExp("(<ul[^>]*>|<\\/ul>|<ol[^>]*>|<\\/ol>|<table[^>]*>|<\\/table>)","gi"),"\n\n"],[new RegExp("(<tr[^>]*>|<\\/tr>)","gi"),"\n"],[new RegExp("(<li[^>]*>(.+?)<\\/li>)","gi"),"\t$1\n"],[new RegExp("(<td[^>]*>(.+?)<\\/td>)","gi"),"\t$1"],[new RegExp("(<th[^>]*>(.+?)<\\/th>)","gi"),"\t$1"],[new RegExp("<[\\/a-zA-Z!]+[^>]*>","g"),""],[new RegExp("&nbsp;?","g")," "],[new RegExp("&quot;?","g"),'"'],[new RegExp("&gt;?","g"),">"],[new RegExp("&lt;?","g"),"<"],[new RegExp("&amp;?","g"),"&"],[new RegExp("&copy;?","g"),"(c)"],[new RegExp("&trade;?","g"),"(tm)"],[new RegExp("&#8220;?","g"),'"'],[new RegExp("&#8221;?","g"),'"'],[new RegExp("&#8211;?","g"),"_"],[new RegExp("&#8217;?","g"),"'"],[new RegExp("&#38;?","g"),"&"],[new RegExp("&#169;?","g"),"(c)"],[new RegExp("&#8482;?","g"),"(tm)"],[new RegExp("&#151;?","g"),"--"],[new RegExp("&#039;?","g"),"'"],[new RegExp("&#147;?","g"),'"'],[new RegExp("&#148;?","g"),'"'],[new RegExp("&#149;?","g"),"*"],[new RegExp("&reg;?","g"),"(R]"],[new RegExp("&bull;?","g"),"*"]];
var m=n;for(i=0;i<o.length;i++){m=m.replace(o[i][0],o[i][1])}return m}function l(m){if(m!==null&&m.length!==0){m=m.replace(/&/g,"&amp;");m=m.replace(/ /g,"&nbsp;");m=m.replace(/\"/g,"&quot;");m=m.replace(/>/g,"&gt;");m=m.replace(/</g,"&lt;");if(m.lastIndexOf("\n")===m.length-1){m=m.substr(0,m.length-1)}if(m.lastIndexOf("\r")===m.length-1){m=m.substr(0,m.length-1)}m=m.replace(/\r\n|\r|\n/g,"<br>\n")}return m}var d=e.getDocParser();d.registerFilter("filter/converting",{"text@load":function(m){return k(m)},"source@load":function(m){return m},"html@load":function(m){return m},text4save:function(m){return l(m)},source4save:function(m){return m},html4save:function(m){return m},text2source:function(m){return l(m)},text2html:function(m){return l(m)},source2text:function(m){return k(m)},source2html:function(m){return m},html2text:function(m){return k(m)},html2source:function(m){return m}})});Trex.register("filter > clear redundancy",function(h,j,k,d,c){function a(n){var l=function(w,r,q){var u=0;
var p=function(x,y,z){u++;if(z.length==0||z.trim().length==0){return""}else{return['<span style="',r,":",y,';">',z,"</span>"].join("")}};var t=new RegExp("(?:<span[^>]*"+r+":[^>]*>){"+q+"}<span\\s*style=['\"]?"+r+":\\s*(\\w+)[;'\"]*>([\\S\\s]*?)</span>(?:</span>){"+q+"}","gi");do{u=0;w=w.replace(t,p)}while(u>0);return w};var o=["font-size","font-family"];for(var m=0;m<o.length;m++){n=l(n,o[m],8);n=l(n,o[m],4);n=l(n,o[m],1)}n=n.replace(/<span[^>]*><\/span>/gi,"");n=n.replace(/<font[^>]*><\/font>/gi,"");return n}var e=h.getDocParser();e.registerFilter("filter/redundancy",{"text@load":function(l){return l},"source@load":function(l){return a(l)},"html@load":function(l){return a(l)},text4save:function(l){return l},source4save:function(l){return l},html4save:function(l){return l},text2source:function(l){return l},text2html:function(l){return l},source2text:function(l){return l},source2html:function(l){return l},html2text:function(l){return l},html2source:function(l){return a(l)}})});TrexMessage.addMsg({"@attacher.only.wysiwyg.alert":"\uc5d0\ub514\ud130 \uc0c1\ud0dc\uc5d0\uc11c\ub9cc \ubcf8\ubb38\uc5d0 \uc0bd\uc785\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\uc5d0\ub514\ud130\ubaa8\ub4dc\uc5d0\uc11c \ucca8\ubd80\ubc15\uc2a4\uc758 \uc378\ub124\uc77c\uc744 \ud074\ub9ad\ud574\uc11c \uc0bd\uc785\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."});
Trex.Attachment=Trex.Class.draft({$extend:Trex.Entry,isChecked:false,attrs:{align:"left"},initialize:function(e,j){var d=this;var c=this.actor=e;var h=this.canvas=c.canvas;var a=this.entryBox=c.entryBox;this.type=this.constructor.__Identity;this.setProperties(j);if(this.oninitialized){this.oninitialized(e,j)}},setExistStage:function(a){this.existStage=a;if(this.entryBox.changeState){this.entryBox.changeState(this)}},remove:function(){var a=this.canvas.getContent();if(this.canvas.canHTML()){if(a.search(this.regHtml)>-1){a=a.replace(this.regHtml,"");this.canvas.setContent(a)}}else{if(a.search(this.regText)>-1){a=a.replace(this.regText,"");this.canvas.setContent(a)}}},register:function(){if(Editor.getSidebar().addOnlyBox){return}var c=this.actor;if(c.boxonly){return}if(this.canvas.canHTML()){var d=this.pastescope;var e=this.dispHtml;if(this.objectStyle){e=e.replace(/<img /i,'<img style="'+Trex.Util.toStyleString(this.objectStyle)+'" ')}if(this.objectAttr){e=e.replace(/<img /i,"<img "+Trex.Util.toAttrString(this.objectAttr))
}var a=this.paragraphStyle||{};this.canvas.execute(function(h){h.moveCaretWith(d);h.pasteContent(e,true,{style:a})})}else{if(this.actor.wysiwygonly){alert(TXMSG("@attacher.only.wysiwyg.alert"))}else{this.canvas.getProcessor().insertTag("",this.dispText)}}},replace:function(e){var d=this.canvas;var c=d.getContent();var a=this.actor;if(!a.boxonly){if(d.canHTML()){if(c.search(e.regHtml)>-1){c=c.replace(e.regHtml,this.dispHtml);d.setContent(c)}else{d.pasteContent(this.dispHtml,true)}}else{if(c.search(e.regText)>-1){c=c.replace(e.regText,"");d.setContent(c)}alert(TXMSG("@attacher.only.wysiwyg.alert"))}}},setProperties:function(c){var a=this.data=c;this.key=this.actor.getKey(a)||"K"+Trex.Util.generateKey();this.field=this.getFieldAttr(a);this.boxAttr=this.getBoxAttr(a);this.objectAttr=this.getObjectAttr.bind(this)(a);this.objectStyle=this.getObjectStyle.bind(this)(a);this.paragraphStyle=this.getParaStyle.bind(this)(a);this.saveHtml=this.getSaveHtml.bind(this)(a);this.dispHtml=this.getDispHtml.bind(this)(a);
this.dispText=this.getDispText.bind(this)(a);this.regLoad=this.getRegLoad.bind(this)(a);this.regHtml=this.getRegHtml.bind(this)(a);this.regText=this.getRegText.bind(this)(a)},getObjectAttr:function(a){return this.actor.config.objattr},getObjectStyle:function(a){return this.actor.config.objstyle},getParaStyle:function(a){return this.actor.config.parastyle||this.actor.config.defaultstyle||{}}});TrexConfig.addSidebar("attachbox",{show:true,destroy:false});Trex.AttachBox=Trex.Class.create({$extend:Trex.EntryBox,isChecked:false,initialize:function(a,c){},checkAvailableCapacity:function(){return true},getAvailableCapacity:function(){return true},checkInsertableSize:function(a){return true}});Trex.install("editor.getAttachBox & sidebar.getAttachments",function(e,h,j,d,c){var a=new Trex.AttachBox(c,e);j.entryboxRegistry.attachbox=a;e.getAttachBox=function(){return a};j.getAttachments=a.getEntries.bind(a)});Trex.register("filter > attachers",function(h,j,k,d,c){var a=h.getAttachBox();var e=h.getDocParser();
e.registerFilter("filter/attachments",{"text@load":function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regLoad,"")});return m},"source@load":function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regLoad,n.dispText)});return m},"html@load":function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regLoad,n.dispHtml)});return m},text4save:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regText,"")});return m},source4save:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regText,n.saveHtml,["id","class"])});return m},html4save:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regHtml,n.saveHtml,["id","class"])});return m},text2source:function(l){return l},text2html:function(l){return l},source2text:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regText,"")});return m},source2html:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regText,n.dispHtml)
});return m},html2text:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regHtml,"")});return m},html2source:function(m){var l=a.datalist;l.each(function(n){m=n.getChangedContent(m,n.regHtml,n.dispText,["id","class"])});return m}})});Trex.module("push history @when entrybox has changes",function(e,h,j,d,c){var a=e.getAttachBox();a.observeJob("entrybox.entryremoved",function(k){d.history.saveHistory({deleted:true,content:d.getContent(),scrollTop:d.getScrollTop()},function(l){k.deletedMark=(l.deleted==true||l.deleted==undefined)?true:false;a.fireJobs(Trex.Ev.__ENTRYBOX_ENTRY_REFRESH,k);d.setContent(l.content)})});a.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_ADDED,function(k){d.history.injectHistory({deleted:false},function(l){k.deletedMark=(l.deleted===false)?false:true;a.fireJobs(Trex.Ev.__ENTRYBOX_ENTRY_REFRESH,k)})})});TrexMessage.addMsg({"@attacher.ins":"\uc0bd\uc785","@attacher.del":"\uc0ad\uc81c","@attacher.preview.image":"#iconpath/pn_preview.gif","@attacher.delete.confirm":"\uc0ad\uc81c\ud558\uc2dc\uba74 \ubcf8\ubb38\uc5d0\uc11c\ub3c4 \uc0ad\uc81c\ub429\ub2c8\ub2e4. \uacc4\uc18d\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","@attacher.delete.all.confirm":"\uc120\ud0dd\ud55c \ucca8\ubd80\ud30c\uc77c\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc0ad\uc81c\ud558\uc2dc\uba74 \ubcf8\ubb38\uc5d0\uc11c\ub3c4 \uc0ad\uc81c\ub429\ub2c8\ub2e4.","@attacher.exist.alert":"\uc774\ubbf8 \ubcf8\ubb38\uc5d0 \uc0bd\uc785\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4."});
Trex.install("attachbox.onAttachBoxInitialized @if config.sidebar.attachbox.show = true",function(e,h,j,d,c){var a=e.getAttachBox();if(c.sidebar.attachbox.show==true){Object.extend(a,Trex.I.AttachBox);a.onAttachBoxInitialized(c,d,e)}});Trex.I.AttachBox={useBox:true,isDisplay:false,lastSelectedEntry:null,onAttachBoxInitialized:function(d,c){var a=this;this.canvas=c;var l=((d.initializedId)?d.initializedId:"");this.elBox=$must("tx_attach_div"+l,"Trex.I.AttachBox");this.elList=$must("tx_attach_list"+l,"Trex.I.AttachBox");var j=$must("tx_attach_preview"+l,"Trex.I.AttachBox");this.elPreviewKind=$tom.collect(j,"p");var h=this.elPreviewImg=$tom.collect(j,"img");var e=this.imageResizer=new Trex.ImageResizer(h,{maxWidth:147,maxHeight:108,defImgUrl:TXMSG("@attacher.preview.image"),onComplete:function(n,m){h.style.marginTop=Math.floor((108-m)/2).toPx()}});this.elDelete=$tom.collect("#tx_attach_delete"+l+" a");$tx.observe(this.elDelete,"click",this.onDeleteAll.bind(this));if(typeof(showAttachBox)!="undefined"){this.observeJob(Trex.Ev.__ATTACHBOX_SHOW,function(){showAttachBox()
})}if(typeof(hideAttachBox)!="undefined"){this.observeJob(Trex.Ev.__ATTACHBOX_HIDE,function(){hideAttachBox()})}var k=this.elProgress=$must("tx_upload_progress"+l,"Trex.I.AttachBox");this.elProgressPercent=$tom.collect(k,"div");this.elProgressTicker=$tom.collect(k,"p");this.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_ADDED,function(m){a.registerEntryNode(m);a.displayBox()});this.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_MODIFIED,function(m){a.modifyEntryNode(m)});this.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_REMOVED,function(m){a.removeEntryNode(m);a.displayBox();if(a.lastSelectedEntry&&a.lastSelectedEntry.key==a.key){a.imageResizer.execResize(TXMSG("@attacher.preview.image"))}});this.observeJob(Trex.Ev.__ENTRYBOX_ALL_ENTRY_REMOVED,function(){a.datalist.each(function(m){a.removeEntryNode(m,true)});a.displayBox();if(a.lastSelectedEntry&&a.lastSelectedEntry.key==a.key){a.imageResizer.execResize(TXMSG("@attacher.preview.image"))}});this.observeJob(Trex.Ev.__ENTRYBOX_ENTRY_REFRESH,function(m){a.displayBox();a.refreshEntryNode(m)
})},onDeleteAll:function(a){if(this.datalist.length===0){return}if(!a&&!confirm(TXMSG("@attacher.delete.all.confirm"))){return}this.datalist.each(function(c){c.execRemove()});this.imageResizer.execResize(TXMSG("@attacher.preview.image"))},checkDisplay:function(){return this.isDisplay},setDisplay:function(a){this.isDisplay=a},displayBox:function(){var a=false;for(i=0;i<this.datalist.length;i++){if(this.datalist[i].deletedMark==false){a=true}}if(this.isDisplay==a){return}if(a){$tx.show(this.elBox);this.fireJobs(Trex.Ev.__ATTACHBOX_SHOW,true)}else{$tx.hide(this.elBox);this.fireJobs(Trex.Ev.__ATTACHBOX_HIDE,false)}this.isDisplay=a},registerEntryNode:function(e){var j=tx.li();this.elList.appendChild(j);e.elData=j;e.makeSelection=function(l){if(l){this.showEntryThumb(e)}else{this.hideEntryThumb(e)}}.bind(this);$tx.observe(j,"mouseover",this.onEntryMouseOver.bind(this,e));$tx.observe(j,"mouseout",this.onEntryMouseOut.bind(this,e));var h=tx.dl();j.appendChild(h);var c=e.elName=tx.dt({className:"tx-name",unselectable:"on"},e.boxAttr.name);
h.appendChild(c);$tx.observe(j,"click",function(l){var m=$tx.element(l);if(m.className=="tx-delete"||m.className=="tx-insert"){return}if(l.ctrlKey){this.clickEntryWithCtrl(e)}else{if(l.shiftKey){this.clickEntryWithShift(e)}else{this.clickEntry(e)}}if(e.actor.name=="image"){if(!e.data.width||!e.data.height){new Trex.ImageScale(e.data)}}}.bind(this),false);var d=tx.dd({className:"tx-button"});h.appendChild(d);var a=tx.a({className:"tx-delete"},TXMSG("@attacher.del"));d.appendChild(a);$tx.observe(a,"click",function(){if(!confirm(TXMSG("@attacher.delete.confirm"))){return}e.execRemove()},false);var k=e.elInsert=tx.a({className:"tx-insert"},TXMSG("@attacher.ins"));d.appendChild(k);$tx.observe(k,"click",function(){if(e.existStage&&!e.actor.config.multipleuse){alert(TXMSG("@attacher.exist.alert"))}else{e.execAppend()}},false)},changeState:function(c){var a=c.existStage;if(a&&!c.actor.config.multipleuse){$tx.addClassName(c.elData,"tx-existed")}else{$tx.removeClassName(c.elData,"tx-existed")}},modifyEntryNode:function(a){a.elName.innerText=a.boxAttr.name
},removeEntryNode:function(a,c){if(c){a.elData.parentNode.removeChild(a.elData)}else{if(a.deletedMark){$tx.hide(a.elData)}}},refreshEntryNode:function(a){if(a.deletedMark){$tx.hide(a.elData)}else{$tx.show(a.elData)}},showEntryThumb:function(a){$tx.addClassName(a.elData,"tx-clicked");$tx.removeClassName(a.elData,"tx-hovered")},hideEntryThumb:function(a){$tx.removeClassName(a.elData,"tx-clicked")},onEntryMouseOver:function(a){$tx.addClassName(a.elData,"tx-hovered")},onEntryMouseOut:function(a){$tx.removeClassName(a.elData,"tx-hovered")},startUpload:function(){this.elProgressPercent.style.width="0".toPx();$tx.setStyle(this.elList,{opacity:0.3});$tx.show(this.elProgress)},doUpload:function(c){var a=300;this.elProgressPercent.style.width=Math.floor(a*(isNaN(c)?0:parseFloat(c)*0.01)).toPx();this.elProgressTicker.innerText=Math.floor((isNaN(c)?0:parseFloat(c)))+"%"},endUpload:function(){$tx.hide(this.elProgress);$tx.setStyle(this.elList,{opacity:1})},clickEntry:function(a){if(this.lastSelectedEntry){if(this.lastSelectedEntry.key==a.key){return
}this.datalist.each(function(c){c.makeSelection(false)})}this.elPreviewKind.className=((a.boxAttr.className)?a.boxAttr.className:"");a.makeSelection(true);this.imageResizer.execResize(a.boxAttr.image);this.lastSelectedEntry=a},clickEntryWithCtrl:function(a){if($tx.hasClassName(a.elData,"tx-clicked")){a.makeSelection(false);this.lastSelectedEntry=null}else{this.elPreviewKind.className=((a.boxAttr.className)?a.boxAttr.className:"");a.makeSelection(true);this.imageResizer.execResize(a.boxAttr.image);this.lastSelectedEntry=a}},clickEntryWithShift:function(d){if($tx.hasClassName(d.elData,"tx-clicked")){d.makeSelection(false);this.lastSelectedEntry=null}else{var a=this.getIndexOf(d);var e;if(this.lastSelectedEntry){e=this.getIndexOf(this.lastSelectedEntry)}var j=e,h=a;if(a==e){j=h=a}else{if(a<e){j=a;h=e}}this.elPreviewKind.className=((d.boxAttr.className)?d.boxAttr.className:"");for(var c=j;c<h+1;c++){this.datalist[c].makeSelection(true)}this.imageResizer.execResize(d.boxAttr.image);this.lastSelectedEntry=d
}},getIndexOf:function(d){var c,a;for(c=0;c<this.datalist.length;c++){if(this.datalist[c]===d){a=true;break}}return a?c:-1},getSelectedList:function(c){var d=[];var a;if(c){a=this.getAttachments(c)}else{a=this.datalist}a.each(function(e){if($tx.hasClassName(e.elData,"tx-clicked")){d.push(e)}});return d},removeSelection:function(a){a.each(function(c){$tx.removeClassName(c.elData,"tx-clicked")})}};TrexMessage.addMsg({"@file.error.file.count.alert":"\uc5c5\ub85c\ub4dc \ud30c\uc77c\uac2f\uc218\uac00 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","@file.error.file.size.alert":"\uc5c5\ub85c\ub4dc \uc6a9\ub7c9\uc774 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."});Trex.FileUploaderAdaptor={checkEditor:function(c){var a=c.substr(4,c.length);if(Editor.getInitializedId()!=a){Editor.prototype.switchEditor(a)}},on_upload_start:function(a){this.checkEditor(a);var c=Editor.getAttachBox();if(c&&c.startUpload){c.startUpload()}},on_upload_progress:function(d,a){this.checkEditor(a);var c=Editor.getAttachBox();
if(c&&c.doUpload){c.doUpload(d)}},on_upload_complete:function(a,c){this.checkEditor(c);var d=Editor.getSidebar().getUploadAdaptor();if(d&&d.attach){d.attach(arguments[0])}},on_upload_finish:function(a){this.checkEditor(a);var c=Editor.getAttachBox();if(c&&c.endUpload){c.endUpload()}Editor.getSidebar().addOnlyBox=null},on_over_filesize:function(c,a){alert(TXMSG("@file.error.file.size.alert"));this.checkEditor(a);var d=Editor.getAttachBox();if(d&&d.endUpload){d.endUpload()}},on_over_filecount:function(c,a){alert(TXMSG("@file.error.file.count.alert"));this.checkEditor(a);var d=Editor.getAttachBox();if(d&&d.endUpload){d.endUpload()}},on_error:function(c,a){this.checkEditor(a);Editor.getSidebar().addOnlyBox=null},on_browse_cancel:function(a){this.checkEditor(a);Editor.getSidebar().addOnlyBox=null},on_upload_open:function(a,c,d){},on_activate_complete:function(a){},on_activate_finish:function(){},on_over_filequota:function(d,a){alert(TXMSG("@file.error.file.size.alert"));this.checkEditor(a);var c=Editor.getAttachBox();
if(c&&c.endUpload){c.endUpload()}},on_upload_skip:function(a,c,d){}};TrexMessage.addMsg({"@attacher.can.modify.alert":"\uae30\uc874\uc5d0 \ub4f1\ub85d\ub41c #{title}\ub97c \uc218\uc815\ud560 \uc218 \uc788\ub294 \ud654\uba74\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4.","@attacher.can.modify.confirm":"#{title}\uc740(\ub294) \ud558\ub098\ub9cc \ub4f1\ub85d\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4.\n\ub2e4\uc2dc \uc62c\ub9ac\uc2dc\uba74 \uae30\uc874\uc758 #{title}\uc774(\uac00) \uc0ad\uc81c\ub429\ub2c8\ub2e4. \uacc4\uc18d\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","@attacher.insert.alert":"\uc5d0\ub514\ud130 \uc0c1\ud0dc\uc5d0\uc11c\ub9cc \uc0bd\uc785\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","@attacher.capacity.alert":"\uc6a9\ub7c9\uc744 \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4.","@attacher.size.alert":"\uc6a9\ub7c9\uc744 \ucd08\uacfc\ud558\uc5ec \ub354\uc774\uc0c1 \ub4f1\ub85d\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."});Trex.install("sidebar.getAttacher & sidebar.getUploadAdaptor",function(h,j,k,d,c){var a=h.getAttachBox();
var e=k.attachers={};k.getAttacher=function(l){if(e[l]!=null){return e[l]}else{if(arguments.length==0){return e}else{return null}}}});Trex.register("new attachers",function(j,l,a,c,d){var k=j.getAttachBox();var h=a.attachers;for(var e in Trex.Attacher){var m=Trex.Attacher[e]["__Identity"];if(m){if(!l.tools[m]){}h[m]=new Trex.Attacher[e](j,k,d)}}if(h.file){a.getUploadAdaptor=function(){return h.file.getAdaptor()}}});Trex.Attacher=Trex.Class.draft({$extend:Trex.Actor,canModified:false,canResized:false,initialize:function(c,e,a){this.editor=c;this.canvas=c.getCanvas();this.entryBox=e;this.pvUrl=TrexConfig.getUrl(a.pvpage,{pvname:this.name});var d=this.config=TrexConfig.getAttacher(this.constructor.__Identity,a);this.boxonly=((d.boxonly!=null)?d.boxonly:false);this.isMultiple=((d.multiple!=null)?d.multiple:false);this.isCheckSize=((d.checksize!=null)?d.checksize:false);this.wysiwygonly=((d.wysiwygonly!=null)?d.wysiwygonly:true);this.pastescope=d.pastescope;if(this.oninitialized){this.oninitialized(a)
}this.attachHandler=this.attachHandler.bind(this)},execute:function(j){if(this.wysiwygonly&&!this.canvas.canHTML()){alert(TXMSG("@attacher.insert.alert"));return}if(this.isCheckSize&&!this.entryBox.checkAvailableCapacity()){alert(TXMSG("@attacher.capacity.alert"));return}if(!this.checkInsertable()){if(this.canModified){var c=new Template(TXMSG("@attacher.can.modify.alert"));alert(c.evaluate({title:this.title}))}else{var c=new Template(TXMSG("@attacher.can.modify.confirm"));if(!confirm(c.evaluate({title:this.title}))){return}}}if(this.clickHandler){this.clickHandler()}else{try{var a=this.config.popPageUrl;if(j){a=a+((a.indexOf("?")>-1)?"&":"?")+j}a=((this.config.usepvpage)?this.pvUrl+"&u="+escape(a):a);var h=window.open(a,"at"+this.name,this.config.features);h.focus()}catch(d){}}},attachHandler:function(c,a){if(this.checkInsertable()){if(this.isCheckSize&&!this.entryBox.checkInsertableSize(c.filesize)){alert(TXMSG("@attacher.size.alert"));return}this.execAttach(c,a)}else{this.execReattach(c,a)
}},createEntry:function(c,a){return this.createAttachment(c,a)},createAttachment:function(d,c){var a=this.constructor.__Identity;if(c){a=c}return new Trex.Attachment[a.capitalize()](this,d)},checkInsertable:function(){return(this.isMultiple||this.getDatalist().length===0)}});TrexMessage.addMsg({"@embeder.alert":"\uc5d0\ub514\ud130 \uc0c1\ud0dc\uc5d0\uc11c\ub9cc \uc0bd\uc785\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."});Trex.EmbedBox=Trex.Class.create({$extend:Trex.EntryBox,initialize:function(c,a){}});Trex.install("editor.getEmbedBox & sidebar.getEmbeder & sidebar.getEmbeddedData",function(e,h,j,d,c){var k=new Trex.EmbedBox(c,d,e);j.entryboxRegistry.embedbox=k;e.getEmbedBox=function(){return k};j.getEmbeddedData=k.getEntries.bind(k);var a=j.embeders={};j.getEmbeder=function(l){if(a[l]!=null){return a[l]}else{if(arguments.length==0){return a}else{return null}}}});Trex.register("new embeders",function(h,k,a,c,d){var m=h.getEmbedBox();var j=a.embeders;for(var e in Trex.Embeder){var l=Trex.Embeder[e]["__Identity"];
if(l){if(!k.tools[l]){}j[l]=new Trex.Embeder[e](h,m,d)}}});Trex.Embeder=Trex.Class.draft({$extend:Trex.Actor,canResized:false,initialize:function(c,e,a){this.editor=c;this.canvas=c.getCanvas();var d=this.config=TrexConfig.getEmbeder(this.constructor.__Identity,a);this.pvUrl=TrexConfig.getUrl(a.pvpage,{pvname:this.name});this.wysiwygonly=((d.wysiwygonly!=null)?d.wysiwygonly:true);this.pastescope=d.pastescope;this.embedHandler=this.embedHandler.bind(this);if(this.oninitialized){this.oninitialized.bind(this)(a)}},execute:function(){if(this.wysiwygonly&&!this.canvas.canHTML()){alert(TXMSG("@embeder.alert"));return}if(this.clickHandler){this.clickHandler()}else{try{var a=this.config.usepvpage?this.pvUrl+"&u="+escape(this.config.popPageUrl):this.config.popPageUrl;var d=window.open(a,"at"+this.name,this.config.features);d.focus()}catch(c){}}},embedHandler:function(a){this.execAttach(a)},createEntry:function(d,c){var a=this.constructor.__Identity;if(c){a=c}return new Trex.EmbedEntry[a.capitalize()](this,d)
},execAttach:function(h,e){var d=this.pastescope;var c=this.getCreatedHtml(h);var a=this.config.parastyle||this.config.defaultstyle||{};this.canvas.execute(function(j){j.moveCaretWith(d);j.pasteContent(c,true,a)})},execReattach:function(c,a){},execReload:function(c,a){},getReloadContent:function(e,d){if(!e.dispElId){return d}var a=this.getCreatedHtml(e);var c=new RegExp('<(?:img|IMG)[^>]*id="?'+e.dispElId+'"?[^>]*/?>',"gm");if(d.search(c)>-1){return d.replace(c,a)}return d}});Trex.EmbedEntry=Trex.Class.create({$extend:Trex.Entry,attrs:{align:"left"},initialize:function(e,j){var d=this;var c=this.actor=e;var h=this.canvas=c.canvas;var a=this.entryBox=c.entryBox;this.setProperties(j)},register:function(){if(this.canvas.canHTML()){var a=this.actor.config.defaultstyle;if(a){this.canvas.pasteContent(this.dispHtml,true,{style:a})}else{this.canvas.pasteContent(this.dispHtml,true)}}else{this.canvas.getProcessor().insertTag("",this.dispText)}},setProperties:function(d){this.type=this.constructor.__Identity;
var c=this.data=d;var a=this.key=c.key;this.dispHtml=this.getDispHtml(c);this.saveHtml=this.dispText=this.getDispText(c);this.regHtml=this.getRegHtml(c);this.regLoad=this.regText=this.getRegText(c)}});TrexMessage.addMsg({"@switcher.wysiwyg":"\uc5d0\ub514\ud130","@switcher.source":"HTML","@switcher.text":"\ud14d\uc2a4\ud2b8"});TrexConfig.addTool("switcher",{wysiwygonly:false,status:true,options:[{label:TXMSG("@switcher.wysiwyg"),title:TXMSG("@switcher.wysiwyg"),data:"html"},{label:TXMSG("@switcher.source"),title:TXMSG("@switcher.source"),data:"source"},{label:TXMSG("@switcher.text"),title:TXMSG("@switcher.text"),data:"text"}]});Trex.Tool.Switcher=Trex.Class.create({$const:{__Identity:"switcher"},$extend:Trex.Tool,oninitialized:function(c){var h=this.canvas;var k={};c.options.each(function(l){k[l.data]={title:l.title}});var e="";var j=c.options[0];var d=function(l){h.changeMode(l)};var a=function(m,l){if(m==l){return}if(e==l){return}if(!k[l]){return}this.button.setValue(l);this.button.setText(k[l].title);
e=l}.bind(this);h.observeJob(Trex.Ev.__CANVAS_MODE_CHANGE,a);h.observeJob(Trex.Ev.__CANVAS_MODE_INITIALIZE,a);this.weave.bind(this)(new Trex.Button.Select(TrexConfig.merge(this.buttonCfg,{selectedValue:j.data,selectedText:j.label})),new Trex.Menu.Select(this.menuCfg),d)}});TrexConfig.addTool("switchertoggle",{wysiwygonly:false,sync:true,status:true,options:[{label:"\uc5d0\ub514\ud130",title:"\uc5d0\ub514\ud130",data:"html"},{label:"HTML",title:"HTML",data:"source"}]});Trex.Tool.SwitcherToggle=Trex.Class.create({$const:{__Identity:"switchertoggle"},$extend:Trex.Tool,oninitialized:function(d){var a=this;var h=this.canvas;var e=function(){switch(h.mode){case"html":h.changeMode("source");break;case"source":h.changeMode("html");break}};this.weave.bind(this)(new Trex.Button.Toggle(TrexConfig.merge(this.buttonCfg,{borderClass:"tx-switchtoggle"})),null,e);var c=function(k,j){this.button.setValue(j=="source")}.bind(this);h.observeJob(Trex.Ev.__CANVAS_MODE_INITIALIZE,c)}});TrexMessage.addMsg({"@fontfamily.gulim":"\uad74\ub9bc","@fontfamily.batang":"\ubc14\ud0d5","@fontfamily.dotum":"\ub3cb\uc6c0","@fontfamily.gungsuh":"\uad81\uc11c"});
TrexConfig.addTool("fontfamily",{sync:true,status:true,useFavorite:true,options:[{label:TXMSG("@fontfamily.gulim")+'<span class="tx-txt">(\uac00\ub098\ub2e4\ub77c)</span>',title:TXMSG("@fontfamily.gulim"),data:"Gulim,\uad74\ub9bc",klass:"tx-gulim"},{label:TXMSG("@fontfamily.batang")+'<span class="tx-txt">(\uac00\ub098\ub2e4\ub77c)</span>',title:TXMSG("@fontfamily.batang"),data:"Batang,\ubc14\ud0d5",klass:"tx-batang"},{label:TXMSG("@fontfamily.dotum")+'<span class="tx-txt">(\uac00\ub098\ub2e4\ub77c)</span>',title:TXMSG("@fontfamily.dotum"),data:"Dotum,\ub3cb\uc6c0",klass:"tx-dotum"},{label:TXMSG("@fontfamily.gungsuh")+' <span class="tx-txt">(\uac00\ub098\ub2e4\ub77c)</span>',title:TXMSG("@fontfamily.gungsuh"),data:"Gungsuh,\uad81\uc11c",klass:"tx-gungseo"},{label:'Arial <span class="tx-txt">(abcde)</span>',title:"Arial",data:"Arial",klass:"tx-arial"},{label:'Verdana <span class="tx-txt">(abcde)</span>',title:"Verda..",data:"Verdana",klass:"tx-verdana"}]});Trex.Tool.FontFamily=Trex.Class.create({$const:{__Identity:"fontfamily"},$extend:Trex.Tool,$mixins:[Trex.I.CookieBaker],oninitialized:function(c){var j=this;
var n=this.canvas;var o=n.getStyleConfig().fontFamily;var d=(($tx.msie&&c.webfont&&c.webfont.use)?c.webfont.options:[]);if(!$tx.msie){d.each(function(r){r.expired=true})}var m=(c.options||[]).concat(d);var h={};m.each(function(u){var r=u.data.split(",");for(var t=0;t<r.length;t++){h[r[t].toLowerCase()]=u.title}});m.each(function(r){if(!h[r.title.toLowerCase()]){h[r.title.toLowerCase()]=r.title}});var p=function(r){if(h[r.toLowerCase()]){return h[r.toLowerCase()]}else{r=r.replace("_9","").replace("9","");if(h[r.toLowerCase()]){return h[r.toLowerCase()]}else{return h[o]}}};var e=false;if(c.useFavorite){if(d.length>0){e=true;j.initCookie("txFontFamilyFavorite")}}var l=function(r){n.includeWebfontCss("font-family: "+r);n.execute(function(t){var u=t.inlines(function(w){if(w==="control"){return"img,hr,table"}return"%text,span,font"});u.each(function(w){$tom.descendants(w,"%inline").each(function(x){$tom.applyAttributes(x,{style:{fontFamily:null},face:null})})});t.apply(u,{style:{fontFamily:r},face:null})
});if(e){j.writeCookie(j.mergeValues(j.readCookie(),r))}};var k=false;var q=function(){k=false;if(!e){return[]}j.menu.elMenu.scrollTop=0;var t=$tom.collect(j.menu.elMenu,"ul.tx-menu-favlist");if(t){$tom.remove(t)}var r=j.extractOptions(m,j.readCookie());var t=j.menu.generateList(r);$tom.insertFirst(j.menu.elMenu,t);$tx.addClassName(t,"tx-menu-favlist");return r};this.weave.bind(this)(new Trex.Button.Select(TrexConfig.merge(this.buttonCfg,{selectedValue:o,selectedText:p(o)})),new Trex.Menu.Select(TrexConfig.merge(this.menuCfg,{options:m})),l,q);if(d.length>0){$tx.addClassName(j.menu.elMenu,"tx-fontfamily-webfont-menu");var a=tx.input({type:"text",className:"tx-dummyfocus"});$tom.append(j.menu.elMenu,a);$tx.observe(j.menu.elMenu,"mousedown",function(r){if(r.offsetX<j.menu.elMenu.clientWidth){return}a.style.top=r.offsetY.toPx();if(!k){a.focus();a.blur();j.menu.elMenu.focus();k=true}})}n.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var u=n.query(function(z){var y=z.findNode("%inline");
return z.queryStyle(y,"fontFamily")});if(u==null){u=n.query(function(z){var y=z.findNode("%inline");return z.queryAttr("face")})}u=u||o;try{var r=u.split(",");var w="";for(var t=0;t<r.length;t++){var w=w||p(r[t])}j.button.setText(w)}catch(x){}})}});TrexConfig.addTool("fontsize",{sync:true,status:true,options:[{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (8pt)",title:"8pt",data:"8pt",klass:"tx-8pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (9pt)",title:"9pt",data:"9pt",klass:"tx-9pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (10pt)",title:"10pt",data:"10pt",klass:"tx-10pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (11pt)",title:"11pt",data:"11pt",klass:"tx-11pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (12pt)",title:"12pt",data:"12pt",klass:"tx-12pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (14pt)",title:"14pt",data:"14pt",klass:"tx-14pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8\ubc14\uc0ac (18pt)",title:"18pt",data:"18pt",klass:"tx-18pt"},{label:"\uac00\ub098\ub2e4\ub77c\ub9c8 (24pt)",title:"24pt",data:"24pt",klass:"tx-24pt"},{label:"\uac00\ub098\ub2e4 (36pt)",title:"36pt",data:"36pt",klass:"tx-36pt"}]});
Trex.Tool.FontSize=Trex.Class.create({$const:{__Identity:"fontsize"},$extend:Trex.Tool,oninitialized:function(c){var a=this;var j=this.canvas;var l=j.getStyleConfig().fontSize;var d=(c.options||[]);var k={};d.each(function(m){k[m.data]=m.title});[{title:"7.5pt",data:"1"},{title:"10pt",data:"2"},{title:"12pt",data:"3"},{title:"14pt",data:"4"},{title:"18pt",data:"5"},{title:"24pt",data:"6"},{title:"36pt",data:"7"},{title:"7.5pt",data:"10px"},{title:"8pt",data:"11px"},{title:"9pt",data:"12px"},{title:"10pt",data:"13px"},{title:"11pt",data:"15px"},{title:"12pt",data:"16px"},{title:"14pt",data:"19px"},{title:"18pt",data:"24px"},{title:"24pt",data:"32px"},{title:"36pt",data:"48px"}].each(function(m){k[m.data]=m.title});var h=function(m){if(k[m]){return k[m]}else{return m}};var e=function(m){j.execute(function(n){var o=n.inlines(function(p){if(p==="control"){return"img,hr,table"}return"%text,span,font"});o.each(function(p){[p].concat($tom.descendants(p,"span,font")).each(function(q){$tom.applyAttributes(q,{style:{fontSize:null},size:null})
})});n.apply(o,{style:{fontSize:m},size:null})})};this.weave.bind(this)(new Trex.Button.Select(TrexConfig.merge(this.buttonCfg,{selectedValue:l,selectedText:h(l)})),new Trex.Menu.Select(this.menuCfg),e);j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var m=j.query(function(p){var o=p.findNode("%inline");return p.queryStyle(o,"fontSize")});if(m==null){m=j.query(function(p){var o=p.findNode("%inline");return p.queryAttr("size")})}m=m||l;if(m.indexOf("px")!=-1){m=Math.round(parseFloat(m))+"px"}var n=h(m);a.button.setText(n)})}});TrexConfig.addTool("bold",{wysiwygonly:true,sync:true,status:true});Trex.Tool.Bold=Trex.Class.create({$const:{__Identity:"bold"},$extend:Trex.Tool,oninitialized:function(c){var a=this;var j=this.canvas;var e=new Trex.Button(this.buttonCfg);var d=function(){if(j.canHTML()){j.execute(function(k){k.execCommand("bold",null)});j.syncProperty()}else{e.setState(true);j.execute(function(k){k.insertTag("<strong>","</strong>")})}};this.weave.bind(this)(e,null,d);
var h=false;j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var k=j.query(function(l){return l.queryCommandState("bold")});if(h==k){return}a.button.setState(k);h=k});j.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:66},d)}});TrexConfig.addTool("underline",{wysiwygonly:true,sync:true,status:true});Trex.Tool.Underline=Trex.Class.create({$const:{__Identity:"underline"},$extend:Trex.Tool,oninitialized:function(c){var a=this;var j=this.canvas;var e=new Trex.Button(this.buttonCfg);var d=function(){if(j.canHTML()){j.execute(function(k){k.execCommand("underline",null)});j.syncProperty("underline")}else{e.setState(true);j.execute(function(k){k.insertTag("<u>","</u>")})}};this.weave.bind(this)(e,null,d);var h=false;j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var k=j.query(function(l){return l.queryCommandState("underline")});if(h==k){return}a.button.setState(k);h=k});j.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:85},d)}});TrexConfig.addTool("italic",{wysiwygonly:true,sync:true,status:true});
Trex.Tool.Italic=Trex.Class.create({$const:{__Identity:"italic"},$extend:Trex.Tool,oninitialized:function(c){var a=this;var j=this.canvas;var e=new Trex.Button(this.buttonCfg);var d=function(){if(j.canHTML()){j.execute(function(k){k.execCommand("italic",null)});j.syncProperty("italic")}else{e.setState(true);j.execute(function(k){k.insertTag("<em>","</em>")})}};this.weave.bind(this)(e,null,d);var h=false;j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var k=j.query(function(l){return l.queryCommandState("italic")});if(h==k){return}a.button.setState(k);h=k});j.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:73},d)}});TrexConfig.addTool("strike",{wysiwygonly:true,sync:true,status:true});Trex.Tool.Strike=Trex.Class.create({$const:{__Identity:"strike"},$extend:Trex.Tool,oninitialized:function(c){var a=this;var j=this.canvas;var e=new Trex.Button(this.buttonCfg);var d=function(){if(j.canHTML()){j.execute(function(k){k.execCommand("strikethrough",null)});j.syncProperty("strikethrough")
}else{e.setState(true);j.execute(function(k){k.insertTag("<strike>","</strike>")})}};this.weave.bind(this)(e,null,d);var h=false;j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var k=j.query(function(l){return l.queryCommandState("strikethrough")});if(h==k){return}a.button.setState(k);h=k});j.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:68},d)}});TrexConfig.addTool("forecolor",{defaultcolor:"#7c84ef",wysiwygonly:true,sync:false,status:true,useFavorite:false,thumbs:Trex.__CONFIG_COMMON.thumbs,needRevert:true});Trex.Tool.ForeColor=Trex.Class.create({$const:{__Identity:"forecolor"},$extend:Trex.Tool,$mixins:[Trex.I.CookieBaker],oninitialized:function(d){var a=this;var j=this.canvas;var c=false;if(d.useFavorite){c=true;a.initCookie("txForeColorFavorite")}var k=d.defaultcolor;if(c){if(a.readCookie()){k=a.readCookie()}}var h=j.getStyleConfig("color");var e=function(l){if(j.canHTML()){j.execute(function(m){if(l==null){m.execCommand("forecolor",h)}else{m.execCommand("forecolor",l)
}})}else{j.execute(function(m){m.insertTag('<span style="color: '+l+';" >',"</span>")})}if(l){$tx.setStyle(a.button.elButton,{backgroundColor:l})}if(c){a.writeCookie(l)}};this.weave.bind(this)(new Trex.Button.Splits(TrexConfig.merge(this.buttonCfg,{selectedValue:k})),new Trex.Menu.ColorPallete(this.menuCfg),e);$tx.setStyle(a.button.elButton,{backgroundColor:k})}});TrexConfig.addTool("backcolor",{defaultcolor:"#9aa5ea",wysiwygonly:true,sync:false,status:true,useFavorite:true,texts:{options:[{color:"#ff0000",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#e545d0",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#000000",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#ff5e00",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#7c43b1",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#848484",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#ffbb00",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#4673ff",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#66e8ff",text:"#000000",label:"\uac00\ub098\ub2e4"},{color:"#ffe400",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#1fafda",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#8cfccb",text:"#000000",label:"\uac00\ub098\ub2e4"},{color:"#a8c40d",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#009999",text:"#ffffff",label:"\uac00\ub098\ub2e4"},{color:"#ffffff",text:"#000000",label:"\uac00\ub098\ub2e4"}]},thumbs:Trex.__CONFIG_COMMON.thumbs,needRevert:true,needTrans:false});
Trex.Tool.BackColor=Trex.Class.create({$const:{__Identity:"backcolor"},$extend:Trex.Tool,$mixins:[Trex.I.CookieBaker],oninitialized:function(a){var e=this;var k=this.canvas;var d=false;if(a.useFavorite){d=true;e.initCookie("txBackColorFavorite")}var l=a.defaultcolor;if(d){if(e.readCookie()){l=e.readCookie()}}var h="transparent";var m=k.getStyleConfig("color");var c=($tx.gecko||$tx.opera?"hilitecolor":"backcolor");var j=function(n){var p=n?n.split("|")[0]:null;var o=(n&&n.indexOf("|")>-1)?n.split("|")[1]:null;k.execute(function(q){if(k.canHTML()){if(p==null){q.execCommand(c,h);q.execCommand("forecolor",m)}else{q.execCommand(c,p);if(o){q.execCommand("forecolor",o)}}}else{k.execute(function(r){r.insertTag('<span style="background-color: '+p+';" >',"</span>")})}});if(p){$tx.setStyle(e.button.elButton,{backgroundColor:p})}if(d){e.writeCookie(n)}};this.weave.bind(this)(new Trex.Button.Splits(Object.extend(this.buttonCfg,{selectedValue:l})),new Trex.Menu.ColorPallete(this.menuCfg),j);$tx.setStyle(e.button.elButton,{backgroundColor:l.split("|")[0]})
}});TrexConfig.addTool("alignleft",{sync:true,status:true,radio:true});Trex.Tool.AlignLeft=Trex.Class.create({$const:{__Identity:"alignleft"},$extend:Trex.Tool,$mixins:[Trex.I.AlignExecution],oninitialized:function(d){var a=this;var c=this.toolbar;var k=this.canvas;var j="left";var e="none";var l="none";a.imageAlignMode=false;var h=function(){k.execute(function(m){if(a.imageAlignMode){a.executeAlignImageMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_IMG_LEFT)}else{a.executeAlignTextMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_LEFT)}});k.syncProperty()};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,h);k.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){if(a.imageAlignMode){_data=k.query(function(o){var m=a.queryTextAlign(o);if(m==j){var n=a.queryImageFloat(o);n=n||"none";return(n==e)}else{return false}});a.button.setState(_data)}else{_data=k.query(function(o){var m=a.queryControlAlign(o);if(m==null){var n=a.queryTextAlign(o);return(n==j)}else{return(m==j)}});a.button.setState(_data)
}});k.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:188},h);Trex.Tool.AlignLeft.__ImageModeProps={paragraph:{align:null,style:{textAlign:j}},image:{style:{clear:l,"float":e,marginLeft:"",marginRight:""}}};Trex.Tool.AlignLeft.__TextModeProps={paragraph:{align:null,style:{textAlign:j}}}}});TrexConfig.addTool("aligncenter",{sync:true,status:true,radio:true});Trex.Tool.AlignCenter=Trex.Class.create({$const:{__Identity:"aligncenter"},$extend:Trex.Tool,$mixins:[Trex.I.AlignExecution],oninitialized:function(d){var a=this;var c=this.toolbar;var k=this.canvas;var j="center";var e="none";var l="none";a.imageAlignMode=false;var h=function(){k.execute(function(m){if(a.imageAlignMode){a.executeAlignImageMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_IMG_CENTER)}else{a.executeAlignTextMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_CENTER)}});k.syncProperty()};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,h);k.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){if(a.imageAlignMode){_data=k.query(function(o){var m=a.queryTextAlign(o);
if(m==j){var n=a.queryImageFloat(o);n=n||"none";return(n==e)}else{return false}});a.button.setState(_data)}else{_data=k.query(function(o){var m=a.queryControlAlign(o);if(m==null){var n=a.queryTextAlign(o);return(n==j)}else{return(m==j)}});a.button.setState(_data)}});k.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:190},h);Trex.Tool.AlignCenter.__ImageModeProps={paragraph:{align:null,style:{textAlign:j}},image:{style:{clear:l,"float":e}}};Trex.Tool.AlignCenter.__TextModeProps={paragraph:{align:null,style:{textAlign:j}}}}});TrexConfig.addTool("alignright",{sync:true,status:true,radio:true});Trex.Tool.AlignRight=Trex.Class.create({$const:{__Identity:"alignright"},$extend:Trex.Tool,$mixins:[Trex.I.AlignExecution],oninitialized:function(d){var a=this;var c=this.toolbar;var k=this.canvas;var j="right";var e="left";var l="both";a.imageAlignMode=false;var h=function(){k.execute(function(m){if(a.imageAlignMode){a.executeAlignImageMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_IMG_FLOAT_LEFT)
}else{a.executeAlignTextMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_RIGHT)}});k.syncProperty()};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,h);k.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){if(a.imageAlignMode){var m=k.query(function(o){var n=a.queryImageFloat(o);return(n==e)});a.button.setState(m)}else{var m=k.query(function(p){var n=a.queryControlAlign(p);if(n==null){var o=a.queryTextAlign(p)||"left";return(o==j)}else{return(n==j)}});a.button.setState(m)}});k.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:191},h);Trex.Tool.AlignRight.__ImageModeProps={image:{style:{clear:l,"float":e}}};Trex.Tool.AlignRight.__TextModeProps={paragraph:{align:null,style:{textAlign:j}}}}});TrexConfig.addTool("alignfull",{sync:true,status:true,radio:true});Trex.Tool.AlignFull=Trex.Class.create({$const:{__Identity:"alignfull"},$extend:Trex.Tool,$mixins:[Trex.I.AlignExecution],oninitialized:function(d){var a=this;var c=this.toolbar;var k=this.canvas;var j="justify";var e="right";
var l="both";a.imageAlignMode=false;var h=function(){k.execute(function(m){if(a.imageAlignMode){a.executeAlignImageMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_IMG_FLOAT_RIGHT)}else{a.executeAlignTextMode(m);c.fireJobs(Trex.Ev.__CMD_ALIGN_FULL)}});k.syncProperty()};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,h);k.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){if(a.imageAlignMode){var m=k.query(function(o){var n=a.queryImageFloat(o);return(n==e)});a.button.setState(m)}else{var m=k.query(function(p){var n=a.queryControlAlign(p);if(n==null){var o=a.queryTextAlign(p)||"left";return(o==j)}else{return(n==j)}});a.button.setState(m)}});Trex.Tool.AlignFull.__ImageModeProps={image:{style:{clear:l,"float":e}}};Trex.Tool.AlignFull.__TextModeProps={paragraph:{align:null,style:{textAlign:j}}}}});TrexConfig.addTool("lineheight",{sync:false,status:true,options:[{label:"50%",title:"50%",data:"0.5"},{label:"80%",title:"80%",data:"0.8"},{label:"100%",title:"100%",data:"1.0"},{label:"120%",title:"120%",data:"1.2"},{label:"150%",title:"150%",data:"1.5"},{label:"180%",title:"180%",data:"1.8"},{label:"200%",title:"200%",data:"2.0"}]});
Trex.Tool.LineHeight=Trex.Class.create({$const:{__Identity:"lineheight"},$extend:Trex.Tool,oninitialized:function(c){var l=this.toolbar;var k=this.canvas;var h=k.getStyleConfig().lineHeight;var j=(c.options||[]);var d={};j.each(function(n){d[n.data]=n.title});var e=function(n){k.execute(function(o){var p=o.blocks(function(q){return"%paragraph"});o.apply(p,{style:{lineHeight:n}})})};this.weave.bind(this)(new Trex.Button.Select(TrexConfig.merge(this.buttonCfg,{selectedValue:h})),new Trex.Menu.Select(this.menuCfg),e);var a=h;var m=function(){var n=k.query(function(p){var o=p.findNode("%paragraph");return p.queryStyle(o,"lineHeight")});n=n||h;if(a==n){return}this.button.setText(n);a=n}.bind(this)}});TrexMessage.addMsg({"@styledlist.subtitle1":"\ucde8\uc18c","@styledlist.subtitle2":"\ub3d9\uadf8\ub77c\ubbf8","@styledlist.subtitle3":"\ub124\ubaa8","@styledlist.subtitle4":"\uc22b\uc790","@styledlist.subtitle5":"\ub85c\ub9c8\uc22b\uc790","@styledlist.subtitle6":"\uc54c\ud30c\ubcb3"});TrexConfig.addTool("styledlist",{sync:false,status:true,options:[{label:TXMSG("@styledlist.subtitle1"),title:"cancel",type:"cancel",data:"cancel",klass:"tx-styledlist-0"},{label:TXMSG("@styledlist.subtitle2"),title:"disc",type:"ul",data:"disc",klass:"tx-styledlist-1"},{label:TXMSG("@styledlist.subtitle3"),title:"square",type:"ul",data:"square",klass:"tx-styledlist-2"},{label:TXMSG("@styledlist.subtitle4"),title:"decimal",type:"ol",data:"decimal",klass:"tx-styledlist-3"},{label:TXMSG("@styledlist.subtitle5"),title:"upper-roman",type:"ol",data:"upper-roman",klass:"tx-styledlist-4"},{label:TXMSG("@styledlist.subtitle6"),title:"upper-alpha",type:"ol",data:"upper-alpha",klass:"tx-styledlist-5"}]});
Trex.Tool.StyledList=Trex.Class.create({$const:{__Identity:"styledlist"},$extend:Trex.Tool,$mixins:[Trex.I.ListExecution],oninitialized:function(d){var h=this;var m=this.toolbar;var l=this.canvas;var k="decimal";var e={};d.options.each(function(o){e[o.data]={type:o.type,klass:o.klass}});var a=function(o){if(e[o]){return e[o].klass}else{return e[k].klass}};var j=function(q){if(!e[q]){return}var p=e[q].type;var o=e[q].klass;var r={style:{listStyleType:q}};l.execute(function(t){if(p=="cancel"){h.executeOffList(t)}else{h.executeToList(t,p,r)}})};var n=function(){var o=l.query(function(q){return !!q.findNode("%listhead")});var p=$tom.collect(h.menu.elMenu,"li");if(o){$tx.show(p)}else{$tx.hide(p)}};this.weave.bind(this)(new Trex.Button.StyledList(this.buttonCfg),new Trex.Menu.Select(this.menuCfg),j,n);var c=k;l.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var o=l.query(function(r){var q=r.findNode("%listhead");return r.queryStyle(q,"listStyleType")});o=o||k;if(c==o){return}var p=a(o);
h.button.setText(p);c=o});l.observeKey({ctrlKey:true,altKey:true,shiftKey:false,keyCode:85},j.bind(this,"disc"));l.observeKey({ctrlKey:true,altKey:true,shiftKey:false,keyCode:79},j.bind(this,"decimal"))}});Trex.Button.StyledList=Trex.Class.create({$extend:Trex.Button.Select,setText:function(a){this.elIcon.className="tx-icon "+a}});TrexConfig.addTool("ordered",{radio:true,sync:true,status:true});Trex.Tool.OrderedList=Trex.Class.create({$const:{__Identity:"ordered"},$extend:Trex.Tool,$mixins:[Trex.I.ListExecution],oninitialized:function(d){var a=this;var j=this.canvas;var c=this.toolbar;var e=function(){c.tools.unordered.button.normalState();j.execute(function(l){var k=l.findNode("%listhead");if(k){if($tom.kindOf(k,"ol")){a.executeOffList(l)}else{a.executeToList(l,"ol",{})}}else{a.executeToList(l,"ol",{})}})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,e);var h=null;j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var k=j.query(function(l){return l.queryCommandState("insertorderedlist")
});if(h==k){return}a.button.setState(k);h=k});j.observeKey({ctrlKey:true,altKey:true,shiftKey:false,keyCode:79},e)}});TrexConfig.addTool("unordered",{radio:true,sync:true,status:true});Trex.Tool.UnorderedList=Trex.Class.create({$const:{__Identity:"unordered"},$extend:Trex.Tool,$mixins:[Trex.I.ListExecution],oninitialized:function(d){var a=this;var j=this.canvas;var c=this.toolbar;var e=function(){c.tools.ordered.button.normalState();j.execute(function(l){var k=l.findNode("%listhead");if(k){if($tom.kindOf(k,"ul")){a.executeOffList(l)}else{a.executeToList(l,"ul",{})}}else{a.executeToList(l,"ul",{})}})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,e);var h=null;j.observeJob(Trex.Ev.__CANVAS_PANEL_QUERY_STATUS,function(){var k=j.query(function(l){return l.queryCommandState("insertunorderedlist")});if(h==k){return}a.button.setState(k);h=k});j.observeKey({ctrlKey:true,altKey:true,shiftKey:false,keyCode:85},e)}});TrexConfig.addTool("indent",{sync:false,status:false});Trex.Tool.Indent=Trex.Class.create({$const:{__Identity:"indent"},$extend:Trex.Tool,$mixins:[Trex.I.IndentExecution],oninitialized:function(c){var a=this;
var h=this.canvas;var d=function(){h.execute(function(j){a.executeIndentParagraph(j)})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,d);var e=function(){h.execute(function(j){a.executeIndentByKeyEvent(j)})};h.observeKey({ctrlKey:false,altKey:false,shiftKey:false,keyCode:9},e)}});TrexConfig.addTool("outdent",{sync:false,status:false});Trex.Tool.Outdent=Trex.Class.create({$const:{__Identity:"outdent"},$extend:Trex.Tool,$mixins:[Trex.I.IndentExecution],oninitialized:function(c){var a=this;var h=this.canvas;var d=function(){h.execute(function(j){a.executeOutdentParagraph(j)})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,d);var e=function(){h.execute(function(j){a.executeOutdentByKeyEvent(j)})};h.observeKey({ctrlKey:false,altKey:false,shiftKey:true,keyCode:9},e)}});TrexConfig.addTool("link",{wysiwygonly:true,sync:false,status:true});TrexMessage.addMsg({"@insertlink.cancel.image":"#iconpath/btn_cancel.gif?rv=1.0.1","@insertlink.confirm.image":"#iconpath/btn_confirm.gif?rv=1.0.1","@insertlink.invalid.url":"'HTTP://'\ub85c \uc2dc\uc791\ud558\ub294 URL\uc744 \uc785\ub825\ud574\uc8fc\uc2ed\uc2dc\uc624.","@insertlink.link.alt":"[#{title}]\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4.","@insertlink.remove.image":"#iconpath/btn_remove.gif?rv=1.0.1","@insertlink.title":"\uc120\ud0dd\ub41c \ubd80\ubd84\uc5d0 \uac78\ub9b4 URL\uc8fc\uc18c\ub97c \ub123\uc5b4\uc8fc\uc138\uc694.","@insertlink.onclick.target":"\ud074\ub9ad \uc2dc","@insertlink.target.blank":"\uc0c8 \ucc3d","@insertlink.target.self":"\ud604\uc7ac\ucc3d"});
Trex.Tool.Link=Trex.Class.create({$const:{__Identity:"link"},$extend:Trex.Tool,oninitialized:function(h){var a=this;var e=this.toolbar;var l=this.canvas;var j=function(m){if(l.canHTML()){if(m){l.execute(function(n){var q={href:m.link,target:m.target?m.target:"_blank"};if(n.findNode("a")){var p=n.findNode("a");$tom.applyAttributes(p,q)}else{if(n.hasControl()){var o=n.controls(function(){return"img"});$tom.wrap(n.create("a",q),o)}else{if(n.isCollapsed()){var p=n.create("a",q);p.innerHTML=m.link;n.pasteNode(p,false)}else{var o=n.inlines(function(){return"%text,img,a,%inline"});o.each(function(r){if($tom.hasChildren(r,true)){if($tom.kindOf(r,"a")){$tom.applyAttributes(r,q)}else{if($tom.kindOf(r,"img")){$tom.wrap(n.create("a",q),[r])}else{var u=$tom.getStyleText(r);var w=$tom.collectAll(r,"a");w.each(function(x){$tom.moveChildToParent(x);$tom.remove(x)});var t=n.create("a",q);$tom.setStyleText(t,u);$tom.replace(r,t)}}}else{$tom.remove(r)}})}}}})}else{l.execute(function(o){var n=o.findNode("a");
if(n){o.unwrap(n)}})}}else{l.execute(function(n){n.insertTag('<a href="'+m.link+'" target="'+m.target+'" >',"</a>")})}};var d="";var c=function(m){if(l.canHTML()){return l.query(function(q){var p=q.findNode("a");if(p){var o=$tom.getAttribute(p,"href");var n=$tom.getAttribute(p,"target");if(o!=null&&o.length>0){q.selectAround(p);return{exist:true,value:o,target:n}}}return{exist:false,value:d}})}else{return{exist:false,value:d}}};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.Link(this.menuCfg),j,c);var k=function(){a.button.onMouseDown()};l.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:75},k)}});Trex.MarkupTemplate.add("menu.insertlink",['<div class="tx-menu-inner">',"    <dl>","        <dt>","            @insertlink.title","        </dt>","        <dd>",'            <input type="text" class="tx-text-input"/>',"        </dd>",'        <dd class="tx-rp">','            <span class="tx-text tx-first">@insertlink.onclick.target</span>','            <span><input type="radio" name="tx-insertlink-win" value="_blank"/><span class="tx-text">@insertlink.target.blank</span></span>','            <span><input type="radio" name="tx-insertlink-win" value="_self"/><span class="tx-text">@insertlink.target.self</span></span>',"        </dd>",'        <dd class="tx-hr">',"            <hr/>","        </dd>","        <dd>",'            <img width="32" height="21" src="@insertlink.confirm.image"/>','            <img width="32" height="21" src="@insertlink.cancel.image"/>','            <img width="51" height="21" src="@insertlink.remove.image" style="display: none;"/>',"        </dd>","    </dl>","</div>"].join(""));
Trex.Menu.Link=Trex.Class.create({$extend:Trex.Menu,ongenerated:function(){var k=this.elMenu;Trex.MarkupTemplate.get("menu.insertlink").evaluateToDom({},k);var a=$tom.collectAll(k,".tx-rp input");var c=this.newInput=a[0];$tx.observe(c,"click",function(m){c.checked="checked";h.checked=""});var h=this.currInput=a[1];$tx.observe(h,"click",function(m){h.checked="checked";c.checked=""});var e=function(m){if(!m){return false}else{if(m.length==0){return false}}if(!/http[s]?:\/\//.test(m)){return"http://"+m}else{return m}};var j=this.elInput=$tom.collect(k,"input.tx-text-input");$tx.observe(j,"keydown",function(n){if(n.keyCode==13){var o=e(j.value);if(!o){alert(TXMSG("@insertlink.invalid.url"));$tx.stop(n);return}var m=c.checked?c.value:h.value;this.onSelect(n,{link:o,target:m});$tx.stop(n)}}.bindAsEventListener(this));var l=$tom.collectAll(k,"img");$tx.observe(l[0],"click",function(n){var o=e(j.value);if(!o){alert(TXMSG("@insertlink.invalid.url"));$tx.stop(n);return}var m=c.checked?c.value:h.value;
this.onSelect(n,{link:o,target:m});$tx.stop(n)}.bind(this));$tx.observe(l[1],"click",function(){this.onCancel()}.bindAsEventListener(this));var d=$tx(l[2]);$tx.observe(d,"click",function(m){this.onSelect(m,null)}.bindAsEventListener(this));this.toggleRemoveBtn=function(m){d.style.display=((m)?"":"none")}},onregenerated:function(){var c=this.elInput;var a=this.initHandler();c.value=a.value;if(a.target=="_self"){this.currInput.checked="checked";this.newInput.checked=""}else{this.newInput.checked="checked";this.currInput.checked=""}this.toggleRemoveBtn(a.exist);c.focus();if($tx.msie){setTimeout(function(){c.focus();var d=document.selection.createRange();d.move("character",c.value.length);d.select()},100)}}});TrexConfig.addTool("textbox",{sync:false,status:true,rows:4,cols:6,options:Trex.__CONFIG_COMMON.textbox.options});Trex.Tool.TextBox=Trex.Class.create({$const:{__Identity:"textbox"},$extend:Trex.Tool,oninitialized:function(c){var e=this.canvas;var a=this.toolbar;var h={};c.options.each(function(j){h[j.data]=j.style
});var d=function(l){if(!h[l]){return}var j=h[l];if(e.canHTML()){var k="div";var m={className:"txc-textbox",style:j};e.execute(function(o){var p=o.blocks(function(q){return"%wrapper,%paragraph"});p=p.select(function(q){if($tom.kindOf(q,"%innergroup")){o.wrap($tom.children(q),k,m);return false}else{return true}});var n=o.wrap(p,k,m);a.fireJobs("cmd.textbox.added",n)})}else{e.execute(function(n){n.insertTag('<div class="txc-textbox">',"</div>")})}};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.List(this.menuCfg),d)}});TrexConfig.addTool("quote",{sync:false,status:true,rows:2,cols:3,options:[{type:"image",data:"tx-quote1",image:"#iconpath/citation01.gif?rv=1.0.1"},{type:"image",data:"tx-quote2",image:"#iconpath/citation02.gif?rv=1.0.1"},{type:"image",data:"tx-quote3",image:"#iconpath/citation03.gif?rv=1.0.1"},{type:"image",data:"tx-quote4",image:"#iconpath/citation04.gif?rv=1.0.1"},{type:"image",data:"tx-quote5",image:"#iconpath/citation05.gif?rv=1.0.1"},{type:"cancel",data:"tx-quote6",image:"#iconpath/citation06.gif?rv=1.0.1"}]},function(a){var c=TrexConfig.getTool("quote",a);
c.options.each(function(d){d.image=TrexConfig.getIconPath(d.image,"quote")})});Trex.Tool.Quote=Trex.Class.create({$const:{__Identity:"quote"},$extend:Trex.Tool,oninitialized:function(c){var a=this;var h=this.canvas;var j={};c.options.each(function(k){j[k.data]={type:k.type}});var d=function(m){if(!j[m]){return}var l=j[m].type;var k="blockquote";var n={className:m};if(h.canHTML()){h.execute(function(p){var o=p.findNode(k);if(o){if(l=="cancel"){p.unwrap(o)}else{p.apply(o,n)}}else{if(l!="cancel"){var q=p.blocks(function(r){return"%wrapper,%paragraph"});q=q.select(function(r){if($tom.kindOf(r,"%innergroup")){p.wrap($tom.children(r),k,n);return false}else{return true}});p.wrap(q,k,n)}}})}else{h.execute(function(o){o.insertTag("<blockquote>","</blockquote>")})}};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.List(this.menuCfg),d);var e=function(){a.button.onMouseDown()};h.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:81},e)}});TrexConfig.addTool("table",{sync:false,status:true},function(c){var a=TrexConfig.get("canvas",c).styles.backgroundColor;
if(a!="transparent"){TrexConfig.getTool("table",c).bgcolor=a}});TrexMessage.addMsg({"@table.alert":"1 \uc774\uc0c1 99 \uc774\ud558\uc758 \uc22b\uc790\ub9cc \uc785\ub825 \uac00\ub2a5\ud569\ub2c8\ub2e4."});Trex.Tool.Table=Trex.Class.create({$const:{__Identity:"table",__DEFAULT_TABLE_PROPERTY:{cellSpacing:0,cellPadding:1,border:0,style:{border:"none",borderCollapse:"collapse"}},__DEFAULT_TABLE_PROPERTY_STR:'cellspacing="0" cellpadding="0" border="0" style="border:none;border-collapse:collapse;"',__DEFAULT_BORDER_STYLE:"1px solid #000",__DEFAULT_TABLE_CLASS:"txc-table"},$extend:Trex.Tool,oninitialized:function(c){var a=this;this.tableSize={row:0,col:0};var e=this.canvas;this.config=c;var d=function(j){var h=a.makeEmptyTable(j.row,j.col);e.execute(function(l){var k=l.pasteContent(h,true);l.bookmarkInto(k)})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.Table(this.menuCfg),d)},makeEmptyTable:function(o,a){var n=[];var l=this._createDefaultTableWidth();n.push('<table class="'+Trex.Tool.Table.__DEFAULT_TABLE_CLASS+'" width="'+l+'" ');
n.push(Trex.Tool.Table.__DEFAULT_TABLE_PROPERTY_STR);n.push("><tbody>");var m=Trex.Tool.Table.__DEFAULT_BORDER_STYLE;var k=parseInt(100/a)+"%";var c=["border-bottom:",m,";border-right:",m,";"].join("");for(var h=0;h<o;h++){n.push("<tr>");for(var e=0;e<a;e++){var d=[c];n.push('<td style="width:');n.push(k);n.push(";");n.push(c);if(h==0){n.push("border-top:",m,";")}if(e==0){n.push("border-left:",m,";")}n.push(';">&nbsp;</td>\n')}n.push("</tr>\n")}n.push("</tbody></table>");return n.join("")},_createDefaultTableWidth:function(){var a=this.config.tableWidth;if(!a){var c=this.canvas.getSizeConfig().contentPadding||8;var a=(this.canvas.getSizeConfig().contentWidth||600)-c*2}return a}});Trex.Tool.Table.TemplateWizard=Trex.Class.create({initialize:function(){this.templateList=(typeof getTableTemplateList=="function")?getTableTemplateList():[{klass:"ex1",common:{backgroundColor:"transparent",borderTop:"none",borderLeft:"none",borderRight:"1px solid #d9d9d9",borderBottom:"1px solid #d9d9d9"},firstRow:{borderTop:"1px solid #000"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{},oddRow:{}}];
this.currentTemplate=null},applyStyle:function(h,e){if(isNaN(e)){return}var d=new Trex.Tool.Table.TableCellMatrixer(h);var k=d.getTdMatrix();this.currentTemplate=this.templateList[e];for(var c=0;c<k.length;c++){for(var a=0;a<k[c].length;a++){this.setCellStyle(k[c][a],{isEvenRow:(c%2)==1,isFirstRow:c==0,isLastRow:c==k.length-1,isFirstCol:a==0,isLastCol:(a==k[c].length-1)})}}},setCellStyle:function(c,a){var d=this.currentTemplate;var e=Object.extend({},d.common);Object.extend(e,(a.isEvenRow)?d.evenRow:d.oddRow);Object.extend(e,(a.isFirstRow)?d.firstRow:(a.isLastRow)?d.lastRow:{});Object.extend(e,(a.isLastCol)?d.lastCol:{});Object.extend(e,(a.isFirstCol)?d.firstCol:{});txlib.setStyle(c,e)},getTemplateList:function(){return this.templateList}});Trex.Tool.Table.TableCellMatrixer=Trex.Class.create({initialize:function(e){this.rowSize=this.initRowSize(e);this.colSize=this.initColSize(e);var d=$tom.first(e,"tbody")||e;this.tdMatrix=this.createTdMatrix(d);for(var c=0;c<this.tdMatrix.length;c++){for(var a=0;
a<this.tdMatrix[c].length;a++){var h=this.tdMatrix[c][a];if(h.cols>1){h.cols--;this.tdMatrix[c].splice(a+1,0,h)}}}for(var c=0;c<this.tdMatrix.length;c++){for(var a=0;a<this.tdMatrix[c].length;a++){var h=this.tdMatrix[c][a];if(h.rows>1){h.rows--;this.tdMatrix[c+1].splice(a,0,h)}}}},createTdMatrix:function(c){var e=[];var h=$tom.children(c,"tr");for(var d=0,a=h.length;d<a;d++){e.push(this.createTdArray(h[d]))}return e},createTdArray:function(h){var e=[];var d=$tom.children(h,"td");for(var c=0,a=d.length;c<a;c++){e.push(this.decorateSingleTd(d[c]))}return e},decorateSingleTd:function(d){var c=parseInt(d.getAttribute("colSpan")||1);var a=parseInt(d.getAttribute("rowSpan")||1);d.cols=c;d.rows=(a-1)*c+1;return d},initRowSize:function(a){return a.rows.length},initColSize:function(c){var a=0;var d=$tom.children($tom.collect(c,"tr"),"td");d.each(function(h){var e=parseInt(h.getAttribute("colSpan")||1);a+=e});return a},getRowSize:function(){return this.rowSize},getColSize:function(){return this.colSize
},getTdMatrix:function(){return this.tdMatrix}});TrexMessage.addMsg({"@table.title.insert":"\ud45c\uc0bd\uc785 &nbsp;","@table.title.setDirectly":"\ud45c \uc9c1\uc811\uc124\uc815","@table.title.row":"\uc5f4 \uac1c\uc218","@table.title.col":"\ud589 \uac1c\uc218"});Trex.MarkupTemplate.add("menu.table.direct",["<div>@table.title.setDirectly</div>",'<div class="tx-table-input-area">','<div class="tx-field tx-col-field">@table.title.row<input type="text" value="1"><a class="tx-btn tx-btn-add" href="javascript:;">@table.title.row+</a><a class="tx-btn tx-btn-sub" href="javascript:;">@table.title.row-</a></div>','<div class="tx-field tx-row-field">@table.title.col<input type="text" value="1"><a class="tx-btn tx-btn-add" href="javascript:;">@table.title.col+</a><a class="tx-btn tx-btn-sub" href="javascript:;">@table.title.col-</a></div>',"</div>"].join(""));Trex.Menu.Table=Trex.Class.create({$const:{MAX_ROW:99,MAX_COL:99},$extend:Trex.Menu,ongenerated:function(a){this.rowSize=1;this.colSize=1;this.elInnerPreview=$tom.collect(this.elMenu,"div.tx-menu-inner .tx-menu-preview");
this.dynamicSizer=this.generateDynamicSizer(this.elInnerPreview);this.elInnerRowCol=$tom.collect(this.elMenu,"div.tx-menu-inner .tx-menu-rowcol");this.generateTextSizer(this.elInnerRowCol);this.elButtonArea=$tom.collect(this.elMenu,"div.tx-menu-inner .tx-menu-enter");this.generateButtonArea(this.elButtonArea)},onregenerated:function(){this.showDynamicSizer()},showDynamicSizer:function(){this.dynamicSizer.clear();$tx.show(this.elInnerPreview);$tx.hide(this.elInnerRowCol);$tx.hide(this.elButtonArea)},showTextSizer:function(){$tx.hide(this.elInnerPreview);$tx.show(this.elInnerRowCol);$tx.show(this.elButtonArea)},generateDynamicSizer:function(e){var c=this;var k=tx.span();var h=tx.div({className:"tx-dynamic-sizer-display"},TXMSG("@table.title.insert"),k);e.appendChild(h);var j=new Trex.DynamicSizer({el:e,clickHandler:this.onSelect.bind(this),moveHandler:function(m,l){k.innerHTML=m+"x"+l}});var a=tx.a({href:"javascript:;"},TXMSG("@table.title.setDirectly"));$tx.observe(a,"click",function(l){c.showTextSizer();
$tx.stop(l)});var d=tx.div({className:"tx-more-button"});d.appendChild(a);e.appendChild(d);return j},generateTextSizer:function(c){var a=this;Trex.MarkupTemplate.get("menu.table.direct").evaluateToDom({},c);var e={calculate:function(l,j,k){l=parseInt(l);if(l+k>j||l+k<1){alert(TXMSG("@table.alert"));return l}else{return l+k}},getValidValue:function(l,k,j){if(l<0||l>j){alert(TXMSG("@table.alert"));return k}else{return l}}};var d=$tom.collect(c,"div.tx-col-field input");$tx.observe(d,"blur",function(){d.value=a.colSize=e.getValidValue(d.value,a.colSize,Trex.Menu.Table.MAX_COL)});$tx.observe($tom.collect(c,"div.tx-col-field a.tx-btn-add"),"click",function(){d.value=a.colSize=e.calculate(a.colSize,Trex.Menu.Table.MAX_COL,1);return false});$tx.observe($tom.collect(c,"div.tx-col-field a.tx-btn-sub"),"click",function(){d.value=a.colSize=e.calculate(a.colSize,Trex.Menu.Table.MAX_COL,-1);return false});var h=$tom.collect(c,"div.tx-row-field input");$tx.observe(h,"blur",function(){h.value=a.rowSize=e.getValidValue(h.value,a.rowSize,Trex.Menu.Table.MAX_ROW)
});$tx.observe($tom.collect(c,"div.tx-row-field a.tx-btn-add"),"click",function(){h.value=a.rowSize=e.calculate(a.rowSize,Trex.Menu.Table.MAX_ROW,1);return false});$tx.observe($tom.collect(c,"div.tx-row-field a.tx-btn-sub"),"click",function(){h.value=a.rowSize=e.calculate(a.rowSize,Trex.Menu.Table.MAX_ROW,-1);return false})},generateButtonArea:function(d){var a=this;var e=tx.div();var h=tx.a({href:"javascript:;",className:"tx-btn-confirm"},"\ud655\uc778");var c=tx.a({href:"javascript:;",className:"tx-btn-cancel"},"\ucde8\uc18c");$tx.observe(h,"click",function(j){a.onSelect(j,{row:a.rowSize,col:a.colSize})});$tx.observe(c,"click",function(){this.onCancel();return false}.bindAsEventListener(this));e.appendChild(h);e.appendChild(c);d.appendChild(e)}});TrexMessage.addMsg({"@emoticon.subtitle.person":"\uc0ac\ub78c","@emoticon.subtitle.animal":"\ub3d9\uc2dd\ubb3c","@emoticon.subtitle.thing":"\uc0ac\ubb3c","@emoticon.subtitle.etc":"\uae30\ud0c0"});TrexConfig.addTool("emoticon",{sync:false,status:true,rows:5,cols:7,matrices:[{title:TXMSG("@emoticon.subtitle.person"),klass:"tx-menu-matrix-per",options:["#decopath/per_01.gif?rv=1.0.1","#decopath/per_02.gif?rv=1.0.1","#decopath/per_03.gif?rv=1.0.1","#decopath/per_04.gif?rv=1.0.1","#decopath/per_05.gif?rv=1.0.1","#decopath/per_06.gif?rv=1.0.1","#decopath/per_07.gif?rv=1.0.1","#decopath/per_08.gif?rv=1.0.1","#decopath/per_09.gif?rv=1.0.1","#decopath/per_10.gif?rv=1.0.1","#decopath/per_11.gif?rv=1.0.1","#decopath/per_12.gif?rv=1.0.1","#decopath/per_13.gif?rv=1.0.1","#decopath/per_14.gif?rv=1.0.1","#decopath/per_15.gif?rv=1.0.1","#decopath/per_16.gif?rv=1.0.1","#decopath/per_17.gif?rv=1.0.1","#decopath/per_18.gif?rv=1.0.1","#decopath/per_19.gif?rv=1.0.1","#decopath/per_20.gif?rv=1.0.1","#decopath/per_21.gif?rv=1.0.1","#decopath/per_22.gif?rv=1.0.1","#decopath/per_23.gif?rv=1.0.1","#decopath/per_24.gif?rv=1.0.1","#decopath/per_25.gif?rv=1.0.1","#decopath/per_26.gif?rv=1.0.1","#decopath/per_27.gif?rv=1.0.1","#decopath/per_28.gif?rv=1.0.1","#decopath/per_29.gif?rv=1.0.1"]},{title:TXMSG("@emoticon.subtitle.animal"),klass:"tx-menu-matrix-ani",options:["#decopath/ani_01.gif?rv=1.0.1","#decopath/ani_02.gif?rv=1.0.1","#decopath/ani_03.gif?rv=1.0.1","#decopath/ani_04.gif?rv=1.0.1","#decopath/ani_05.gif?rv=1.0.1","#decopath/ani_06.gif?rv=1.0.1","#decopath/ani_07.gif?rv=1.0.1","#decopath/ani_08.gif?rv=1.0.1","#decopath/ani_09.gif?rv=1.0.1","#decopath/ani_10.gif?rv=1.0.1","#decopath/ani_11.gif?rv=1.0.1","#decopath/ani_12.gif?rv=1.0.1","#decopath/ani_13.gif?rv=1.0.1","#decopath/ani_14.gif?rv=1.0.1","#decopath/ani_15.gif?rv=1.0.1","#decopath/ani_16.gif?rv=1.0.1","#decopath/ani_17.gif?rv=1.0.1","#decopath/ani_18.gif?rv=1.0.1","#decopath/ani_19.gif?rv=1.0.1","#decopath/ani_20.gif?rv=1.0.1","#decopath/ani_21.gif?rv=1.0.1","#decopath/ani_22.gif?rv=1.0.1","#decopath/ani_23.gif?rv=1.0.1","#decopath/ani_24.gif?rv=1.0.1","#decopath/ani_25.gif?rv=1.0.1","#decopath/ani_26.gif?rv=1.0.1","#decopath/ani_27.gif?rv=1.0.1","#decopath/ani_28.gif?rv=1.0.1"]},{title:TXMSG("@emoticon.subtitle.thing"),klass:"tx-menu-matrix-things",options:["#decopath/things_01.gif?rv=1.0.1","#decopath/things_02.gif?rv=1.0.1","#decopath/things_03.gif?rv=1.0.1","#decopath/things_04.gif?rv=1.0.1","#decopath/things_05.gif?rv=1.0.1","#decopath/things_06.gif?rv=1.0.1","#decopath/things_07.gif?rv=1.0.1","#decopath/things_08.gif?rv=1.0.1","#decopath/things_09.gif?rv=1.0.1","#decopath/things_10.gif?rv=1.0.1","#decopath/things_11.gif?rv=1.0.1","#decopath/things_12.gif?rv=1.0.1","#decopath/things_13.gif?rv=1.0.1","#decopath/things_14.gif?rv=1.0.1","#decopath/things_15.gif?rv=1.0.1","#decopath/things_16.gif?rv=1.0.1","#decopath/things_17.gif?rv=1.0.1","#decopath/things_18.gif?rv=1.0.1","#decopath/things_19.gif?rv=1.0.1","#decopath/things_20.gif?rv=1.0.1","#decopath/things_21.gif?rv=1.0.1","#decopath/things_22.gif?rv=1.0.1","#decopath/things_23.gif?rv=1.0.1","#decopath/things_24.gif?rv=1.0.1","#decopath/things_25.gif?rv=1.0.1","#decopath/things_26.gif?rv=1.0.1","#decopath/things_27.gif?rv=1.0.1","#decopath/things_28.gif?rv=1.0.1","#decopath/things_29.gif?rv=1.0.1","#decopath/things_30.gif?rv=1.0.1","#decopath/things_31.gif?rv=1.0.1","#decopath/things_32.gif?rv=1.0.1","#decopath/things_33.gif?rv=1.0.1","#decopath/things_34.gif?rv=1.0.1","#decopath/things_35.gif?rv=1.0.1"]},{title:TXMSG("@emoticon.subtitle.etc"),klass:"tx-menu-matrix-etc",options:["#decopath/etc_01.gif?rv=1.0.1","#decopath/etc_02.gif?rv=1.0.1","#decopath/etc_03.gif?rv=1.0.1","#decopath/etc_04.gif?rv=1.0.1","#decopath/etc_05.gif?rv=1.0.1","#decopath/etc_06.gif?rv=1.0.1","#decopath/etc_07.gif?rv=1.0.1","#decopath/etc_08.gif?rv=1.0.1","#decopath/etc_09.gif?rv=1.0.1","#decopath/etc_10.gif?rv=1.0.1","#decopath/etc_11.gif?rv=1.0.1","#decopath/etc_12.gif?rv=1.0.1","#decopath/etc_13.gif?rv=1.0.1","#decopath/etc_14.gif?rv=1.0.1","#decopath/etc_15.gif?rv=1.0.1","#decopath/etc_16.gif?rv=1.0.1","#decopath/etc_17.gif?rv=1.0.1","#decopath/etc_18.gif?rv=1.0.1","#decopath/etc_19.gif?rv=1.0.1","#decopath/etc_20.gif?rv=1.0.1","#decopath/etc_21.gif?rv=1.0.1","#decopath/etc_22.gif?rv=1.0.1","#decopath/etc_23.gif?rv=1.0.1","#decopath/etc_24.gif?rv=1.0.1","#decopath/etc_25.gif?rv=1.0.1","#decopath/etc_26.gif?rv=1.0.1","#decopath/etc_27.gif?rv=1.0.1","#decopath/etc_28.gif?rv=1.0.1","#decopath/etc_29.gif?rv=1.0.1"]}]},function(a){var c=TrexConfig.getTool("emoticon",a);
c.matrices.each(function(e){for(var h=0,d=e.options.length;h<d;h++){e.options[h]=TrexConfig.getDecoPath(e.options[h],"emoticon")}})});Trex.Tool.Emoticon=Trex.Class.create({$const:{__Identity:"emoticon"},$extend:Trex.Tool,oninitialized:function(a){var d=this.canvas;var c=function(e){if(!e||e.trim().length==0){return}d.execute(function(j){var h=j.win.img({src:e,border:"0",className:"txc-emo"});j.pasteNode(h,false)})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.Matrix(this.menuCfg),c)}});TrexConfig.addTool("redo",{sync:false,status:false});Trex.Tool.ReDo=Trex.Class.create({$const:{__Identity:"redo"},$extend:Trex.Tool,oninitialized:function(a){var d=this.canvas;var c=function(){d.getProcessor().blur();d.focus();setTimeout(function(){d.fireJobs("canvas.panel.redo")},0)};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,c);d.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:89},function(){d.fireJobs("canvas.panel.redo");d.syncProperty("redo")})}});TrexConfig.addTool("undo",{sync:false,status:false});
Trex.Tool.UnDo=Trex.Class.create({$const:{__Identity:"undo"},$extend:Trex.Tool,oninitialized:function(a){var d=this.canvas;var c=function(){d.getProcessor().blur();d.focus();setTimeout(function(){d.fireJobs("canvas.panel.undo")},20)};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,c);d.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:90},function(){d.fireJobs("canvas.panel.undo");d.syncProperty("undo")})}});TrexConfig.addTool("horizontalrule",{wysiwygonly:true,sync:false,status:true,top:null,left:null,options:[{data:"tx-hr-border-1",image:"#iconpath/line01.gif?rv=1.0.2",html:'<hr style="border: black 0px none; border-top: black 1px solid; height: 1px"/>'},{data:"tx-hr-border-2",image:"#iconpath/line02.gif?rv=1.0.2",html:'<hr style="border: black 0px none; border-top: black 1px solid; border-bottom: black 3px solid; height: 7px"/>'},{data:"tx-hr-border-3",image:"#iconpath/line04.gif?rv=1.0.2",html:'<hr style="border: black 0px none; border-top: black 1px dotted; height: 1px"/>'},{data:"tx-hr-image-1",image:"#iconpath/line03.gif?rv=1.0.2",html:'<div style="background: url(#decopath/line03.gif?rv=1.0.1) repeat-x scroll left;  width: 99%; height: 15px"><hr style="border: black 0px none; left: -999px; position: relative; top: -999px"></div>'},{data:"tx-hr-image-2",image:"#iconpath/line05.gif?rv=1.0.2",html:'<div style="background: url(#decopath/line05.gif?rv=1.0.1) repeat-x scroll left;  width: 99%; height: 15px"><hr style="border: black 0px none; left: -999px; position: relative; top: -999px"></div>'},{data:"tx-hr-image-3",image:"#iconpath/line06.gif?rv=1.0.2",html:'<div style="background: url(#decopath/line06.gif?rv=1.0.1) repeat-x scroll left;  width: 99%; height: 15px"><hr style="border: black 0px none; left: -999px; position: relative; top: -999px"></div>'},{data:"tx-hr-image-4",image:"#iconpath/line07.gif?rv=1.0.2",html:'<div style="background: url(#decopath/line08.gif?rv=1.0.1) repeat-x scroll left;  width: 99%; height: 15px"><hr style="border: black 0px none; left: -999px; position: relative; top: -999px"></div>'}]},function(a){var c=TrexConfig.getTool("horizontalrule",a);
c.options.each(function(d){d.image=TrexConfig.getIconPath(d.image,"horizontalrule");if(d.html){d.html=TrexConfig.getDecoPath(d.html,"horizontalrule")}})});Trex.Tool.HorizontalRule=Trex.Class.create({$const:{__Identity:"horizontalrule"},$extend:Trex.Tool,oninitialized:function(a){var e=this.canvas;var h={};a.options.each(function(j){h[j.data]={html:j.html}});var c=function(k){if(!h[k]){return}var j=h[k];if(e.canHTML()){e.execute(function(l){l.pasteContent(j.html,true)})}else{e.execute(function(l){l.insertTag("",j.html)})}};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.List(this.menuCfg),c);var d=this.button.onClick.bindAsEventListener(this.button);e.observeKey({ctrlKey:false,altKey:true,shiftKey:false,keyCode:($tx.msie?189:109)},d)}});TrexMessage.addMsg({"@specialchar.subtitle1":"\uc77c\ubc18\uae30\ud638","@specialchar.subtitle2":"\uc218\ud559\ubd80\ud638, \ud1b5\ud654\ub2e8\uc704","@specialchar.subtitle3":"\uc6d0 \uae30\ud638, \uad04\ud638","@specialchar.subtitle4":"\uc77c\ubcf8\uc5b4","@specialchar.subtitle5":"\ub85c\ub9c8\uc790, \uadf8\ub9ac\uc2a4"});
TrexConfig.addTool("specialchar",{sync:false,status:true,rows:9,cols:20,top:null,left:null,matrices:[{title:TXMSG("@specialchar.subtitle1"),options:["\uff03","\uff06","\uff0a","\uff20","\xa7","\u203b","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u2192","\u2190","\u2191","\u2193","\u2194","\u3013","\u25c1","\u25c0","\u25b7","\u25b6","\u2664","\u2660","\u2661","\u2665","\u2667","\u2663","\u2299","\u25c8","\u25a3","\u25d0","\u25d1","\u2592","\u25a4","\u25a5","\u25a8","\u25a7","\u25a6","\u25a9","\u2668","\u260f","\u260e","\u261c","\u261e","\xb6","\u2020","\u2021","\u2195","\u2197","\u2199","\u2196","\u2198","\u266d","\u2669","\u266a","\u266c","\u327f","\u321c","\u2116","\u33c7","\u2122","\u33c2","\u33d8","\u2121","\xae","\xaa","\xba","\uff02","\uff08","\uff09","\uff3b","\uff3d","\uff5b","\uff5d","\u2018","\u2019","\u201c","\u201d","\u3014","\u3015","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff01","\uff07","\uff0c","\uff0e","\uff0f","\uff1a","\uff1b","\uff1f","\uff3e","\uff3f","\uff40","\uff5c","\uffe3","\u3001","\u3002","\xb7","\u2025","\u2026","\xa8","\u3003","\u2015","\u2225","\uff3c","\u223c","\xb4","\uff5e","\u02c7","\u02d8","\u02dd","\u02da","\u02d9","\xb8","\u02db","\xa1","\xbf","\u02d0"]},{title:TXMSG("@specialchar.subtitle2"),options:["\uff0b","\uff0d","\uff1c","\uff1d","\uff1e","\xb1","\xd7","\xf7","\u2260","\u2264","\u2265","\u221e","\u2234","\u2642","\u2640","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2227","\u2228","\uffe2","\u21d2","\u21d4","\u2200","\u2203","\u222e","\u2211","\u220f\uff04","\uff05","\uffe6","\uff26","\u2032","\u2033","\u2103","\u212b","\uffe0","\uffe1","\uffe5","\xa4","\u2109","\u2030","?","\u3395","\u3396","\u3397","\u2113","\u3398","\u33c4","\u33a3","\u33a4","\u33a5","\u33a5","\u33a6","\u3399","\u339a","\u339b","\u339c","\u339d","\u339e","\u339f","\u33a0","\u33a1","\u33a2","\u33ca","\u338d","\u338e","\u338f","\u33cf","\u3388","\u3389","\u33c8","\u33a7","\u33a8","\u33b0","\u33b1","\u33b2","\u33b3","\u33b4","\u33b5","\u33b6","\u33b7","\u33b8","\u33b9","\u3380","\u3381","\u3382","\u3383","\u3384","\u33ba","\u33bb","\u33bc","\u33bd","\u33be","\u33bf","\u3390","\u3391","\u3392","\u3393","\u3394","\u2126","\u33c0","\u33c1","\u338a","\u338b","\u338c","\u33d6","\u33c5","\u33ad","\u33ae","\u33af","\u33db","\u33a9","\u33aa","\u33ab","\u33ac","\u33dd","\u33d0","\u33d3","\u33c3","\u33c9","\u33dc","\u33c6"]},{title:TXMSG("@specialchar.subtitle3"),options:["\u3260","\u3261","\u3262","\u3263","\u3264","\u3265","\u3266","\u3267","\u3268","\u3269","\u326a","\u326b","\u326c","\u326d","\u326e","\u326f","\u3270","\u3271","\u3272","\u3273","\u3274","\u3275","\u3276","\u3277","\u3278","\u3279","\u327a","\u327b","\u3200","\u3201","\u3202","\u3203","\u3204","\u3205","\u3206","\u3207","\u3208","\u3209","\u320a","\u320b","\u320c","\u320d","\u320e","\u320f","\u3210","\u3211","\u3212","\u3213","\u3214","\u3215","\u3216","\u3217","\u3218","\u3219","\u321a","\u321b","\u24d0","\u24d1","\u24d2","\u24d3","\u24d4","\u24d5","\u24d6","\u24d7","\u24d8","\u24d9","\u24da","\u24db","\u24dc","\u24dd","\u24de","\u24df","\u24e0","\u24e1","\u24e2","\u24e3","\u24e4","\u24e5","\u24e6","\u24e7","\u24e8","\u24e9","\u2460","\u2461","\u2462","\u2463","\u2464","\u2465","\u2466","\u2467","\u2468","\u2469","\u246a","\u246b","\u246c","\u246d","\u246e","\u249c","\u249d","\u249e","\u249f","\u24a0","\u24a1","\u24a2","\u24a3","\u24a4","\u24a5","\u24a6","\u24a7","\u24a8","\u24a9","\u24aa","\u24ab","\u24ac","\u24ad","\u24ae","\u24af","\u24b0","\u24b1","\u24b2","\u24b3","\u24b4","\u24b5","\u2474","\u2475","\u2476","\u2477","\u2478","\u2479","\u247a","\u247b","\u247c","\u247d","\u247e","\u247f","\u2480","\u2481","\u2482"]},{title:TXMSG("@specialchar.subtitle4"),options:["\u3041","\u3042","\u3043","\u3044","\u3045","\u3046","\u3047","\u3048","\u3049","\u304a","\u304b","\u304c","\u304d","\u304e","\u304f","\u3050","\u3051","\u3049","\u3053","\u3054","\u3055","\u3056","\u3057","\u3058","\u3059","\u305a","\u305b","\u305c","\u305d","\u305e","\u305f","\u3060","\u3061","\u3062","\u3063","\u3064","\u3065","\u3066","\u3067","\u3068","\u3069","\u306a","\u306b","\u306c","\u306d","\u306e","\u306f","\u3070","\u3071","\u3072","\u3073","\u3074","\u3075","\u3076","\u3077","\u3078","\u3079","\u307a","\u307b","\u307c","\u307d","\u307e","\u307f","\u3080","\u3081","\u3082","\u3083","\u3084","\u3085","\u3086","\u3087","\u3088","\u3089","\u308a","\u308b","\u308c","\u308d","\u308e","\u308f","\u3090","\u3091","\u3092","\u3093","\u30a1","\u30a2","\u30a3","\u30a4","\u30a5","\u30a6","\u30a7","\u30a8","\u30a9","\u30aa","\u30ab","\u30ac","\u30ad","\u30ae","\u30af","\u30b0","\u30b1","\u30b2","\u30b3","\u30b4","\u30b5","\u30b6","\u30b7","\u30b8","\u30b9","\u30ba","\u30bb","\u30bc","\u30bd","\u30be","\u30bf","\u30c0","\u30c1","\u30c2","\u30c3","\u30c4","\u30c5","\u30c6","\u30c7","\u30c8","\u30c9","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d0","\u30d1","\u30d2","\u30d3","\u30d4","\u30d5","\u30d6","\u30d7","\u30d8","\u30d9","\u30da","\u30db","\u30dc","\u30dd","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e3","\u30e4","\u30e5","\u30e6","\u30e7","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ee","\u30ef","\u30f0","\u30f1","\u30f2","\u30f3","\u30f4","\u30f5","\u30f6"]},{title:TXMSG("@specialchar.subtitle5"),options:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19","\u2170","\u2171","\u2172","\u2173","\u2174","\u2175","\u2176","\u2177","\u2178","\u2179","\u2160","\u2161","\u2162","\u2163","\u2164","\u2165","\u2166","\u2167","\u2168","\u2169","\u0391","\u0392","\u0393","\u0394","\u0395","\u0396","\u0397","\u0398","\u0399","\u039a","\u039b","\u039c","\u039d","\u039e","\u039f","\u03a0","\u03a1","\u03a3","\u03a4","\u03a5","\u03a6","\u03a7","\u03a8","\u03a9","\u03b1","\u03b2","\u03b3","\u03b4","\u03b5","\u03b6","\u03b7","\u03b8","\u03b9\u03ba","\u03bb","\u03bc","\u03bd","\u03be","\u03bf","\u03c0","\u03c1","\u03c3","\u03c4","\u03c5","\u03c6","\u03c7","\u03c8","\u03c9"]}]});
TrexMessage.addMsg({"@specialchar.cancel.image":"#iconpath/btn_l_cancel.gif?rv=1.0.1","@specialchar.confirm.image":"#iconpath/btn_l_confirm.gif?rv=1.0.1","@specialchar.title":"\uc120\ud0dd\ud55c \uae30\ud638"});Trex.Tool.SpecialChar=Trex.Class.create({$const:{__Identity:"specialchar"},$extend:Trex.Tool,oninitialized:function(a){var d=this.canvas;var c=function(e){if(!e){return}d.execute(function(h){h.pasteContent(e,false)})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.SpecialChar(this.menuCfg),c)}});Trex.MarkupTemplate.add("menu.specialchar.input",['<dl class="tx-menu-matrix-input">',"	<dt><span>@specialchar.title</span></dt>",'	<dd><input type="text" value=""/></dd>','	<dd><img class="tx-menu-btn-confirm" src="@specialchar.confirm.image" align="absmiddle"/></dd>','	<dd><img class="tx-menu-btn-cancel" src="@specialchar.cancel.image" align="absmiddle"/></dd>',"</dl>"].join(""));Trex.Menu.SpecialChar=Trex.Class.create({$extend:Trex.Menu.Matrix,ongenerated:function(c){var e=this.elMenu;
var a=Trex.MarkupTemplate.get("menu.specialchar.input").evaluateAsDom({});$tom.append($tom.collect(e,"div.tx-menu-inner"),a);var d=this.elInput=$tom.collect(a,"input");var h=$tom.collectAll(a,"img");if(h.length==2){$tx.observe(h[0],"click",function(){this._command(this.elInput.value);this.hide()}.bind(this));$tx.observe(h[1],"click",function(){this.onCancel()}.bind(this))}$tx.observe(d,"keydown",function(j){if(j.keyCode==13){$tx.stop(j);this._command(this.elInput.value);this.hide()}}.bind(this))},onregenerated:function(a){this.elInput.value="";this.elInput.focus()},onSelect:function(c){var a=$tx.findElement(c,"span");if(a.tagName&&a.tagName.toLowerCase()!="span"){return}this.elInput.value+=(!a.innerText||a.innerText=="&nbsp;"||a.innerText.trim()=="")?"":a.innerText;$tx.stop(c)}});TrexConfig.addTool("dictionary",{url:"http://engdic.daum.net/dicen/small_view_top.do",sync:false,status:false});Trex.Tool.Dictionary=Trex.Class.create({$const:{__Identity:"dictionary"},$extend:Trex.Tool,oninitialized:function(a){var d=this.canvas;
var c=function(){var j=d.query(function(k){return encodeURI(k.getText())});var e=(j.length>0)?"http://engdic.daum.net/dicen/small_search.do":a.url;var h=window.open(e+"?q="+j,"dicWin","width=410,height=550,scrollbars=yes");h.focus()};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,c)}});TrexConfig.addTool("background",{wysiwygonly:true,sync:false,status:true,thumbs:Trex.__CONFIG_COMMON.thumbs});Trex.Tool.Background=Trex.Class.create({$const:{__Identity:"background"},$extend:Trex.Tool,oninitialized:function(a){var d=this.canvas;var c=function(e){d.addStyle({backgroundColor:e})};this.weave.bind(this)(new Trex.Button(this.buttonCfg),new Trex.Menu.ColorPallete(this.menuCfg),c)}});Trex.install("canvas.getBgColor & canvas.setBgColor & editor.getContentWithBg",function(e,h,j,d,c){d.getBgColor=function(){var k=d.getPanel("html").getStyle("backgroundColor");if(k){return Trex.Color.getHexColor(k)}else{return""}};d.setBgColor=function(k){d.getPanel("html").addStyle({backgroundColor:k||"transparent"})
};e.getContentWithBg=function(){var k=d.getBgColor().toLowerCase();if(k=="transparent"){return e.getContent()}else{return['<table class="txc-wrapper" border="0" cellspacing="0" cellpadding="0"><tr>','<td bgcolor="',k,'">',e.getContent(),"</td>","</tr></table>"].join("")}};var a=d.initContent.bind(d);d.initContent=function(l){if(l.search(/<table[^>]*txc-wrapper[^>]*>/i)>-1){var k;l=l.replace(/<table[^>]*txc-wrapper[^>]*><tr><td([^>]*)>([\s\S]*?)<\/td><\/tr><\/table>/i,function(o,m,n){k=m.replace(/\sbgcolor="([#\w]*)"/,"$1");return n});d.setBgColor(k)}a(l)}});TrexConfig.addTool("advanced",{sync:false,status:true,opened:false});Trex.Tool.Advanced=Trex.Class.create({$const:{__Identity:"advanced"},$extend:Trex.Tool,oninitialized:function(c){var j=this.canvas;var a=this.toolbar;var k=a.el;var h=$tom.collect(k.parentNode,"div.tx-toolbar-advanced");if(!h){return}a.observeJob("toolbar.advanced.fold",function(){$tx.hide(h);$tx.removeClassName(k,"tx-toolbar-basic-open")});a.observeJob("toolbar.advanced.spread",function(){$tx.show(h);
$tx.addClassName(k,"tx-toolbar-basic-open")});var e=false;var d=function(){if(e){a.fireJobs("toolbar.advanced.fold")}else{a.fireJobs("toolbar.advanced.spread")}e=!e};this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,d);if(c.opened==true){h.show();$tx.addClassName(k,"tx-toolbar-basic-open");e=true}}});Trex.module("add drop-down menu button if extra buttons exist.",function(e,h,j,d,c){var a=0;var k=function(n){var m=$tom.next(n,".tx-extra-menu");if(!m){return}var l=new (function(){this.identity="extra"+(++a);this.wysiwygonly=true;this.canvas=d;this.toolbar=h})();Trex.Tool.prototype.weave.bind(l)(new Trex.Button({el:n,sync:false,status:true}),new Trex.Menu({el:m}),function(){});h.tools[l.identity]=l};d.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(){var l=$tom.collectAll(e.getWrapper(),"li.tx-list-extra div.tx-extra");if(l.length==0){return}l.each(k)})});TrexConfig.addTool("fullscreen",{wysiwygonly:false,status:false,switched:false,minHeight:200,minWidth:766});TrexMessage.addMsg({"@fullscreen.attach.close.btn":"\ud30c\uc77c\ucca8\ubd80\ubc15\uc2a4","@fullscreen.noti.btn":"\uc77c\ubc18 \uae00\uc4f0\uae30\ub85c","@fullscreen.noti.span":"\ub113\uac8c\uc4f0\uae30 \ubc84\ud2bc\uc744 \ub2e4\uc2dc \ub204\ub974\uc2dc\uba74 \ucc98\uc74c \uae00\uc4f0\uae30 \ucc3d \ud06c\uae30\ub85c \ub3cc\uc544\uac11\ub2c8\ub2e4."});
Trex.Tool.FullScreen=Trex.Class.create({$const:{__Identity:"fullscreen"},$extend:Trex.Tool,oninitialized:function(d){var k=this.editor;var j=k.getCanvas();var a=k.getAttachBox();var h=k.getWrapper();if(!h){return}var c;var e=function(){if(!c){c=new Trex.FullScreen(k,d)}c.execute()};if(d.switched){if(!c){c=new Trex.FullScreen(k,d)}c.showFullScreen()}this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,e);j.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:77},e);k.observeKey({ctrlKey:true,altKey:false,shiftKey:false,keyCode:77},e)}});Trex.MarkupTemplate.add("fullscreen.notice",'<div class="tx-fullscreen-notice"><span>@fullscreen.noti.span</span><a href="#">@fullscreen.noti.btn</a></div>');Trex.MarkupTemplate.add("fullscreen.linebox",'<div class="tx-fullscreen-line">		<div class="tx-fullscreen-line-division">			<div class="tx-fullscreen-line-left">&nbsp;</div>			<div class="tx-fullscreen-line-right">&nbsp;</div>		</div>		<div class="tx-fullscreen-line-box">			<div class="tx-fullscreen-line-left">&nbsp;</div>			<div class="tx-fullscreen-line-right">&nbsp;</div>			<a href="#">@fullscreen.attach.close.btn</a>		</div>	</div>');
Trex.FullScreen=Trex.Class.create({initialize:function(c,a){if(!c){return}this.isInit=false;this.isFullScreen=false;this.wrapper=c.getWrapper();this.canvas=c.getCanvas();this.toolbar=c.getToolbar();this.attachBox=c.getAttachBox();this.elSavedHiddens=[];this.minHeight=a.minHeight;this.minWidth=a.minWidth;this.useAttachBox=(this.attachBox.elBox!==undefined);this.isAttachBoxDisplay=false;this.resizeHandler=this.resizeContainer.bind(this);this.toolbar.observeJob("toolbar.advanced.fold",function(){if(this.isFullScreen){this.resizeContainer()}}.bind(this));this.toolbar.observeJob("toolbar.advanced.spread",function(){if(this.isFullScreen){this.resizeContainer()}}.bind(this));if(typeof(showAttachBox)!="undefined"){this.showAttachBoxAtServiceForSave=showAttachBox}if(typeof(hideAttachBox)!="undefined"){this.hideAttachBoxAtServiceForSave=hideAttachBox}},execute:function(){if(this.isFullScreen){this.showNormalScreen()}else{this.showFullScreen()}},onAttachClick:function(){this.attachClickHandler(!this.isAttachBoxDisplay);
this.resizeContainer()},attachClickHandler:function(a){if(a){this.showAttachBox()}else{this.hideAttachBox()}},showNormalScreen:function(){if(!this.isFullScreen){return}document.documentElement.style.overflow="";document.body.style.overflow="";this.showNormalScreenAtService();var e=this.wrapper;if(!e){return}e.style.width="";$tx.removeClassName(e,"tx-editor-fullscreen");this.elSavedHiddens.each(function(h){h.style.visibility="visible"});if(parent){if(parent.parent){$tx.stopObserving(parent.parent,"resize",this.resizeHandler)}else{$tx.stopObserving(parent,"resize",this.resizeHandler)}}else{$tx.stopObserving(window,"resize",this.resizeHandler)}this.canvas.setCanvasSize({height:this.panelNormalHeight.toPx()});if(this.useAttachBox){this.attachClickHandler(this.attachBox.checkDisplay())}this.canvas.fireJobs("plugin.normalscreen.change");if(this.showAttachBoxAtServiceForSave){window.showAttachBox=this.showAttachBoxAtServiceForSave}if(this.hideAttachBoxAtServiceForSave){window.hideAttachBox=this.hideAttachBoxAtServiceForSave
}for(var c=0;c<this.relativeParents.length;c++){var a=this.relativeParents.pop();var d=this.relativeValues.pop();a.style.position=d}this.isFullScreen=false;if(!$tx.msie){setTimeout(function(){var h=$tom.collect($tx("tx_fullscreen"),"a");h.focus()}.bind(this),500)}},showFullScreen:function(){if(this.isFullScreen){return}if(!this.isInit){this.generate()}document.documentElement.style.overflow="hidden";document.documentElement.scrollTop=0;document.body.style.overflow="hidden";this.showFullScreenAtService();if(this.showAttachBoxAtServiceForSave){window.showAttachBox=function(){this.showAttachBox();this.resizeContainer()}.bind(this)}if(this.hideAttachBoxAtServiceForSave){window.hideAttachBox=function(){this.hideAttachBox();this.resizeContainer()}.bind(this)}var h=this.wrapper;if(!h){return}$tx.addClassName(h,"tx-editor-fullscreen");var j=[];["select","embed","object"].each(function(k){var l=$A(document.getElementsByTagName(k));l.each(function(m){m.style.visibility="hidden";j.push(m)})});this.elSavedHiddens=j;
if(this.useAttachBox){this.attachClickHandler(this.attachBox.checkDisplay())}var e=this.canvas.getCurrentPanel();this.panelNormalHeight=e.getPosition().height;if(d){if(d.parent){$tx.observe(d.parent,"resize",this.resizeHandler)}else{$tx.observe(d,"resize",this.resizeHandler)}}else{$tx.observe(window,"resize",this.resizeHandler)}this.canvas.fireJobs("plugin.fullscreen.change");window.wrapper=h;this.relativeParents=[];this.relativeValues=[];var d=h.offsetParent;while(d&&d.tagName&&d.tagName.toUpperCase()!="HTML"&&d.tagName.toUpperCase()!="BODY"){var a=(d.currentStyle)?d.currentStyle.position:window.getComputedStyle(d,null).getPropertyValue("position");if(a.toLowerCase()=="relative"){this.relativeParents.push(d);this.relativeValues.push(a);d.style.position="static"}d=d.offsetParent}this.isFullScreen=true;this.resizeContainer();if(!$tx.msie){var c=$tom.collect($tx("tx_fullscreen"),"a");c.focus()}},generate:function(){if(this.isInit){return}var h=this.wrapper;if(!h){return}var c=Trex.MarkupTemplate.get("fullscreen.notice").evaluateAsDom({});
$tom.insertFirst(h,c);var l=$tom.collect(c,"a");$tx.observe(l,"click",function(){if(this.isFullScreen){this.showNormalScreen()}else{this.showFullScreen()}}.bind(this));var d=this.canvas.elContainer;var a=Trex.MarkupTemplate.get("fullscreen.linebox").evaluateAsDom({});$tom.insertNext(a,d);var k={className:"tx-fullscreen-line-box"};if($tx.msie_ver=="5.5"){k.align="center"}var j=$tom.collect(a,"div.tx-fullscreen-line-box");if($tx.msie_ver=="5.5"){j.align="center"}var e=this.elLineBtn=$tom.collect(j,"a");$tx.observe(e,"click",this.onAttachClick.bind(this));this.isInit=true},getAttachBoxPosition:function(){if(this.isAttachBoxDisplay){return $tom.getPosition(this.attachBox.elBox)}else{return{x:0,y:0,width:0,height:0}}},resizeContainer:function(){this.resizeScreenAtService();var c=this.canvas.getCanvasPos().y;var d=this.getAttachBoxPosition();var a=0;if(document.documentElement.clientHeight>0){a=document.documentElement.clientHeight-c-17}else{a=document.documentElement.offsetHeight-c-17}if(d.height>0){a-=d.height+20
}a=Math.max(a,this.minHeight);this.canvas.setCanvasSize({height:a.toPx()});var h=0;if(document.documentElement.clientWidth>0){h=document.documentElement.clientWidth}else{h=document.documentElement.offsetWidth}h=Math.max(h,this.minWidth);var e=this.wrapper;if(!e){return}e.style.width=h.toPx()},showAttachBox:function(){if(this.attachBox.useBox){$tx.addClassName(this.elLineBtn,"tx-attach-close");$tx.show(this.attachBox.elBox);this.isAttachBoxDisplay=true}},hideAttachBox:function(){if(this.attachBox.useBox){$tx.removeClassName(this.elLineBtn,"tx-attach-close");$tx.hide(this.attachBox.elBox);this.isAttachBoxDisplay=false}},showFullScreenAtService:function(){if(typeof(showFullScreen)!="undefined"){showFullScreen()}},showNormalScreenAtService:function(){if(typeof(showNormalScreen)!="undefined"){showNormalScreen()}},resizeScreenAtService:function(){if(typeof(resizeScreen)!="undefined"){resizeScreen()}}});TrexConfig.addTool("image",{wysiwygonly:true,sync:false,status:false});TrexMessage.addMsg({"@image.title":"\uc0ac\uc9c4"});
Trex.Tool.Image=Trex.Class.create({$const:{__Identity:"image"},$extend:Trex.Tool,oninitialized:function(a){var c=this.editor;this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,function(){c.getSidebar().getAttacher("image").execute()})}});TrexConfig.addAttacher("image",{multiple:true,multipleuse:false,checksize:false,boxonly:false,wysiwygonly:true,objattr:{},features:{left:250,top:65,width:600,height:310},popPageUrl:"#host#path/pages/popup/image.html"},function(a){var c=TrexConfig.getAttacher("image",a);c.popPageUrl=TrexConfig.getUrl(c.popPageUrl);c.features=TrexConfig.getPopFeatures(c.features)});Trex.Attacher.Image=Trex.Class.create({$const:{__Identity:"image"},$extend:Trex.Attacher,name:"image",title:TXMSG("@image.title"),canModified:false,canResized:true,oninitialized:function(a){},getKey:function(a){return a.imageurl},getDataForEntry:function(d){d.imageurl=this.encodeSpaceInUrl(d.imageurl);d.originalurl=this.encodeSpaceInUrl(d.originalurl);d.attachurl=this.encodeSpaceInUrl(d.attachurl);
if(!d.dispElId){d.dispElId=Trex.Util.getDispElId()}var a=((d.tmpSeq)?this.entryBox.syncSeq(d.tmpSeq):this.entryBox.newSeq());var c=Object.extend({dataSeq:a},d);return c},createEntry:function(c,a){return this.createAttachment(c,a)},encodeSpaceInUrl:function(a){if(!a){return}return a.replace(/ /g,"%20")},execAttach:function(d,c){var a=this.createEntry(this.getDataForEntry(d),c);a.execRegister()},execReload:function(e,d,c){var a=this.createEntry(this.getDataForEntry(e,d),c);a.execReload()}});Trex.Attachment.Image=Trex.Class.create({$const:{__Identity:"image"},$extend:Trex.Attachment,getFieldAttr:function(a){return{name:"tx_attach_image",value:[a.thumburl,a.imageurl,a.originalurl,a.exifurl,a.filename,a.filesize].join("|")}},getBoxAttr:function(c){var a=c.width?c.width+"x"+c.height+" / ":"";return{name:c.filename+" ("+a+c.filesize.toByteUnit()+")",image:c.thumburl}},getObjectAttr:function(c){var a=Object.extend({},this.actor.config.objattr);if(c.width){if(!a.width||a.width>c.width){a.width=c.width
}}else{a.width=null}if(c.height){if(!a.height||a.height>c.height){a.height=c.height}}else{a.height=null}return a},getObjectStyle:function(d){var c={};if(this.actor.config.objstyle){c=Object.extend(c,this.actor.config.objstyle)}if(d.imagealign){var a={L:Trex.Tool.AlignLeft,C:Trex.Tool.AlignCenter,FL:Trex.Tool.AlignRight,FR:Trex.Tool.AlignFull}[d.imagealign];if(a&&a.__ImageModeProps&&a.__ImageModeProps.image){c=Object.extend(c,a.__ImageModeProps.image["style"])}}return c},getParaStyle:function(c){var d=Object.extend({},this.actor.config.parastyle||this.actor.config.defaultstyle);if(c.imagealign){var a={L:Trex.Tool.AlignLeft,C:Trex.Tool.AlignCenter,FL:Trex.Tool.AlignRight,FR:Trex.Tool.AlignFull}[c.imagealign];if(a&&a.__ImageModeProps&&a.__ImageModeProps.paragraph){d=Object.extend(d,a.__ImageModeProps.paragraph["style"])}}return d},getSaveHtml:function(a){return'<img src="'+a.imageurl+'" class="tx-daum-image"/>'},getDispHtml:function(a){return'<img id="'+a.dispElId+'" src="'+a.imageurl+'" class="txc-image"/>'
},getDispText:function(a){return'<img src="'+a.imageurl+'" class="tx-daum-image"/>'},getRegLoad:function(a){return new RegExp('<(?:img|IMG)[^>]*src="?'+a.imageurl.getRegExp()+'"?[^>]*/?>',"gm")},getRegHtml:function(a){return new RegExp('<(?:img|IMG)[^>]*src="?'+a.imageurl.getRegExp()+'"?[^>]*/?>',"gm")},getRegText:function(a){return new RegExp('<(?:img|IMG)[^>]*src="?'+a.imageurl.getRegExp()+'"?[^>]*/?>',"gm")}});TrexConfig.addTool("file",{wysiwygonly:true,sync:false,status:false});TrexMessage.addMsg({"@file.title":"\ud30c\uc77c"});Trex.Tool.File=Trex.Class.create({$const:{__Identity:"file"},$extend:Trex.Tool,oninitialized:function(a){var c=this.editor;this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,function(){c.getSidebar().getAttacher("file").execute()})}});TrexConfig.addAttacher("file",{multiple:true,multipleuse:false,checksize:true,boxonly:false,wysiwygonly:false,features:{left:250,top:65,width:350,height:165},popPageUrl:"#host#path/pages/popup/file.html"},function(a){var c=TrexConfig.getAttacher("file",a);
c.popPageUrl=TrexConfig.getUrl(c.popPageUrl);c.features=TrexConfig.getPopFeatures(c.features)});Trex.Attacher.File=Trex.Class.create({$const:{__Identity:"file"},$extend:Trex.Attacher,name:"file",title:TXMSG("@file.title"),canModified:true,canResized:false,oninitialized:function(c){var d=this.config;var a=this.entryBox},getKey:function(a){return a.key||a.attachurl},getDataForEntry:function(h){if(!h.dispElId){h.dispElId=Trex.Util.getDispElId()}var a=((h.tmpSeq)?this.entryBox.syncSeq(h.tmpSeq):this.entryBox.newSeq());var e=h.filename.split(".").pop().toLowerCase();var c;switch(e){case"jpg":case"gif":case"png":case"bmp":c=h.attachurl.replace("/attach/","/thumbnail/");break;default:c=Trex.Util.thumburl(e)}var d=Object.extend({dataSeq:a,thumburl:c,prevurl:Trex.Util.prevurl(h.filename.split(".").pop().toLowerCase())},h);return d}});Trex.Attachment.File=Trex.Class.create({$const:{__Identity:"file"},$extend:Trex.Attachment,getFieldAttr:function(a){return{name:"tx_attach_file",value:[a.attachurl,a.filesize,a.filename].join("|")}
},getBoxAttr:function(h){var c=56;var d=h.filename;if(d.getRealLength()>c){var j=d.split(".");var e=j.pop();var a=j.join(".").cutRealLength(c-2);d=a+"."+e}return{name:d+" ("+h.filesize.toByteUnit()+")",image:h.thumburl}},getSaveHtml:function(a){return'<a href="'+a.attachurl+'"><img src="'+a.prevurl+'"/> '+a.filename+"</a>"},getDispHtml:function(a){return'<button id="'+a.dispElId+'" class="txc-file _tx-unresizable"><img src="'+a.prevurl+'" ld="'+a.attachurl+'"/> '+a.filename+"</button>"},getDispText:function(a){return"["+TXMSG("@file.title")+":"+a.dataSeq+"]"},getRegLoad:function(a){return new RegExp('<(?:a|A)\\s*href="?'+a.attachurl.getRegExp()+'[^"]*"?[^>]*><(?:img|IMG)[^>]*/?>[\\S\\s]*?</(?:a|A)>',"gm")},getRegHtml:function(a){return new RegExp('<(?:button|BUTTON)[^>]*id="?'+a.dispElId+'"?[^>]*>[\\S\\s]*?'+a.attachurl.getRegExp()+"[\\S\\s]*?</(?:button|BUTTON)>","gm")},getRegText:function(a){return new RegExp("\\["+TXMSG("@file.title")+":"+a.dataSeq+"\\]","gm")}});TrexConfig.addTool("media",{wysiwygonly:true,sync:false,status:false});
TrexMessage.addMsg({"@media.title":"\uba40\ud2f0\ubbf8\ub514\uc5b4","@media.prev.url":"#iconpath/spacer2.gif?rv=1.0.1","@media.prev.url.tvpot":"#iconpath/img_multi_tvpot.gif?rv=1.0.1","@media.prev.url.wmp":"#iconpath/spacer2.gif?rv=1.0.1"});Trex.Tool.Media=Trex.Class.create({$const:{__Identity:"media"},$extend:Trex.Tool,oninitialized:function(a){var c=this.editor;this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,function(){c.getSidebar().getEmbeder("media").execute()})}});TrexConfig.addEmbeder("media",{wysiwygonly:true,useCC:false,features:{left:250,top:65,width:440,height:258},popPageUrl:"#host#path/pages/popup/multimedia.html"},function(a){var c=a.sidebar.embeder.media;c.popPageUrl=TrexConfig.getUrl(c.popPageUrl);c.features=TrexConfig.getPopFeatures(c.features)});(function(){Trex.Embeder.Media=Trex.Class.create({$const:{__Identity:"media"},$extend:Trex.Embeder,name:"media",title:TXMSG("@media.title"),canResized:true,getCreatedHtml:function(n,m){var l=n.code||k(n.url);return h(l)
},getDataForEntry:function(m,l){}});Trex.register("filter > media ",function(n,o,p,m,l){n.getDocParser().registerFilter("filter/embeder/media",{"text@load":function(q){return q},"source@load":function(q){return h(q)},"html@load":function(q){return h(q)},text4save:function(q){return q},source4save:function(q){return d(q)},html4save:function(q){return d(q)},text2source:function(q){return q},text2html:function(q){return q},source2text:function(q){return q},source2html:function(q){return h(q)},html2text:function(q){return d(q)},html2source:function(q){return d(q)}})});function d(q){var n;var p=new RegExp("<(?:img|IMG)[^>]*txc-media[^>]*/?>","gim");var o=q;while((n=p.exec(o))!=null){var m=n[0];var l=c(m);if(!$tx.msie&&l.indexOf("$")>-1){l=l.replace(/\$/g,"$$$$")}q=q.replace(m,l)}return q}function h(t){if($tx.msie){t=t.replace(/(<object[^>]*>)((?:\n|.)*?)(<\/object>)/gi,function(w,y,x,u){x=x.replace(/<param[^>]*=[^\w]*wmode[^\w]+[^>]*>/i,"");x=x.replace(/<param[^>]*=[^\w]*play[^\w]+[^>]*>/i,"");
x='<param name="wmode" value="transparent" />'.concat(x);return y+x+u});t=t.replace(/(<embed)([^>]*)(><\/embed>|\/>)/gi,function(x,y,u,w){u=u.replace(/\s+wmode=["']?(widnow|opaque|transparent)["']?/i,"").concat(' wmode="transparent"');return y+u+w});return t}else{var o;var p=t;var m=new RegExp("<(?:script)[^>]*>[\\S\\s]*?(<(?:embed|EMBED)[^>]*src=[^>]*>)[\\S\\s]*?</(?:script)>","gim");while((o=m.exec(p))!=null){var l=o[0];var q=o[1];var n=l.replace(/<embed/i,"<xxembed");t=t.replace(l,n)}var r=new RegExp("<(?:object|OBJECT)[^>]*>[\\S\\s]*?(<(?:embed|EMBED)[^>]*src=[^>]*>)[\\S\\s]*?</(?:object|OBJECT)>","gim");while((o=r.exec(p))!=null){var l=o[0];var q=o[1];var n=e(l,q);t=t.replace(l,n)}r=new RegExp("<(?:embed|EMBED)[^>]*src=[^>]*(?:/?>|></(?:embed|EMBED)>)","gim");while((o=r.exec(p))!=null){var l=o[0];var q=o[0];var n=e(l,q);t=t.replace(l,n)}t=t.replace(/<xxembed/i,"<embed");return t}}function e(n,x){var m=Trex.Util.getAllAttributesFromEmbed(x);var q=m.src;var r=(m.width||" ").parsePx();
var t=(m.height||" ").parsePx();if(isNaN(r)||isNaN(t)){var y=j(q);r=y.width;t=y.height}var p="<embed";for(var o in m){p+=" "+o+'="'+m[o]+'"'}p+=">";var w=n.split(x);n=w[0]+p;for(var u=1;u<w.length;u++){n+=w[u]}var l=a(q);return'<img src="'+l.imageSrc+'" width="'+r+'" height="'+t+'" border="0" class="tx-entry-embed txc-media'+l.className+'" ld="'+encodeURIComponent(n)+'"/>'}function c(q){var l=Trex.Util.getAllAttributes(q);var p=l.ld;if(!p||p.length==0){return""}var n=l.width;var o=l.height;var r=decodeURIComponent(p);var w=r;if(r.indexOf("object")>-1||r.indexOf("OBJECT")>-1){var t;var x=new RegExp("<(?:embed|EMBED)[^>]*src=[^>]*(?:/?>|></(?:embed|EMBED)>)","gim");while((t=x.exec(r))!=null){w=t[0]}}l=Trex.Util.getAllAttributes(w);var m=l.src;var u=j(m);if(isNaN(n)){r=Trex.String.changeAttribute(r,"width",' width="'+u.width+'"')}else{r=Trex.String.changeAttribute(r,"width",' width="'+n+'"')}if(isNaN(o)){r=Trex.String.changeAttribute(r,"height",' height="'+u.height+'"')}else{r=Trex.String.changeAttribute(r,"height",' height="'+o+'"')
}return r}function k(m){var n=m.split(".").pop().split("?")[0].toLowerCase();var l=j(m);switch(n){case"swf":return'<embed src="'+m+"\" quality='high' type='application/x-shockwave-flash' allowfullscreen='true' pluginspage='http://www.macromedia.com/go/getflashplayer' width='"+l.width+"' height='"+l.height+"'></embed>";case"mp3":case"wma":case"asf":case"asx":case"mpg":case"mpeg":case"wmv":case"avi":return'<embed src="'+m+'" type="application/x-mplayer2" pluginspage="http://www.microsoft.com/Windows/MediaPlayer/" width=\''+l.width+"' height='"+l.height+"'></embed>";case"mov":return'<embed src="'+m+'" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/indext.html" width=\''+l.width+"' height='"+l.height+"'></embed>";case"jpg":case"bmp":case"gif":case"png":return'<img src="'+m+'" border="0"/>';default:return'<embed src="'+m+"\" width='"+l.width+"' height='"+l.height+"'></embed>"}}function j(m){var l,n;if(m.indexOf("api.bloggernews.media.daum.net/static/recombox1")>-1){l=400;
n=80}else{if(m.indexOf("flvs.daum.net/flvPlayer")>-1){l=502;n=399}else{var o=m.split(".").pop().split("?")[0].toLowerCase();switch(o){case"mp3":case"wma":case"asf":case"asx":l=280;n=45;break;case"mpg":case"mpeg":case"wmv":case"avi":l=320;n=285;break;default:l=400;n=300;break}}}return{width:l,height:n}}function a(n){var l="";var m="";if(n.indexOf("api.bloggernews.media.daum.net/static/recombox1")>-1){l="";m=TXMSG("@media.prev.url")}else{if(n.indexOf("flvs.daum.net/flvPlayer")>-1){l=" txc-media-tvpot";m=TXMSG("@media.prev.url.tvpot")}else{var o=n.split(".").pop().split("?")[0].toLowerCase();switch(o){case"mp3":case"wma":case"asf":case"asx":l=" txc-media-wmp";m=TXMSG("@media.prev.url.wmp");break;case"mpg":case"mpeg":case"wmv":case"avi":l=" txc-media-wmp";m=TXMSG("@media.prev.url.wmp");break;default:l="";m=TXMSG("@media.prev.url");break}}}return{className:l,imageSrc:m}}})();TrexMessage.addMsg({"@canvas.unload.message":"\uc9c0\uae08\uae4c\uc9c0 \uc791\uc131\ub41c \uae00\uc740 \uc548\uc804\ud558\uac8c \uc790\ub3d9 \uc800\uc7a5\ub418\uc5b4, \ud68c\uc6d0\ub2d8\uc774 \ub2e4\uc2dc \uae00\uc4f0\uae30 \ud558\uc2e4 \ub54c \ubd88\ub7ec\uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4.","@canvas.unload.message.at.modify":"\uc9c0\uae08\uae4c\uc9c0 \uc791\uc131\ub41c \uae00\uc740 \uc548\uc804\ud558\uac8c \uc790\ub3d9 \uc800\uc7a5\ub418\uc5b4, \ud68c\uc6d0\ub2d8\uc774 \ub2e4\uc2dc \uc218\uc815\ud558\uc2e4 \ub54c \ubd88\ub7ec\uc62c \uc218\uc788\uc2b5\ub2c8\ub2e4."});
Trex.install("editor.isDisableUnloadHandler & editor.setDisableUnloadHandler",function(d,e,h,c,a){var j=true;d.isDisableUnloadHandler=function(k){return j};d.setDisableUnloadHandler=function(){j=false}});Trex.module("observing beforeunload event",function(h,j,k,d,c){var a=c.events;var e=new Trex.Validator();$tx.observe(window,"beforeunload",function(l){d.fireJobs(Trex.Ev.__CANVAS_BEFORE_UNLOAD);if(h.isDisableUnloadHandler()){if(a.preventUnload){if(e.exists(d.getContent())){l.returnValue=TXMSG("@canvas.unload.message");return TXMSG("@canvas.unload.message")}}}},false)});TrexMessage.addMsg({"@align.image.align.center":"\uac00\uc6b4\ub370\uc815\ub82c","@align.image.align.full":"\uc624\ub978\ucabd\uae00\ud750\ub984","@align.image.align.left":"\uc67c\ucabd\uc815\ub82c","@align.image.align.right":"\uc67c\ucabd\uae00\ud750\ub984","@align.text.align.center":"\uac00\uc6b4\ub370\uc815\ub82c (Ctrl+.)","@align.text.align.full":"\uc591\ucabd\uc815\ub82c","@align.text.align.left":"\uc67c\ucabd\uc815\ub82c (Ctrl+,)","@align.text.align.right":"\uc624\ub978\ucabd\uc815\ub82c (Ctrl+/)"});
Trex.module("Register an eventhandler in order to change align icons upon toolbar when user click a specific image or not.",function(h,l,a,c,d){var e="tx-selected-image";var j=[l.tools.alignleft,l.tools.aligncenter,l.tools.alignright,l.tools.alignfull];var m=["txc-2image-c","txc-3image-c","txc-footnote","txc-jukebox","txc-movie","txc-gallery","txc-imazing","txc-map","txc-file","txc-emo","tx-entry-embed"];var k=function(n){var o=function(p,r,u){var t=null;var q=null;if(!t){t=$tom.find(p.button.elButton,"li")}if(!q){q=$tx(p.button.elIcon)}q.title=u;if(r=="image"){if(!$tx.hasClassName(t,e)){$tx.addClassName(t,e)}p.imageAlignMode=true}else{if($tx.hasClassName(t,e)){$tx.removeClassName(t,e)}p.imageAlignMode=false}};o(j[0],n,n=="image"?TXMSG("@align.image.align.left"):TXMSG("@align.text.align.left"));o(j[1],n,n=="image"?TXMSG("@align.image.align.center"):TXMSG("@align.text.align.center"));o(j[2],n,n=="image"?TXMSG("@align.image.align.right"):TXMSG("@align.text.align.right"));o(j[3],n,n=="image"?TXMSG("@align.image.align.full"):TXMSG("@align.text.align.full"))
};c.observeElement([{tag:"body"},{tag:"table"},{tag:"hr"}],function(){k("text")});c.observeElement({tag:"img"},function(o){var n=Trex.Util.getMatchedClassName(o,m);if(n){k("text")}else{if($tom.find(o,"button")){k("text")}else{k("image")}}})});Trex.module("make padding area inside Canvas with editor width",function(j,q,r,c,B){var e=c.getSizeConfig();var m=e.wrapWidth;var l=e.contentWidth;var h=e.contentPadding;if(m==l){return}var A=c.getStyleConfig().color;var a=(l==971)?5:0;var p=5;var o=16;var y;var d;var w;var n;var z;var u;var t=function(F){var C=Math.max(Math.ceil((m-l-a*2-o-2)/2),0);var D=h;var D=h;var E=h;if(F&&F.paddingTop>0){D=F.paddingTop}if(F&&F.paddingBottom>0){E=F.paddingBottom}return{panel:{paddingTop:(p+D).toPx(),paddingRight:(C+h+a).toPx(),paddingBottom:(p+E).toPx(),paddingLeft:(C+h+a).toPx()},emptyspace:{width:C.toPx(),right:(C+a+l).toPx()}}};var x=function(){$tx.hide(_elLeftSpace);$tx.hide(_elRightSpace)};var k=function(){$tx.show(_elLeftSpace);$tx.show(_elRightSpace)};
c.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(){y=c.wysiwygEl;n=c.getPanel(Trex.Canvas.__WYSIWYG_MODE);if(!n){return}z=n.getDocument();u=n.el;var D=n.getPanelHeight();var C=t();n.addStyle(C.panel);if(!$tx.msie){$tx.setStyle(u,{overflowX:"auto",overflowY:"scroll"})}_elLeftSpace=tx.div({className:"tx-wysiwyg-padding",style:{width:C.emptyspace.width,height:D,left:"0".toPx()}});_elLeftSpaceChild=tx.div({className:"tx-wysiwyg-padding-divL",style:{borderRight:"1px solid ",borderBottom:"1px solid ",borderColor:A}});_elLeftSpace.appendChild(_elLeftSpaceChild);y.insertBefore(_elLeftSpace,u);_elRightSpace=tx.div({className:"tx-wysiwyg-padding",style:{width:C.emptyspace.width,height:D,left:C.emptyspace.right}});_elRightSpaceChild=tx.div({className:"tx-wysiwyg-padding-divR",style:{borderLeft:"1px solid ",borderBottom:"1px solid ",borderColor:A}});_elRightSpace.appendChild(_elRightSpaceChild);y.insertBefore(_elRightSpace,u);n.getScrollTop=function(){return(z.documentElement.scrollTop||z.body.scrollTop)
};n.setScrollTop=function(E){if(z.documentElement.scrollTop){z.documentElement.scrollTop=E}else{z.body.scrollTop=E}};if(c.mode!="html"){x()}});c.observeJob(Trex.Ev.__CANVAS_MODE_CHANGE,function(D,C){if(D==C){return}if(D==Trex.Canvas.__WYSIWYG_MODE){x()}else{if(C==Trex.Canvas.__WYSIWYG_MODE){k()}}});c.observeJob(Trex.Ev.__CANVAS_HEIGHT_CHANGE,function(C){_elLeftSpace.style.height=C;_elRightSpace.style.height=C});c.observeJob("canvas.apply.background",function(E){var D={paddingTop:0,paddingBottom:0};if(E.topLeftImage){D.paddingTop=E.topLeftHeight.parsePx();D.paddingBottom=E.botLeftHeight.parsePx()}var C=t(D);n.addStyle(C.panel)});c.getCanvasGuideSize=function(){return t().emptyspace.width.parsePx()}});Trex.module("Register an eventhandler in order to block resizing and editing search results & some images in wysiwig panel.",function(h,j,k,d,c){if($tx.msie){var a=function(l){if(l.onresizestart==null){l.onresizestart=function(){return false}}};d.observeElement({tag:"img",klass:"_tx-unresizable"},a);
d.observeElement({tag:"img",klass:"tx-entry-attach"},a);d.observeElement({tag:"img",klass:"txc-footnote"},a);d.observeElement({tag:"iframe",klass:"txc-map"},a)}var e;if($tx.msie){e=function(l){l.setAttribute("unselectable","on");$A(l.getElementsByTagName("*")).each(function(n){if(n.nodeName.charAt(0)!="/"){n.setAttribute("unselectable","on")}});var m=d.getProcessor();m.selectControl(l)}}else{e=function(l){var m=d.getProcessor();m.selectControl(l);throw $stop}}d.observeElement({tag:"button"},e);d.observeElement({tag:"img"},function(l){var m=$tom.find(l,"button");if(m){e(m);throw $stop}})});Trex.module("in order to save history for image resizing on IE",function(k,l,a,d,e){var j=d.history;var c="";var h={};var m=null;d.observeJob(Trex.Ev.__CANVAS_PANEL_MOUSEDOWN,function(o){var n=$tx.element(o);if(n&&n.tagName&&n.tagName.toLowerCase()=="img"){m=n;h=$tom.getPosition(n)}});d.observeJob(Trex.Ev.__CANVAS_PANEL_MOUSEUP,function(q){if(m){var o=false;try{var p=$tom.getPosition(m);for(var n in p){if(p[n]!=h[n]){o=true
}}if(o){j.saveHistory()}}catch(r){}finally{m=null}}})});(function(){var d={getEventElement:function(h){var e=$tx.findElement(h,"td");if(e&&e.tagName&&e.tagName.toUpperCase()=="TD"){return e}else{return null}},getMaxCoord:function(j){var e=this.getXCoords(j);var h=this.getYCoords(j);return{x:e[e.length-1],y:h[h.length-1]}},getMinCoord:function(j){var e=this.getXCoords(j);var h=this.getYCoords(j);return{x:e[0],y:h[0]}},getYCoords:function(e){return this.getCoordsByKey(e,"row")},getXCoords:function(e){return this.getCoordsByKey(e,"col")},getCoordsByKey:function(k,h){var j=new RegExp(h+"(\\d+)","gim");var l=[];var e=k.getAttribute(h+"Class");e.trim().replace(j,function(n,o){l.push(o.toNumber())});return l},setSelect:function(e){$tx.setStyle(e,{backgroundImage:"url(http://icon.daum-img.net/editor/table_focus_50.png)"})},setUnselect:function(e){$tx.setStyle(e,{backgroundImage:""})},clearContent:function(e){e.setAttribute("unselectable","on");e.innerHTML="-"},clearCoords:function(e){e.setAttribute("colClass","");
e.setAttribute("rowClass","")},setCoords:function(h,p,e){var m=p+1;var n=this.getRowSpan(h);var j="row ".times(n).replace(/(row)/g,function(q,r){return r+(m++)});var k=e+1;var o=this.getColSpan(h);var l="col ".times(o).replace(/(col)/g,function(q,r){return r+(k++)});h.setAttribute("colClass",l);h.setAttribute("rowClass",j)},getColSpan:function(e){return parseInt(e.getAttribute("colSpan")||1)},getRowSpan:function(e){return parseInt(e.getAttribute("rowSpan")||1)}};var a={start:{x:-1,y:-1},top:-1,left:-1,bottom:-1,right:-1,init:function(e,h){this.start.x=this.left=this.right=e;this.start.y=this.top=this.bottom=h},clear:function(){this.top=this.left=this.bottom=this.right=this.start.x=this.start.y=-1},changeBoundary:function(e,h){this.top=Math.min(this.start.y,h);this.bottom=Math.max(this.start.y,h);this.left=Math.min(this.start.x,e);this.right=Math.max(this.start.x,e)},getRectCoord:function(){return{sx:this.left,sy:this.top,ex:this.right,ey:this.bottom}}};var c={canMerge:function(e,j){for(var h=e.sy;
h<e.ey+1;h++){if(d.getMinCoord(j[h][e.sx]).x-1!=e.sx||d.getMaxCoord(j[h][e.ex]).x-1!=e.ex){return false}}for(var h=e.sx;h<e.ex+1;h++){if(d.getMinCoord(j[e.sy][h]).y-1!=e.sy||d.getMaxCoord(j[e.ey][h]).y-1!=e.ey){return false}}return true},canSplit:function(h,k){var j=d.getMinCoord(k[h.sy][h.sx]);var e=d.getMinCoord(k[h.ey][h.ex]);return(j.x==e.x&&j.y==e.y&&j.x>0&&j.y>0)},isMergedCell:function(h,j){var e=d.getMaxCoord(j[h.sy][h.sx]);var k=d.getMinCoord(j[h.sy][h.sx]);if(e.x!=k.x||e.y!=k.y){return true}else{return false}},canRemoveRow:function(h,l){var e=h.sy;var m=h.ey;var k=l[0].length;for(var j=0;j<k;j++){if(e!=d.getMinCoord(l[h.sy][j]).y-1){return false}if(m!=d.getMaxCoord(l[h.ey][j]).y-1){return false}}return true},canRemoveCol:function(e,m){var l=e.sx;var k=e.ex;var j=m.length;for(var h=0;h<j;h++){if(l!=d.getMinCoord(m[h][e.sx]).x-1){return false}if(k!=d.getMaxCoord(m[h][e.ex]).x-1){return false}}return true},isAllRowSelected:function(e,h){return(h.length<=e.ey-e.sy+1)?true:false},isAllColSelected:function(e,h){return(h[0].length<=e.ex-e.sx+1)?true:false
},canAddUpperRow:function(j,h){for(var e=0;e<h[0].length;e++){if(h[j-1][e]==h[j][e]){return false}}return true},canAddBelowRow:function(j,h){for(var e=0;e<h[0].length;e++){if(h[j+1][e]==h[j][e]){return false}}return true},canAddLeftCol:function(e,j){for(var h=0;h<j.length;h++){if(j[h][e-1]==j[h][e]){return false}}return true},canAddRightCol:function(e,j){for(var h=0;h<j.length;h++){if(j[h][e+1]==j[h][e]){return false}}return true}};Trex.MarkupTemplate.add("table.edit",'<div class="tx-table-edit">		<ul class="tx-tab tx-tab-menu1">			<li><a href="javascript:;">\ud45c\uad6c\uc131</a></li>			<li><a href="javascript:;">\ub514\uc790\uc778</a></li>			<li><a href="javascript:;">\uc11c\uc2dd</a></li>		</ul>		<div class="tx-table-edit-layout">		<div class="tx-table-edit-layout-wrapper">			<div class="tx-table-edit-layout-insert">				<h4>\uc0bd\uc785</h4>				<ul class="tx-2cell">					<li class="tx-left"><a href="javascript:;" class="tx-up" title="\uc704\uc5d0 \ucd94\uac00">\uc704</a></li>					<li class="tx-right"><a href="javascript:;" class="tx-down" title="\uc544\ub798\uc5d0 \ucd94\uac00">\uc544\ub798</a></li>				</ul>				<ul class="tx-2cell">					<li class="tx-left"><a href="javascript:;" class="tx-left" title="\uc67c\ucabd\uc5d0 \ucd94\uac00">\uc67c\ucabd</a></li>					<li class="tx-right"><a href="javascript:;" class="tx-right" title="\uc624\ub978\ucabd \ucd94\uac00">\uc624\ub978</a></li>				</ul>			</div>			<div class="tx-table-edit-layout-cell">				<h4>\uc0ad\uc81c</h4>				<ul class="tx-2cell">					<li class="tx-left"><a href="javascript:;" class="tx-col" title="\uc5f4\uc0ad\uc81c">\uc5f4</a></li>					<li class="tx-right"><a href="javascript:;" class="tx-row" title="\ud589\uc0ad\uc81c">\ud589</a></li>				</ul>				<h4 style="width:50px">\ubcd1\ud569/\ubd84\ud560</h4>				<ul class="tx-2cell">					<li class="tx-left"><a href="javascript:;" class="tx-merge" title="\ubcd1\ud569">\ud569</a></li>					<li class="tx-right"><a href="javascript:;" class="tx-split" title="\ubd84\ud560">\ubd84</a></li>				</ul>			</div>			<div class="tx-table-edit-layout-align">				<h4>\uc815\ub82c</h4>				<ul class="tx-3cell">					<li class="tx-left"><a href="javascript:;" class="tx-top" title="\uc0c1\ub2e8">\uc0c1</a></li>					<li class="tx-center"><a href="javascript:;" class="tx-middle" title="\uc911\ub2e8">\uc911</a></li>					<li class="tx-right"><a href="javascript:;" class="tx-bottom" title="\ud558\ub2e8">\ud558</a></li>				</ul>				<ul class="tx-3cell">					<li class="tx-left"><a href="javascript:;" class="tx-alignleft" title="\uc67c\ucabd \uc815\ub82c">\uc88c</a></li>					<li class="tx-center"><a href="javascript:;" class="tx-aligncenter" title="\uac00\uc6b4\ub370 \uc815\ub82c">\uc911</a></li>					<li class="tx-right"><a href="javascript:;" class="tx-alignright" title="\uc624\ub978\ucabd \uc815\ub82c">\uc6b0</a></li>				</ul>			</div>			</div>		</div>		<div class="tx-table-edit-design">		<div class="tx-table-edit-design-wrapper">			<dl>				<dt>\ud14c\ub450\ub9ac\uc120\ud0dd</dt>				<dd class="tx-table-edit-borderrange tx-btn-widget">					<a href="javascript:;" class="tx-icon">\ud14c\ub450\ub9ac</a>					<a href="javascript:;" class="tx-arrow">\ud14c\ub450\ub9ac</a>					<div class="tx-menu"></div>				</dd>				<dt>\uc120</dt>				<dd class="tx-table-edit-bordercolor tx-btn-widget-tbg">					<a href="javascript:;" class="tx-icon">\uc120\uc0c9</a>					<a href="javascript:;" class="tx-arrow">\uc120\uc0c9</a>					<div class="tx-colorpallete"></div>				</dd>				<dd class="tx-table-edit-borderwidth tx-btn-widget">					<a href="javascript:;" class="tx-icon">\uad75\uae30</a>					<a href="javascript:;" class="tx-arrow">\uad75\uae30</a>					<div class="tx-menu"></div>				</dd>				<dd class="tx-table-edit-borderstyle tx-btn-widget">					<a href="javascript:;" class="tx-icon">\uc2a4\ud0c0\uc77c</a>					<a href="javascript:;" class="tx-arrow">\uc2a4\ud0c0\uc77c</a>					<div class="tx-menu"></div>				</dd>				<dt>\ubc30\uacbd\uc0c9</dt>				<dd class="tx-table-edit-backcolor tx-btn-widget-brbg">					<a href="javascript:;" class="tx-icon">\ubc30\uacbd\uc0c9</a>					<a href="javascript:;" class="tx-arrow">\ubc30\uacbd\uc0c9</a>					<div class="tx-colorpallete" unselectable="on"></div>				</dd>			</dl>		</div>		</div>		<div class="tx-table-edit-template">		<div class="tx-table-edit-template-wrapper">			<ul>				<!--li class="tx-ex1"><a href="javascript:"></a></li-->			</ul>			<a href="javascript:;" class="tx-button-on">\ub354\ubcf4\uae30</a>			<ul class="tx-table-edit-template-all">				<!--li class="tx-ex1"><a href="javascript:"></a></li-->			</ul>		</div>		</div>		<div class="tx-table-edit-main">			<a href="javascript:;" class="tx-confirm">\ud655\uc778</a>			<a href="javascript:;" class="tx-cancel">\ucde8\uc18c</a>		</div>	</div>');
Trex.Menu.Table.TableEdit=Trex.Class.create({$const:{__OPTIONS:{WIDTH:[{label:"1pt",title:"1px",klass:"tx-1px",data:"1"},{label:"2pt",title:"2px",klass:"tx-2px",data:"2"},{label:"3pt",title:"3px",klass:"tx-3px",data:"3"},{label:"4pt",title:"4px",klass:"tx-4px",data:"4"},{label:"5pt",title:"5px",klass:"tx-5px",data:"5"},{label:"6pt",title:"6px",klass:"tx-6px",data:"6"},{label:"7pt",title:"7px",klass:"tx-7px",data:"7"}],RANGE:[{label:"\ubaa8\ub4e0 \ud14c\ub450\ub9ac",title:"\uc804\uccb4",klass:"tx-all",data:"all"},{label:"\ubc14\uae65 \ud14c\ub450\ub9ac",title:"\ubc14\uae65\ucabd",klass:"tx-out",data:"out"},{label:"\uc548\ucabd \ud14c\ub450\ub9ac",title:"\uc548\ucabd",klass:"tx-in",data:"in"},{label:"\uc704\ucabd \ud14c\ub450\ub9ac",title:"\uc704\ucabd",klass:"tx-top",data:"top"},{label:"\uc544\ub798\ucabd \ud14c\ub450\ub9ac",title:"\uc544\ub7ab\ucabd",klass:"tx-bottom",data:"bottom"},{label:"\uc67c\ucabd \ud14c\ub450\ub9ac",title:"\uc67c\ucabd",klass:"tx-left",data:"left"},{label:"\uc624\ub978\ucabd \ud14c\ub450\ub9ac",title:"\uc624\ub978\ucabd",klass:"tx-right",data:"right"}],STYLE:[{label:"\uc5c6\uc74c",title:"\uc5c6\uc74c",klass:"tx-none",data:"none"},{label:"\uc2e4\uc120",title:"\uc2e4\uc120",klass:"tx-solid",data:"solid"},{label:"\uad75\uc740\uc810\uc120",title:"\uad75\uc740\uc810\uc120",klass:"tx-dashed",data:"dashed"},{label:"\uc810\uc120",title:"\uc810\uc120",klass:"tx-dotted",data:"dotted"}]}},initialize:function(e){if(!e.table){alert("\ud3b8\uc9d1\ud560 \ud14c\uc774\ube14\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");
return}var h=this.config=$tx.extend({},e);this.previewTable=new Trex.Menu.Table.TableEdit.PreviewTable(h);this.realTable=new Trex.Menu.Table.TableEdit.TableEditor(h);this.elContainer=this.elPreviewArea=null;this.createTableEditLayer();this.blackBox=e.editor.getBlackBox();this.blackBox.show(this.elContainer);this.eventBinding();this.showMenu(0);this.borderRange="all"},createTableEditLayer:function(){this.elPreviewArea=tx.div({className:"tx-preview"});this.elPreviewArea.appendChild(this.previewTable.getTable());this.elContainer=tx.div({className:"tx-table-edit-container"});this.elContainer.appendChild(this.elPreviewArea);this.elMenu=Trex.MarkupTemplate.get("table.edit").evaluateAsDom({});this.elContainer.appendChild(this.elMenu)},_eventBindingTab:function(){var e=this.showMenu=function(o){if(isNaN(o)){return}for(var n=0;n<j.length;n++){$tx.removeClassName(l,"tx-tab-menu"+(n+1));$tx.hide(k[n])}$tx.addClassName(l,"tx-tab-menu"+(o+1));$tx.show(k[o])};var l=$tom.collect(this.elMenu,"ul.tx-tab");
var j=$tom.collectAll(l,"li");var k=[$tom.collect(this.elContainer,"div.tx-table-edit-layout"),$tom.collect(this.elContainer,"div.tx-table-edit-design"),$tom.collect(this.elContainer,"div.tx-table-edit-template")];var m=function(o,n){e(n);return false};for(var h=0;h<j.length;h++){$tx.observe(j[h],"click",m.bindAsEventListener(this,h))}},_eventBindingLayoutMenu:function(){var h=this;var l=$tom.collectAll($tom.collect(this.elMenu,".tx-table-edit-layout"),"a");var e=["addRowUpper","addRowBelow","addColLeft","addColRight","removeCol","removeRow","merge","split","changeTextValignTop","changeTextValignMiddle","changeTextValignBottom","changeTextAlignLeft","changeTextAlignCenter","changeTextAlignRight"];var n=function(t){var r=$tx.findElement(t,"li");var q=r.parentNode;if(r){var o=$tx.classNames(r)[0].replace("tx","");var p=q.className+o;q.className=p}};var k=function(p){var o=$tx.findElement(p,"ul");if(o){o.className=o.className.replace(/-right|-center|-left/,"")}};var m=function(p,o){$tx.stop(p);
h[e[o]]();return false};for(var j=0;j<l.length;j++){$tx.observe(l[j],"click",m.bindAsEventListener(this,j));$tx.observe(l[j],"mouseover",n);$tx.observe(l[j],"mouseout",k)}},_eventBindingDesignMenu:function(){var e=this;var j=$tom.collect(this.elMenu,"div.tx-table-edit-design");var h=this.config.editor.toolbar;var k=$tom.collect(j,"dd.tx-table-edit-backcolor a.tx-icon");h.makeWidget(new Trex.Button.ColorWidget({status:true,el:$tom.collect(j,"dd.tx-table-edit-backcolor")}),new Trex.Menu.ColorPallete({el:$tom.collect(this.elMenu,"dd.tx-table-edit-backcolor div.tx-colorpallete"),thumbs:Trex.__CONFIG_COMMON.thumbs}),function(n){if(!$tx.hasClassName(k,"tx-selected")){$tx.addClassName(k,"tx-selected")}e.changeCellStyle("changeBackColor",n)});var l=$tom.collect(j,"dd.tx-table-edit-borderrange a.tx-icon");h.makeWidget(new Trex.Button.Widget({status:true,el:$tom.collect(j,"dd.tx-table-edit-borderrange")}),new Trex.Menu.Select({el:$tom.collect(j,"dd.tx-table-edit-borderrange div.tx-menu"),options:Trex.Menu.Table.TableEdit.__OPTIONS.RANGE}),function(n){$tx.removeClassName(l,l.previousClassName||"tx-range");
l.previousClassName="tx-range-"+n;$tx.addClassName(l,"tx-range-"+n);e.setBorderRange(n)});var m=$tom.collect(j,"dd.tx-table-edit-bordercolor a.tx-icon");h.makeWidget(new Trex.Button.ColorWidget({status:true,el:$tom.collect(j,"dd.tx-table-edit-bordercolor")}),new Trex.Menu.ColorPallete({el:$tom.collect(this.elMenu,"dd.tx-table-edit-bordercolor div.tx-colorpallete"),thumbs:Trex.__CONFIG_COMMON.thumbs}),function(n){if(!$tx.hasClassName(m,"tx-selected")){$tx.addClassName(m,"tx-selected")}e.changeCellStyle("changeBorderColor",n)});h.makeWidget(new Trex.Button.Widget({status:true,el:$tom.collect(j,"dd.tx-table-edit-borderwidth")}),new Trex.Menu.Select({el:$tom.collect(j,"dd.tx-table-edit-borderwidth div.tx-menu"),options:Trex.Menu.Table.TableEdit.__OPTIONS.WIDTH}),function(o){var n=o.toPx();e.changeCellStyle("changeBorderWidth",n)});h.makeWidget(new Trex.Button.Widget({status:true,el:$tom.collect(j,"dd.tx-table-edit-borderstyle")}),new Trex.Menu.Select({el:$tom.collect(j,"dd.tx-table-edit-borderstyle div.tx-menu"),options:Trex.Menu.Table.TableEdit.__OPTIONS.STYLE}),function(n){e.changeCellStyle("changeBorderType",n)
})},_eventBidingTemplateMenu:function(){var n=$tom.collectAll(this.elMenu,"div.tx-table-edit-template ul");var m=n[0];var j=n[1];var k=(new Trex.Tool.Table.TemplateWizard()).getTemplateList();var e=this;var h=function(t,r,u){for(var q=0;q<t.length;q++){var p=tx.li({className:"tx-"+t[q].klass});var w=tx.a({href:"javascript:;"});var o=tx.span(" ");$tx.observe(w,"click",function(x){return function(){e.applyTemplateStyle(x);return false}}(q+u));w.appendChild(o);p.appendChild(w);r.appendChild(p)}};h(k.slice(10),j,10);h(k.slice(1,10),m,1);var l=$tom.collect(this.elMenu,"a.tx-button-on");$tx.observe(l,"click",function(){l.className=$tx.hasClassName(l,"tx-button")?"tx-button-on":"tx-button";"";$tx.toggle(j);return false})},_eventBindingMainMenu:function(){var j=this;var h=$tom.collect(this.elContainer,"div.tx-table-edit-main");var k=$tom.collect(h,"a.tx-confirm");$tx.observe(k,"click",function(){j.done();return false});var e=$tom.collect(h,"a.tx-cancel");$tx.observe(e,"click",function(){j.cancel();
return false})},eventBinding:function(){this._eventBindingTab();this._eventBidingTemplateMenu();this._eventBindingLayoutMenu();this._eventBindingDesignMenu();this._eventBindingMainMenu()},getContainer:function(){return this.elContainer},_executeLayoutCommand:function(e,h){this.previewTable.clearSelection();this.previewTable[e](h);this.previewTable.refreshCoord();this.realTable[e](h);this.previewTable.clearBoundary()},addRowUpper:function(){var e=this.previewTable.getSelectedRectCoord().sy;if(e<0){alert("\ucd94\uac00\ub420 \ud589\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return}if(e!=0&&!c.canAddUpperRow(e,this.previewTable.getTdMatrix())){alert("\uc88c\uc6b0\uce21\uc5d0 \ud569\uccd0\uc9c4 \ud589\uc774 \uc788\uc5b4\uc11c \ud589\uc744 \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return}this._executeLayoutCommand("addRowUpper",e)},addRowBelow:function(){var e=this.previewTable.getSelectedRectCoord().ey;if(e<0){alert("\ucd94\uac00\ub420 \ud589\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");
return}if(this.previewTable.getTdMatrix().length-1!=e&&!c.canAddBelowRow(e,this.previewTable.getTdMatrix())){alert("\uc88c\uc6b0\uce21\uc5d0 \ud569\uccd0\uc9c4 \ud589\uc774 \uc788\uc5b4\uc11c \ud589\uc744 \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return}this._executeLayoutCommand("addRowBelow",e)},addColLeft:function(){var e=this.previewTable.getSelectedRectCoord().sx;if(e<0){alert("\ucd94\uac00\ub420 \uc5f4\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return}if(0!=e&&!c.canAddLeftCol(e,this.previewTable.getTdMatrix())){alert("\uc704\uc544\ub798\uc5d0 \ud569\uccd0\uc9c4 \uc5f4\uc774 \uc788\uc5b4\uc11c \uc5f4\uc744 \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return}this._executeLayoutCommand("addColLeft",e)},addColRight:function(){var e=this.previewTable.getSelectedRectCoord().ex;if(e<0){alert("\ucd94\uac00\ub420 \uc5f4\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return}if(this.previewTable.getTdMatrix()[0].length-1!=e&&!c.canAddRightCol(e,this.previewTable.getTdMatrix())){alert("\uc704\uc544\ub798\uc5d0 \ud569\uccd0\uc9c4 \uc5f4\uc774 \uc788\uc5b4\uc11c \uc5f4\uc744 \ucd94\uac00\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");
return}this._executeLayoutCommand("addColRight",e)},removeRow:function(){var e=this.previewTable.getSelectedRectCoord();var j=e.sy;var h=e.ey;if(j<0){alert("\uc0ad\uc81c\ud560 \ud589\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return}if(!c.canRemoveRow(e,this.previewTable.getTdMatrix())){alert("\uc0ad\uc81c\ud560 \uc218 \uc5c6\ub294 \ud589\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.");return}if(c.isAllRowSelected(e,this.previewTable.getTdMatrix())){alert("\ubaa8\ub4e0 \ud589\uc744 \uc0ad\uc81c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return}this.previewTable.clearSelection();for(var k=j;k<=h;k++){this.previewTable.removeRow(j);this.realTable.removeRow(j)}this.previewTable.refreshCoord();this.previewTable.clearBoundary()},removeCol:function(){var e=this.previewTable.getSelectedRectCoord();var k=e.sx;var j=e.ex;if(k<0){alert("\uc0ad\uc81c\ud560 \uc5f4\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return}if(!c.canRemoveCol(e,this.previewTable.getTdMatrix())){alert("\uc0ad\uc81c\ud560 \uc218 \uc5c6\ub294 \uc5f4\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.");
return}if(c.isAllColSelected(e,this.previewTable.getTdMatrix())){alert("\ubaa8\ub4e0 \uc5f4\uc744 \uc0ad\uc81c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return}for(var h=k;h<=j;h++){this._executeLayoutCommand("removeCol",k)}},merge:function(){var e=this.previewTable.getSelectedRectCoord();if(e.sx<0||e.sy<0){alert("\ud569\uce60 \uce78\ub4e4\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return false}if(this.previewTable.getTdMatrix()[e.sy][e.sx]==this.previewTable.getTdMatrix()[e.ey][e.ex]){alert("\ud569\uce60\uce78\uc744 \ub450\uce78\uc774\uc0c1 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return false}if(!c.canMerge(e,this.previewTable.getTdMatrix())){alert("\ud569\uce58\uae30\ub97c \uc218\ud589\ud560 \uc218 \uc5c6\ub294 \uc120\ud0dd\uc601\uc5ed\uc785\ub2c8\ub2e4.");return false}this.previewTable.clearSelection();this.previewTable.merge(e);this.previewTable.refreshCoord();this.realTable.merge(e);this.previewTable.clearBoundary()},split:function(){var e=this.previewTable.getSelectedRectCoord();
if(e.sx<0||e.sy<0){alert("\ub098\ub20c \uce78\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return false}if(!c.canSplit(e,this.previewTable.getTdMatrix())){alert("\ub098\ub204\uc5b4\uc9c8 \uce78\uc744 \ud55c\uce78\ub9cc \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return false}if(!c.isMergedCell(e,this.previewTable.getTdMatrix())){alert("\ub354\uc774\uc0c1 \ub098\ub20c \uc218 \uc5c6\ub294 \uce78\uc785\ub2c8\ub2e4. \ub450\uce78\uc774\uc0c1 \ud569\uccd0\uc9c4 \uce78\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");return false}this.previewTable.clearSelection();this.previewTable.split(e);this.previewTable.refreshCoord();this.realTable.split(e);this.previewTable.clearBoundary()},changeCellStyle:function(j,h){var e=this.previewTable.getSelectedRectCoord();this.previewTable[j](e,h,this.borderRange);this.realTable[j](e,h,this.borderRange)},_changeTextAlign:function(h){var e=this.previewTable.getSelectedRectCoord();this.previewTable.changeTextAlign(e,h);this.realTable.changeTextAlign(e,h)},changeTextAlignLeft:function(){this._changeTextAlign("left")
},changeTextAlignCenter:function(){this._changeTextAlign("center")},changeTextAlignRight:function(){this._changeTextAlign("right")},_changeTextValign:function(h){var e=this.previewTable.getSelectedRectCoord();this.previewTable.changeTextValign(e,h);this.realTable.changeTextValign(e,h)},changeTextValignTop:function(){this._changeTextValign("top")},changeTextValignMiddle:function(){this._changeTextValign("middle")},changeTextValignBottom:function(){this._changeTextValign("bottom")},applyTemplateStyle:function(e){if(isNaN(e)){return}this.previewTable.applyTemplateStyle(e);this.realTable.applyTemplateStyle(e)},setBorderRange:function(e){this.borderRange=e},cancel:function(){this.blackBox.hide()},done:function(){$tom.insertAt(this.realTable.getTable(),this.config.table);$tom.remove(this.config.table);this.blackBox.hide()}});Trex.Menu.Table.TableEdit.TableEditor=Trex.Class.create({$const:{BORDER_STYLE:"1px solid #000"},initialize:function(h){this.elTable=this.createTable(h.table);this.initTdMatrix();
this.tableConfig={};var e=h.editor.getCanvas();this.doc=e.getCurrentPanel().getDocument()},initTdMatrix:function(){var e=new Trex.Tool.Table.TableCellMatrixer(this.elTable);this.tdMatrix=e.getTdMatrix();this.rowSize=e.getRowSize();this.colSize=e.getColSize()},createTable:function(e){return e.cloneNode(true)},setTdBorderStyle:function(j,h,k){var e=Trex.Menu.Table.TableEdit.TableEditor.BORDER_STYLE;$tx.setStyle(j,{borderRight:e,borderBottom:e,borderTop:(h)?e:"",borderLeft:(k)?e:""})},createTd:function(h){var j=this.doc.createElement("td");j.innerHTML="&nbsp;";for(var e in h){j.setAttribute(e,h[e])}return j},createTr:function(){var h=this.doc.createElement("tr");for(var e=0;e<this.colSize;e++){var j=this.createTd({});this.setTdBorderStyle(j,false,(e==0));h.appendChild(j)}return h},addRowUpper:function(e){this._addRow(e);if(e==0){for(var h=0;h<this.colSize;h++){$tx.setStyle(this.tdMatrix[0][h],{borderTop:"1px solid #000"});$tx.setStyle(this.tdMatrix[1][h],{borderTop:"none"})}}},addRowBelow:function(e){this._addRow(e,true)
},_addRow:function(k,h){var l=dGetties(this.elTable,"tr");var j=l[k];var e=this.createTr();$tom[(h)?"insertNext":"insertAt"](e,j);if(h){k++}this.tdMatrix.splice(k,0,$tom.collectAll(e,"td"));this.rowSize++},addColLeft:function(e){this._addCol(e);if(e==0){for(var h=0;h<this.rowSize;h++){$tx.setStyle(this.tdMatrix[h][1],{borderLeft:"none"})}}},addColRight:function(e){this._addCol(e,true)},_resizeAllCellWidth:function(){var k=$tx.getStyle(this.elTable,"width")||this.elTable.getAttribute("width")||389;k=parseInt(k);if(!k){return}var l=Math.round(k/this.colSize,0);for(var h=0;h<this.rowSize;h++){for(var e=0;e<this.colSize;e++){$tx.setStyle(this.tdMatrix[h][e],{width:(l*d.getColSpan(this.tdMatrix[h][e])).toPx()})}}},_addCol:function(j,n){var h=[];var m=null;var l=function(t,p,r,q){var o=p;while(r[t][o]&&h.include(r[t][o])){o+=(q)?-1:1}h.push(r[t][o]);return r[t][o]};for(var k=0;k<this.rowSize;k++){m=l(k,j,this.tdMatrix,n);var e=this.createTd({});this.setTdBorderStyle(e,k==0,j==0);$tom[(!n)?"insertAt":"insertNext"](e,m);
this.tdMatrix[k].splice(n?j+1:j,0,e)}this.colSize++;this._resizeAllCellWidth()},removeRow:function(e){var j=this.tdMatrix[e][0].parentNode;$tom.remove(j);this.tdMatrix.splice(e,1);this.rowSize--;if(e==0){for(var h=0;h<this.colSize;h++){this.setTdBorderStyle(this.tdMatrix[0][h],e==0,h==0)}}},removeCol:function(e){for(var h=0;h<this.rowSize;h++){$tom.remove(this.tdMatrix[h][e]);this.tdMatrix[h].splice(e,1)}this.colSize--;for(var h=0;h<this.rowSize;h++){if(this.tdMatrix[h][e]){this.setTdBorderStyle(this.tdMatrix[h][e],h==0,e==0)}}},merge:function(t){var u=0;for(var n=t.sx;n<=t.ex;n){var o=d.getColSpan(this.tdMatrix[t.sy][n]);u+=o;n+=o}var h=0;for(var n=t.sy;n<=t.ey;n){var q=d.getRowSpan(this.tdMatrix[n][t.sx]);h+=q;n+=q}var r=this.createTd({rowSpan:h,colSpan:u});var p=function(j){return(j.parentNode&&j.parentNode.nodeType!="11")};this.setTdBorderStyle(r,t.sy==0,t.sx==0);var e=this.tdMatrix[t.sy][t.sx];$tom.insertAt(r,e);var k="";for(var n=t.sy;n<=t.ey;n++){var m="";for(var l=t.sx;l<=t.ex;l++){if(p(this.tdMatrix[n][l])){$tom.remove(this.tdMatrix[n][l]);
m+=this.tdMatrix[n][l].innerHTML+""}this.tdMatrix[n][l]=r}k+=m+""}r.innerHTML=k;this._resizeAllCellWidth()},split:function(x){var w=this;var h=function(y,j){if(!w.tdMatrix[y][j-1]){return null}else{if(d.getRowSpan(w.tdMatrix[y][j-1])>1){return h(y,j-1)}else{return w.tdMatrix[y][j-1]}}};var p=x.sy;var k=x.sx;var l=this.tdMatrix[p][k];var r=l.innerHTML;var u=d.getRowSpan(l);var q=d.getColSpan(l);var t=$tom.collectAll(this.elTable,"tr");for(var o=p;o<p+u;o++){for(var n=k;n<k+q;n++){var m=this.createTd({});this.setTdBorderStyle(m,o==0,n==0);var e=h(o,n);if(e){$tom.insertNext(m,e)}else{$tom.insertFirst(t[o],m)}this.tdMatrix[o][n]=m}}this.tdMatrix[p][k].innerHTML=r;$tom.remove(l);this._resizeAllCellWidth()},_changeTopBorderStyle:function(h,m,n){var l={};var j=(h.sy==0);l[(h.sy==0)?"borderTop"+m:"borderBottom"+m]=n;var e=(h.sy==0)?0:h.sy-1;for(var k=h.sx;k<=h.ex;k++){$tx.setStyle(this.tdMatrix[e][k],l)}},_changeBottomBorderStyle:function(h,l,m){var k={};k["borderBottom"+l]=m;var e=h.ey;for(var j=h.sx;
j<=h.ex;j++){$tx.setStyle(this.tdMatrix[e][j],k)}},_changeLeftBorderStyle:function(e,l,m){var k={};var n=(e.sx==0);k[(e.sx==0)?"borderLeft"+l:"borderRight"+l]=m;var h=(e.sx==0)?0:e.sx-1;for(var j=e.sy;j<=e.ey;j++){$tx.setStyle(this.tdMatrix[j][h],k)}},_changeRightBorderStyle:function(e,l,m){var k={};k["borderRight"+l]=m;var h=e.ex;for(var j=e.sy;j<=e.ey;j++){$tx.setStyle(this.tdMatrix[j][h],k)}},_changeInBorderStyle:function(e,m,n){var l={};for(var k=e.sy;k<=e.ey;k++){for(var h=e.sx;h<=e.ex;h++){l={};if(k!=e.ey){l["borderBottom"+m]=n}if(h!=e.ex){l["borderRight"+m]=n}$tx.setStyle(this.tdMatrix[k][h],l)}}},_changeOutBorderStyle:function(e,h,j){this._changeTopBorderStyle(e,h,j);this._changeBottomBorderStyle(e,h,j);this._changeLeftBorderStyle(e,h,j);this._changeRightBorderStyle(e,h,j)},_changeBorderStyle:function(l,h,j,k){var e=this._getValidRectCoord(l);this._removeTableBorderProperty();this._removeTableSpacingProperty();switch(k){case"top":this._changeTopBorderStyle(e,h,j);break;case"bottom":this._changeBottomBorderStyle(e,h,j);
break;case"left":this._changeLeftBorderStyle(e,h,j);break;case"right":this._changeRightBorderStyle(e,h,j);break;case"in":this._changeInBorderStyle(e,h,j);break;case"out":this._changeOutBorderStyle(e,h,j);break;case"all":this._changeInBorderStyle(e,h,j);this._changeOutBorderStyle(e,h,j);break;default:break}},_getValidRectCoord:function(e){return{sy:(e.sy<0)?0:e.sy,ex:(e.ex<0)?this.colSize-1:e.ex,ey:(e.ey<0)?this.rowSize-1:e.ey,sx:(e.sx<0)?0:e.sx}},_removeTableBorderProperty:function(){var h=parseInt(this.elTable.getAttribute("border"));if(h>0){this.elTable.setAttribute("border","0");var e=new Trex.Tool.Table.TemplateWizard();e.applyStyle(this.elTable,0)}},_removeTableSpacingProperty:function(){this.elTable.setAttribute("cellSpacing","0")},changeBorderColor:function(e,j,h){this._changeBorderStyle(e,"Color",j,h)},changeBorderType:function(e,j,h){this._changeBorderStyle(e,"Style",j,h)},changeBorderWidth:function(e,k,h){var j=k.toPx();this._changeBorderStyle(e,"Width",j,h)},_changeCellStyle:function(e,k,n){var o=this._getValidRectCoord(e);
var m={};m[k]=n;for(var l=o.sy;l<=o.ey;l++){for(var h=o.sx;h<=o.ex;h++){$tx.setStyle(this.tdMatrix[l][h],m)}}},changeBackColor:function(e,h){this._changeCellStyle(e,"backgroundColor",h)},changeTextAlign:function(e,h){this._changeCellStyle(e,"textAlign",h)},changeTextValign:function(e,h){this._changeCellStyle(e,"verticalAlign",h)},applyTemplateStyle:function(h){this._removeTableBorderProperty();this._removeTableSpacingProperty();var e=new Trex.Tool.Table.TemplateWizard();e.applyStyle(this.elTable,h)},getTdMatrix:function(){return this.tdMatrix},getTable:function(){return this.elTable}});Trex.Menu.Table.TableEdit.PreviewTable=Trex.Class.create({$extend:Trex.Menu.Table.TableEdit.TableEditor,initialize:function(e){var h=new Date().getTime();this.$super.initialize(e);this.tableConfig={};this.boundary=a;this.boundary.clear();this.refreshCoord();this.clearTable();this.eventBinding()},createTd:function(e){var h=tx.td(e,"+");return h},createTr:function(){var h=tx.tr();for(var e=0;e<this.colSize;
e++){var j=this.createTd({});this.setTdBorderStyle(j,false,(e==0));h.appendChild(j)}return h},createTable:function(e){if($tx.msie||$tx.opera){var j=tx.div();var h=e.outerHTML;j.innerHTML=h;return j.firstChild}else{return e.cloneNode(true)}},clearTable:function(){if($tx.gecko){$tx.setStyle(this.elTable,{borderCollapse:"separate"})}this.elTable.setAttribute("width","");for(var h=0;h<this.rowSize;h++){for(var e=0;e<this.colSize;e++){d.clearContent(this.tdMatrix[h][e])}}this._resizeAllCellWidth()},clearSelection:function(){var k=this.boundary;if(k.top<0||k.left<0){return}for(var h=k.top;h<=k.bottom;h++){for(var e=k.left;e<=k.right;e++){d.setUnselect(this.tdMatrix[h][e])}}},setSelection:function(){var k=this.boundary;for(var h=k.top;h<=k.bottom;h++){for(var e=k.left;e<=k.right;e++){d.setSelect(this.tdMatrix[h][e])}}},_clearCoord:function(){for(var h=0;h<this.rowSize;h++){for(var e=0;e<this.colSize;e++){d.clearCoords(this.tdMatrix[h][e])}}},refreshCoord:function(){this._clearCoord();for(var h=0;
h<this.rowSize;h++){for(var e=0;e<this.colSize;e++){var k=this.tdMatrix[h][e].getAttribute("colClass");if(!k){d.setCoords(this.tdMatrix[h][e],h,e)}}}},getSelectedRectCoord:function(){return this.boundary.getRectCoord()},clearBoundary:function(){this.boundary.clear()},eventBinding:function(){var h=this;var k=null;var e=function(o){var n=d.getEventElement(o,true);if(n){var m=d.getMinCoord(n);var p=d.getMaxCoord(n);h.clearSelection();h.boundary.init(m.x-1,m.y-1);h.boundary.changeBoundary(p.x-1,p.y-1);k=n}};var l=function(n){if(k){var m=d.getEventElement(n);if(m&&k!=m){var o=d.getMinCoord(m);k=m;h.clearSelection();h.boundary.changeBoundary(o.x-1,o.y-1);h.setSelection()}}};var j=function(n){$tx.stop(n);var m=d.getEventElement(n);if(k){if(m==k){h.setSelection()}k=null}};setTimeout(function(){var n=$tom.collect(".tx-table-edit-container");var o=function(r){var t=$tx.element(r);if(t&&t.tagName){var p=t.className||"";var q=t.tagName.toLowerCase()||"";if(q=="div"&&(p.indexOf("tx-table-edit")>-1||p.indexOf("tx-preview")>-1)){h.clearSelection();
h.boundary.clear();$tx.stop(r)}}};$tx.observe(n,"click",o);var m=function(p){if(k){k=null}};$tx.observe(n,"mouseup",m)},1000);$tx.observe(this.elTable,"mousedown",e);$tx.observe(this.elTable,"mouseover",l);$tx.observe(this.elTable,"mouseup",j)}})}());Trex.MarkupTemplate.add("table.hover.button",'<div class="tx-table-btn-layer"><a href="javascript:;" class="tx-table-edit-layout">\ud45c\ud3b8\uc9d1</a><a href="javascript:;" class="tx-table-edit-template">\ud45c\uc11c\uc2dd</a><a href="javascript:;" class="tx-table-remove">\uc0ad\uc81c</a></div>');Trex.module("show button for action of table object",function(m,n,a,c,d){var h=20;var l=null;var j=Trex.MarkupTemplate.get("table.hover.button").evaluateAsDom({});$tom.insertFirst(c.wysiwygEl,j);var e=function(){var p=$tom.collect(j,"a.tx-table-edit-layout");$tx.observe(p,"click",function(r){if(l){new Trex.Menu.Table.TableEdit({editor:m,table:l})}return false});var o=$tom.collect(j,"a.tx-table-edit-template");$tx.observe(o,"click",function(t){if(l){var r=new Trex.Menu.Table.TableEdit({editor:m,table:l});
r.showMenu(2)}return false});var q=$tom.collect(j,"a.tx-table-remove");$tx.observe(q,"click",function(r){if(l){if(!confirm("\ud14c\uc774\ube14\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){return false}$tom.remove(l);c.history.saveHistory()}return false})};var k=function(p){if(p.width>0&&p.height>0&&p.y>0&&c.getIframeHeight()-p.y){var o=p.y+c.getIframeTop()-h;if(o<0){o=-6}$tx.setStyle(j,{top:o.toPx(),left:(p.x).toPx()});$tx.show(j)}else{$tx.hide(j)}};n.tools.table.availableButton=function(p){var o=p.className;if(o.indexOf("txc-table")>-1){return true}if(o.indexOf("txc-")>-1||o.indexOf("tx-")>-1){return false}return true};c.observeMouseover("table",function(o,p){if(!o){return}if(n.tools.table.availableButton(o)){l=o;k(p)}else{l=null;$tx.hide(j)}throw $stop},function(){l=null;$tx.hide(j)});c.observeJob(Trex.Ev.__CANVAS_PANEL_SCROLLING,function(o){if(l){var p=this.getPositionByNode(l);k(p)}});e()});Trex.module("Add layer to display notice message on editor area before editing",function(d,e,h,c,a){if(a.initializedMessage){c.observeJob(Trex.Ev.__IFRAME_LOAD_COMPLETE,function(k){var l=tx.div({id:"tx-canvas-notice",className:"tx-canvas-notice"},a.initializedMessage);
$tx("tx_canvas").insertBefore(l,$tx("tx_loading"));var j=function(){if($tx("tx-canvas-notice")){$tx("tx_canvas").removeChild(l);if(d.focus){d.focus()}}};$tx.observe(l,"click",j);c.observeJob(Trex.Ev.__CANVAS_DATA_INITIALIZE,j);e.observeJob(Trex.Ev.__TOOL_CLICK,j)})}});function getTableTemplateList(){return[{klass:"ex0",common:{borderRight:"1px solid #000",borderBottom:"1px solid #000"},firstRow:{borderTop:"1px solid #000"},firstCol:{borderLeft:"1px solid #000"},lastCol:{},lastRow:{},evenRow:{},oddRow:{}},{klass:"ex1",common:{backgroundColor:"#fff",color:"#000",borderRight:"1px solid #d9d9d9",borderBottom:"1px solid #d9d9d9"},firstRow:{borderTop:"1px solid #000"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{},oddRow:{}},{klass:"ex2",common:{backgroundColor:"#fff",color:"#000",borderRight:"1px solid #d9d9d9",borderBottom:"1px solid #d9d9d9"},firstRow:{borderTop:"1px solid #000",borderBottom:"1px solid #000"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{},oddRow:{}},{klass:"ex3",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #000",borderBottom:"1px solid #000"},firstRow:{borderTop:"1px solid #000",backgroundColor:"#e6e6e6"},firstCol:{borderLeft:"1px solid #000"},lastCol:{},lastRow:{},evenRow:{},oddRow:{}},{klass:"ex4",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d9d9d9",borderBottom:"1px solid #d9d9d9"},firstRow:{borderTop:"1px solid #000",backgroundColor:"#000",color:"#fff"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{},oddRow:{}},{klass:"ex5",common:{backgroundColor:"transparent",color:"#000",borderBottom:"1px solid #000",borderRight:"none"},firstRow:{borderTop:"1px solid #000"},firstCol:{borderLeft:"none"},lastCol:{},lastRow:{},evenRow:{backgroundColor:"#e6e6e6"},oddRow:{}},{klass:"ex6",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d9d9d9",borderBottom:"1px solid #d9d9d9"},firstRow:{borderTop:"1px solid #000",borderBottom:"1px solid #000"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{backgroundColor:"#e6e6e6"},oddRow:{}},{klass:"ex7",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d9d9d9",borderBottom:"1px solid #d9d9d9"},firstRow:{borderTop:"1px solid #000",borderBottom:"1px solid #000",backgroundColor:"#000",color:"#fff"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{backgroundColor:"#e6e6e6"},oddRow:{}},{klass:"ex8",common:{borderRight:"none",borderBottom:"none",color:"#000",backgroundColor:"transparent"},firstRow:{borderTop:"1px solid #fff",borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#000",color:"#fff"},firstCol:{borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderBottom:"1px solid #fff",backgroundColor:"#000",color:"#fff"},lastCol:{borderRight:"1px solid #000"},lastRow:{borderBottom:"1px solid #000"},evenRow:{},oddRow:{}},{klass:"ex9",common:{borderRight:"none",borderBottom:"none",color:"#000",backgroundColor:"transparent"},firstRow:{backgroundColor:"#000",borderRight:"1px solid #fff",borderTop:"1px solid #fff",borderBottom:"1px solid #fff",color:"#fff"},firstCol:{borderLeft:"1px solid #000"},lastCol:{borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#000",color:"#fff"},lastRow:{borderBottom:"1px solid #000"},evenRow:{},oddRow:{}},{klass:"ex11",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d1dffa",borderBottom:"1px solid #d1dffa"},firstRow:{borderTop:"1px solid #5f8eef"},firstCol:{borderLeft:"1px solid #5f8eef"},lastCol:{borderRight:"1px solid #5f8eef"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{},oddRow:{}},{klass:"ex12",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d1dffa",borderBottom:"1px solid #d1dffa"},firstRow:{borderTop:"1px solid #5f8eef",borderBottom:"1px solid #5f8eef"},firstCol:{borderLeft:"1px solid #5f8eef"},lastCol:{borderRight:"1px solid #5f8eef"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{},oddRow:{}},{klass:"ex13",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d1dffa",borderBottom:"1px solid #d1dffa"},firstRow:{borderTop:"1px solid #d1dffa",backgroundColor:"#e7efff"},firstCol:{borderLeft:"1px solid #d1dffa"},lastCol:{},lastRow:{},evenRow:{},oddRow:{}},{klass:"ex14",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d1dffa",borderBottom:"1px solid #d1dffa"},firstRow:{borderTop:"1px solid #5f8eef",backgroundColor:"#5f8eef",color:"#fff"},firstCol:{borderLeft:"1px solid #5f8eef"},lastCol:{borderRight:"1px solid #5f8eef"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{},oddRow:{}},{klass:"ex15",common:{backgroundColor:"transparent",color:"#000",borderBottom:"1px solid #5f8eef",borderRight:"none"},firstRow:{borderTop:"1px solid #5f8eef"},firstCol:{borderLeft:"none"},lastCol:{},lastRow:{},evenRow:{backgroundColor:"#e7effa"},oddRow:{}},{klass:"ex16",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d1dffa",borderBottom:"1px solid #d1dffa"},firstRow:{borderTop:"1px solid #5f8eef",borderBottom:"1px solid #5f8eef"},firstCol:{borderLeft:"1px solid #5f8eef"},lastCol:{borderRight:"1px solid #5f8eef"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{backgroundColor:"#e7effa"},oddRow:{}},{klass:"ex17",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d1dffa",borderBottom:"1px solid #d1dffa"},firstRow:{borderTop:"1px solid #5f8eef",borderBottom:"1px solid #5f8eef",backgroundColor:"#5f8eef",color:"#fff"},firstCol:{borderLeft:"1px solid #5f8eef"},lastCol:{borderRight:"1px solid #5f8eef"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{backgroundColor:"#efefff"},oddRow:{}},{klass:"ex18",common:{borderRight:"none",borderBottom:"none",color:"#000",backgroundColor:"transparent"},firstRow:{borderTop:"1px solid #fff",borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#5f8eef",color:"#fff"},firstCol:{borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderBottom:"1px solid #fff",backgroundColor:"#5f8eef",color:"#fff"},lastCol:{borderRight:"1px solid #5f8eef"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{},oddRow:{}},{klass:"ex19",common:{borderRight:"none",borderBottom:"none",color:"#000",backgroundColor:"transparent"},firstRow:{backgroundColor:"#5f8eef",borderRight:"1px solid #fff",borderTop:"1px solid #fff",borderBottom:"1px solid #fff",color:"#fff"},firstCol:{borderLeft:"1px solid #5f8eef"},lastCol:{borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#5f8eef",color:"#fff"},lastRow:{borderBottom:"1px solid #5f8eef"},evenRow:{},oddRow:{}},{klass:"ex21",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d2eea1",borderBottom:"1px solid #d2eea1"},firstRow:{borderTop:"1px solid #97dc20"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{borderRight:"1px solid #97dc20"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{},oddRow:{}},{klass:"ex22",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d2eea1",borderBottom:"1px solid #d2eea1"},firstRow:{borderTop:"1px solid #97dc20",borderBottom:"1px solid #97dc20"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{borderRight:"1px solid #97dc20"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{},oddRow:{}},{klass:"ex23",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d2eea1",borderBottom:"1px solid #d2eea1"},firstRow:{borderTop:"1px solid #97dc20",backgroundColor:"#f1ffd8"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{},lastRow:{},evenRow:{},oddRow:{}},{klass:"ex24",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d2eea1",borderBottom:"1px solid #d2eea1"},firstRow:{borderTop:"1px solid #97dc20",backgroundColor:"#97dc20",color:"#fff"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{borderRight:"1px solid #97dc20"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{},oddRow:{}},{klass:"ex25",common:{backgroundColor:"transparent",color:"#000",borderBottom:"1px solid #97dc20",borderRight:"none"},firstRow:{borderTop:"1px solid #97dc20"},firstCol:{borderLeft:"none"},lastCol:{},lastRow:{},evenRow:{backgroundColor:"#f1ffd8"},oddRow:{}},{klass:"ex26",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d2eea1",borderBottom:"1px solid #d2eea1"},firstRow:{borderTop:"1px solid #97dc20",borderBottom:"1px solid #97dc20"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{borderRight:"1px solid #97dc20"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{backgroundColor:"#f1ffd8"},oddRow:{}},{klass:"ex27",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #d2eea1",borderBottom:"1px solid #d2eea1"},firstRow:{borderTop:"1px solid #97dc20",borderBottom:"1px solid #97dc20",backgroundColor:"#97dc20",color:"#fff"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{borderRight:"1px solid #97dc20"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{backgroundColor:"#f1ffd8"},oddRow:{}},{klass:"ex28",common:{color:"#000",borderRight:"none",borderBottom:"none",backgroundColor:"transparent"},firstRow:{borderTop:"1px solid #fff",borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#97dc20",color:"#fff"},firstCol:{borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderBottom:"1px solid #fff",backgroundColor:"#97dc20",color:"#fff"},lastCol:{borderRight:"1px solid #97dc20"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{},oddRow:{}},{klass:"ex29",common:{color:"#000",borderRight:"none",borderBottom:"none",backgroundColor:"transparent"},firstRow:{backgroundColor:"#97dc20",borderRight:"1px solid #fff",borderTop:"1px solid #fff",borderBottom:"1px solid #fff",color:"#fff"},firstCol:{borderLeft:"1px solid #97dc20"},lastCol:{borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#97dc20",color:"#fff"},lastRow:{borderBottom:"1px solid #97dc20"},evenRow:{},oddRow:{}},{klass:"ex31",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #f8bebe",borderBottom:"1px solid #f8bebe"},firstRow:{borderTop:"1px solid #ea2d2d"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{borderRight:"1px solid #ea2d2d"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{},oddRow:{}},{klass:"ex32",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #f8bebe",borderBottom:"1px solid #f8bebe"},firstRow:{borderTop:"1px solid #ea2d2d",borderBottom:"1px solid #ea2d2d"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{borderRight:"1px solid #ea2d2d"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{},oddRow:{}},{klass:"ex33",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #ea2d2d",borderBottom:"1px solid #ea2d2d"},firstRow:{borderTop:"1px solid #ea2d2d",backgroundColor:"#ffe7e7"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{},lastRow:{},evenRow:{},oddRow:{}},{klass:"ex34",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #f8bebe",borderBottom:"1px solid #f8bebe"},firstRow:{borderTop:"1px solid #ea2d2d",backgroundColor:"#ea2d2d",color:"#fff"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{borderRight:"1px solid #ea2d2d"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{},oddRow:{}},{klass:"ex35",common:{backgroundColor:"transparent",color:"#000",borderBottom:"1px solid #ea2d2d",borderRight:"none"},firstRow:{borderTop:"1px solid #ea2d2d"},firstCol:{borderLeft:"none"},lastCol:{},lastRow:{},evenRow:{backgroundColor:"#ffe7e7"},oddRow:{}},{klass:"ex36",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #f8bebe",borderBottom:"1px solid #f8bebe"},firstRow:{borderTop:"1px solid #ea2d2d",borderBottom:"1px solid #ea2d2d"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{borderRight:"1px solid #ea2d2d"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{backgroundColor:"#ffe7e7"},oddRow:{}},{klass:"ex37",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #f8bebe",borderBottom:"1px solid #f8bebe"},firstRow:{borderTop:"1px solid #ea2d2d",borderBottom:"1px solid #ea2d2d",backgroundColor:"#ea2d2d",color:"#fff"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{borderRight:"1px solid #ea2d2d"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{backgroundColor:"#ffe7e7"},oddRow:{}},{klass:"ex38",common:{color:"#000",borderRight:"none",borderBottom:"none",backgroundColor:"transparent"},firstRow:{borderTop:"1px solid #fff",borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#ea2d2d",color:"#fff"},firstCol:{borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderBottom:"1px solid #fff",backgroundColor:"#ea2d2d",color:"#fff"},lastCol:{borderRight:"1px solid #ea2d2d"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{},oddRow:{}},{klass:"ex39",common:{color:"#000",borderRight:"none",borderBottom:"none",backgroundColor:"transparent"},firstRow:{backgroundColor:"#ea2d2d",borderRight:"1px solid #fff",borderTop:"1px solid #fff",borderBottom:"1px solid #fff",color:"#fff"},firstCol:{borderLeft:"1px solid #ea2d2d"},lastCol:{borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#ea2d2d",color:"#fff"},lastRow:{borderBottom:"1px solid #ea2d2d"},evenRow:{},oddRow:{}},{klass:"ex41",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #ffd1aa",borderBottom:"1px solid #ffd1aa"},firstRow:{borderTop:"1px solid #fb861f"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{borderRight:"1px solid #fb861f"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{},oddRow:{}},{klass:"ex42",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #ffd1aa",borderBottom:"1px solid #ffd1aa"},firstRow:{borderTop:"1px solid #fb861f",borderBottom:"1px solid #fb861f"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{borderRight:"1px solid #fb861f"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{},oddRow:{}},{klass:"ex43",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #fb861f",borderBottom:"1px solid #fb861f"},firstRow:{borderTop:"1px solid #fb861f",backgroundColor:"#ffead8"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{},lastRow:{},evenRow:{},oddRow:{}},{klass:"ex44",common:{backgroundColor:"transparent",color:"#000",borderRight:"1px solid #ffd1aa",borderBottom:"1px solid #ffd1aa"},firstRow:{borderTop:"1px solid #fb861f",backgroundColor:"#fb861f",color:"#fff"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{borderRight:"1px solid #fb861f"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{},oddRow:{}},{klass:"ex45",common:{color:"#000",backgroundColor:"transparent",borderBottom:"1px solid #fb861f",borderRight:"none"},firstRow:{borderTop:"1px solid #fb861f"},firstCol:{borderLeft:"none"},lastCol:{},lastRow:{},evenRow:{backgroundColor:"#ffead8"},oddRow:{}},{klass:"ex46",common:{color:"#000",backgroundColor:"transparent",borderRight:"1px solid #ffd1aa",borderBottom:"1px solid #ffd1aa"},firstRow:{borderTop:"1px solid #fb861f",borderBottom:"1px solid #fb861f"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{borderRight:"1px solid #fb861f"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{backgroundColor:"#ffead8"},oddRow:{}},{klass:"ex47",common:{color:"#000",backgroundColor:"transparent",borderRight:"1px solid #ffd1aa",borderBottom:"1px solid #ffd1aa"},firstRow:{borderTop:"1px solid #fb861f",borderBottom:"1px solid #fb861f",backgroundColor:"#fb861f",color:"#fff"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{borderRight:"1px solid #fb861f"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{backgroundColor:"#ffead8"},oddRow:{}},{klass:"ex48",common:{color:"#000",borderRight:"none",borderBottom:"none",backgroundColor:"transparent"},firstRow:{borderTop:"1px solid #fff",borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#fb861f",color:"#fff"},firstCol:{borderLeft:"1px solid #fff",borderRight:"1px solid #fff",borderBottom:"1px solid #fff",backgroundColor:"#fb861f",color:"#fff"},lastCol:{borderRight:"1px solid #fb861f"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{},oddRow:{}},{klass:"ex49",common:{color:"#000",borderRight:"none",borderBottom:"none",backgroundColor:"transparent"},firstRow:{backgroundColor:"#fb861f",borderRight:"1px solid #fff",borderTop:"1px solid #fff",borderBottom:"1px solid #fff",color:"#fff"},firstCol:{borderLeft:"1px solid #fb861f"},lastCol:{borderBottom:"1px solid #fff",borderRight:"1px solid #fff",backgroundColor:"#fb861f",color:"#fff"},lastRow:{borderBottom:"1px solid #fb861f"},evenRow:{},oddRow:{}}]
};